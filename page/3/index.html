<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="前端、程序员、编程、代码" />
       
      <meta name="description" content="记录前端知识学习，经验积累，记录生活" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> hasCat</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="hasCat" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/congtianfeng"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="[object Object]" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">hasCat</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-组件、自定义指令和自定义过滤器的注册"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/12/11/%E7%BB%84%E4%BB%B6%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E6%B3%A8%E5%86%8C/"
    >组件、自定义指令和自定义过滤器的注册</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/12/11/%E7%BB%84%E4%BB%B6%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E6%B3%A8%E5%86%8C/" class="article-date">
  <time datetime="2022-12-11T14:15:23.000Z" itemprop="datePublished">2022-12-11</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="一、组件的注册"><a href="#一、组件的注册" class="headerlink" title="一、组件的注册"></a>一、组件的注册</h2><h3 id="1、全局注册"><a href="#1、全局注册" class="headerlink" title="1、全局注册"></a>1、全局注册</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponent</span> <span class="keyword">from</span> <span class="string">&quot;@/components/Democomponent&quot;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-name&quot;</span>, <span class="title class_">DemoComponent</span>);</span><br></pre></td></tr></table></figure>

<p>第一个参数是组件名，第二个参数是导入的组件对象实例</p>
<p>定义组件名有两种方式</p>
<p>第一种使用短横线分隔命名。字母全小写，就像上面的例子一样。但是使用这种方式命名，在引用这个自定义元素时也必须使用使用短横线分隔命名，字母全小写的方式，就像这样 <code>&lt;my-component-name&gt;</code>。</p>
<p>第二种使用大驼峰命名 (首字母大写命名) 。这种方式，在引用这个自定义元素时两种命名法都可以使用。也就是说 <code>&lt;my-component-name&gt;</code> 和 <code>&lt;MyComponentName&gt;</code> 都是可接受的。注意，尽管如此，直接在 DOM (即非字符串的模板) 中使用时只有第一种方式是有效的。</p>
<p><strong><em>给予组件的名字可能依赖于打算拿它来做什么。当直接在 DOM 中使用一个组件 (而不是在字符串模板或<a target="_blank" rel="noopener" href="https://v2.cn.vuejs.org/v2/guide/single-file-components.html">单文件组件</a>) 的时候，vue 官方强烈推荐遵循 <a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name">W3C 规范</a>中的自定义组件名 (字母全小写且必须包含一个连字符)。这会帮助你避免和当前以及未来的 HTML 元素相冲突。</em></strong></p>
<h3 id="2、局部注册"><a href="#2、局部注册" class="headerlink" title="2、局部注册"></a>2、局部注册</h3><p>局部注册只需在组件中配置一个 components 配置项即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import DemoComponent from &#x27;./Democomponent&#x27; export default &#123; components: &#123;</span><br><span class="line">DemoComponent &#125; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、批量全局注册"><a href="#3、批量全局注册" class="headerlink" title="3、批量全局注册"></a>3、批量全局注册</h3><p>如果有大量的通用组件需要全局注册，那么我们的 main.js 文件很可能会变成这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponentA</span> <span class="keyword">from</span> <span class="string">&quot;@/components/DemocomponentA&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponentB</span> <span class="keyword">from</span> <span class="string">&quot;@/components/DemocomponentB&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponentC</span> <span class="keyword">from</span> <span class="string">&quot;@/components/DemocomponentC&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponentD</span> <span class="keyword">from</span> <span class="string">&quot;@/components/DemocomponentD&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DemoComponentE</span> <span class="keyword">from</span> <span class="string">&quot;@/components/DemocomponentE&quot;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-nameA&quot;</span>, <span class="title class_">DemoComponentA</span>);</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-nameB&quot;</span>, <span class="title class_">DemoComponentB</span>);</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-nameC&quot;</span>, <span class="title class_">DemoComponentC</span>);</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-nameD&quot;</span>, <span class="title class_">DemoComponentD</span>);</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component-nameE&quot;</span>, <span class="title class_">DemoComponentE</span>);</span><br></pre></td></tr></table></figure>

<p>为了保持 main.js 文件的简洁，我们可以将需要全局注册的通用组件统统放在一个单独的文件夹中，&#x2F;src&#x2F;components，在其中的 index.js 文件中将这些组件统一导入注册，再暴露出去交给 main.js 给 Vue 使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PageTools</span> <span class="keyword">from</span> <span class="string">&quot;./PageTools&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UploadExcel</span> <span class="keyword">from</span> <span class="string">&quot;./UploadExcel&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ImageUpload</span> <span class="keyword">from</span> <span class="string">&quot;./ImageUpload&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ScreenFull</span> <span class="keyword">from</span> <span class="string">&quot;./ScreenFull&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemePicker</span> <span class="keyword">from</span> <span class="string">&quot;./ThemePicker&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Lang</span> <span class="keyword">from</span> <span class="string">&quot;./Lang&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TagsView</span> <span class="keyword">from</span> <span class="string">&quot;./TagsView&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">Vue</span>) &#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;PageTools&quot;</span>, <span class="title class_">PageTools</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;UploadExcel&quot;</span>, <span class="title class_">UploadExcel</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;ImageUpload&quot;</span>, <span class="title class_">ImageUpload</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;ScreenFull&quot;</span>, <span class="title class_">ScreenFull</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;ThemePicker&quot;</span>, <span class="title class_">ThemePicker</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;Lang&quot;</span>, <span class="title class_">Lang</span>);</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;TagsView&quot;</span>, <span class="title class_">TagsView</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&quot;@/components&quot;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Components</span>); <span class="comment">// 注册自己的自定义组件</span></span><br></pre></td></tr></table></figure>

<h2 id="二、自定义指令"><a href="#二、自定义指令" class="headerlink" title="二、自定义指令"></a>二、自定义指令</h2><h3 id="1、全局注册-1"><a href="#1、全局注册-1" class="headerlink" title="1、全局注册"></a>1、全局注册</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 注册一个全局自定义指令 `v-focus`</span><br><span class="line">Vue.directive(&#x27;focus&#x27;, &#123;</span><br><span class="line">  // 当被绑定的元素插入到 DOM 中时……</span><br><span class="line">  inserted: function (el) &#123;</span><br><span class="line">    // 聚焦元素</span><br><span class="line">    el.focus()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>第一个参数是指令名，注意这里不需要带 v-</p>
<p>第二个参数是一个配置项。可以提供如下几个钩子函数 (均为可选)：</p>
<ul>
<li><code>bind</code>：只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置。</li>
<li><code>inserted</code>：被绑定元素插入父节点时调用 (仅保证父节点存在，但不一定已被插入文档中)。</li>
<li><code>update</code>：所在组件的 VNode 更新时调用，<strong>但是可能发生在其子 VNode 更新之前</strong>。指令的值可能发生了改变，也可能没有。但是你可以通过比较更新前后的值来忽略不必要的模板更新 (详细的钩子函数参数见下)。</li>
<li><code>componentUpdated</code>：指令所在组件的 VNode <strong>及其子 VNode</strong> 全部更新后调用。</li>
<li><code>unbind</code>：只调用一次，指令与元素解绑时调用。</li>
</ul>
<p>指令钩子函数会被传入以下参数：</p>
<ul>
<li><code>el</code>：指令所绑定的元素，可以用来直接操作 DOM。</li>
<li><code>binding</code>：一个对象，包含以下 property：<ul>
<li><code>name</code>：指令名，不包括 <code>v-</code> 前缀。</li>
<li><code>value</code>：指令的绑定值，例如：<code>v-my-directive=&quot;1 + 1&quot;</code> 中，绑定值为 <code>2</code>。</li>
<li><code>oldValue</code>：指令绑定的前一个值，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。无论值是否改变都可用。</li>
<li><code>expression</code>：字符串形式的指令表达式。例如 <code>v-my-directive=&quot;1 + 1&quot;</code> 中，表达式为 <code>&quot;1 + 1&quot;</code>。</li>
<li><code>arg</code>：传给指令的参数，可选。例如 <code>v-my-directive:foo</code> 中，参数为 <code>&quot;foo&quot;</code>。</li>
<li><code>modifiers</code>：一个包含修饰符的对象。例如：<code>v-my-directive.foo.bar</code> 中，修饰符对象为 <code>&#123; foo: true, bar: true &#125;</code>。</li>
</ul>
</li>
<li><code>vnode</code>：Vue 编译生成的虚拟节点。</li>
<li><code>oldVnode</code>：上一个虚拟节点，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。</li>
</ul>
<p>注意，除了 <code>el</code> 之外，其它参数都应该是只读的，切勿进行修改。如果需要在钩子之间共享数据，建议通过元素的 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/dataset"><code>dataset</code></a> 来进行。</p>
<h3 id="2、局部注册-1"><a href="#2、局部注册-1" class="headerlink" title="2、局部注册"></a>2、局部注册</h3><p>同样局部注册，只需配置组件中的一个 directives 配置项即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export default &#123; directives: &#123; focus: &#123; // 指令的定义 inserted: function (el) &#123;</span><br><span class="line">el.focus() &#125; &#125; &#125; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、批量全局注册-1"><a href="#3、批量全局注册-1" class="headerlink" title="3、批量全局注册"></a>3、批量全局注册</h3><p>同样如果有很多自定义指令需要全局注册，我们可以从 main.js 中分离出来单独处理。新建 src&#x2F;directives&#x2F;index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 负责管理所有的自定义指令</span></span><br><span class="line"><span class="comment">// 只负责导出指令对象</span></span><br><span class="line"><span class="comment">// 变量名称就是指令名称</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> imageerror = &#123;</span><br><span class="line">  <span class="comment">// 指令内容</span></span><br><span class="line">  <span class="comment">// 指令作用在 图片上的 dom是图片对象</span></span><br><span class="line">  <span class="comment">// inserted 在Vue3中也改名 =&gt; mounted</span></span><br><span class="line">  <span class="title function_">inserted</span>(<span class="params">dom, options</span>) &#123;</span><br><span class="line">    <span class="comment">// inserted执行的之后 此时 并没有对 src赋值</span></span><br><span class="line">    <span class="comment">// 图片有地址 但是地址加载图片失败的时候 会执行一个函数  onerror</span></span><br><span class="line">    dom.<span class="property">src</span> = dom.<span class="property">src</span> || options.<span class="property">value</span>;</span><br><span class="line">    dom.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 监听onerror事件</span></span><br><span class="line">      <span class="comment">// options.value就是指令传过来的值</span></span><br><span class="line">      dom.<span class="property">src</span> = options.<span class="property">value</span>; <span class="comment">// 当图片异常的时候 接收指令传过来的值 让这个值作为头像的备选</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 只有src有值 并且加载失败才会触发onerror</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 此钩子会在给image赋值之后执行</span></span><br><span class="line">  <span class="comment">// 这个钩子函数在Vue3中改名了 =&gt; updated</span></span><br><span class="line">  <span class="title function_">componentUpdated</span>(<span class="params">dom, options</span>) &#123;</span><br><span class="line">    dom.<span class="property">src</span> = dom.<span class="property">src</span> || options.<span class="property">value</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>再在 main.js 中批量注册即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> directives <span class="keyword">from</span> <span class="string">&quot;@/directives&quot;</span>;</span><br><span class="line"><span class="comment">// directives是所有指令的一个集合</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(directives).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// key就是指令名称</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">directive</span>(key, directives[key]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="三、过滤器"><a href="#三、过滤器" class="headerlink" title="三、过滤器"></a>三、过滤器</h2><h3 id="1、全局注册-2"><a href="#1、全局注册-2" class="headerlink" title="1、全局注册"></a>1、全局注册</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&quot;capitalize&quot;</span>, <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  value = value.<span class="title function_">toString</span>();</span><br><span class="line">  <span class="keyword">return</span> value.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + value.<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>第一个参数是过滤器的名称，第二个参数是一个函数，通常是一些处理文本格式化的操作。</p>
<h3 id="2、局部注册-2"><a href="#2、局部注册-2" class="headerlink" title="2、局部注册"></a>2、局部注册</h3><p>同样局部注册，只需配置组件中的一个 filters 配置项即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export default &#123; filters: &#123; capitalize: function (value) &#123; if (!value) return &#x27;&#x27;</span><br><span class="line">value = value.toString() return value.charAt(0).toUpperCase() + value.slice(1) &#125;</span><br><span class="line">&#125; &#125;</span><br></pre></td></tr></table></figure>

<p>使用时放在 JavaScript 表达式的尾部，由“管道”符号指示即可</p>
<h3 id="3、全局批量注册"><a href="#3、全局批量注册" class="headerlink" title="3、全局批量注册"></a>3、全局批量注册</h3><p>同样如果有很多过滤器需要全局注册，我们可以从 main.js 中分离出来单独处理。新建 src&#x2F;filters&#x2F;index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">pluralize</span>(<span class="params">time, label</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (time === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> time + label;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> time + label + <span class="string">&quot;s&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">timeAgo</span>(<span class="params">time</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> between = <span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span> - <span class="title class_">Number</span>(time);</span><br><span class="line">  <span class="keyword">if</span> (between &lt; <span class="number">3600</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">pluralize</span>(~~(between / <span class="number">60</span>), <span class="string">&quot; minute&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (between &lt; <span class="number">86400</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">pluralize</span>(~~(between / <span class="number">3600</span>), <span class="string">&quot; hour&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">pluralize</span>(~~(between / <span class="number">86400</span>), <span class="string">&quot; day&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">numberFormatter</span>(<span class="params">num, digits</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> si = [</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e18</span>, <span class="attr">symbol</span>: <span class="string">&quot;E&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e15</span>, <span class="attr">symbol</span>: <span class="string">&quot;P&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e12</span>, <span class="attr">symbol</span>: <span class="string">&quot;T&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e9</span>, <span class="attr">symbol</span>: <span class="string">&quot;G&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e6</span>, <span class="attr">symbol</span>: <span class="string">&quot;M&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">1e3</span>, <span class="attr">symbol</span>: <span class="string">&quot;k&quot;</span> &#125;,</span><br><span class="line">  ];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; si.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (num &gt;= si[i].<span class="property">value</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        (num / si[i].<span class="property">value</span>)</span><br><span class="line">          .<span class="title function_">toFixed</span>(digits)</span><br><span class="line">          .<span class="title function_">replace</span>(<span class="regexp">/\.0+$|(\.[0-9]*[1-9])0+$/</span>, <span class="string">&quot;$1&quot;</span>) + si[i].<span class="property">symbol</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> num.<span class="title function_">toString</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 main.js 中批量注册</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> filters <span class="keyword">from</span> <span class="string">&quot;@/filters&quot;</span>;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(filters).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">filter</span>(key, filters[key]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-小兔鲜电商项目练手"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/12/05/%E5%B0%8F%E5%85%94%E9%B2%9C%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E7%BB%83%E6%89%8B/"
    >小兔鲜电商项目练手</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/12/05/%E5%B0%8F%E5%85%94%E9%B2%9C%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E7%BB%83%E6%89%8B/" class="article-date">
  <time datetime="2022-12-05T13:28:44.000Z" itemprop="datePublished">2022-12-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>vue 学习推荐去看 vue 官方文档<a target="_blank" rel="noopener" href="https://cn.vuejs.org/">https://cn.vuejs.org/</a></p>
<p>视频学习推荐张天禹老师<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Zy4y1K7SH/?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1Zy4y1K7SH/?spm_id_from=333.337.search-card.all.click</a></p>
<h2 id="一、项目简介"><a href="#一、项目简介" class="headerlink" title="一、项目简介"></a>一、项目简介</h2><p>这是一个 B2C 电商平台类项目</p>
<h3 id="1、功能模块"><a href="#1、功能模块" class="headerlink" title="1、功能模块"></a>1、功能模块</h3><p>首页模块：顶部通栏，吸顶导航，网站头部，左侧分类，轮播图，新鲜好物，人气推荐，热门品牌，分类商品推荐，专题推荐，网站底部</p>
<ul>
<li>一级分类：面包屑，轮播图，全部二级分类，二级分类推荐商品</li>
<li>二级分类：筛选区域，排序功能，商品列表，无限加载。</li>
<li>商品详情：商品图片展示，基本信息展示，配送城市选择，SKU 选择，库存选择，商品详情展示，商品评价展示，24 小时热销，相关专题，加入购物车</li>
<li>购物车：头部购物车：展示商品数量和列表，删除商品，跳转购物车页面。购物车页面：购物车商品展示，选择商品，修改数量，修改商品规格，价格计算，跳转下单</li>
<li>登录模块：表单校验，账户密码登录</li>
<li>订单模块：订单商品展示，收货地址选择，收货地址新增，支付方式选择，生成订单</li>
<li>支付模块：订单信息展示，跳转支付网关，提示正在支付，等待支付结果，跳转支付成功页面。</li>
<li>个人中心：中心首页：展示个人信息，近期收藏商品，近期足迹，猜你喜欢 订单管理：全部订单，待付款，待发货，待收货，待评价，已完成，已取消。立即付款，取消订单，确认收货，删除订单，查看物流。订单详情：订单状态，订单进度，详细信息。</li>
</ul>
<h3 id="2、技术栈"><a href="#2、技术栈" class="headerlink" title="2、技术栈"></a>2、技术栈</h3><ul>
<li>vue3.x （组合式 API）</li>
<li>vite（构件工具）</li>
<li>axios（请求接口）</li>
<li>vue-router (单页路由)</li>
<li>pinia（状态管理）</li>
<li>element-plus（适用 vue3 的 UI 组件库）</li>
<li>@vueuse&#x2F;core（vue 组合式 API 的工具库）</li>
</ul>
<h2 id="二、项目初始化"><a href="#二、项目初始化" class="headerlink" title="二、项目初始化"></a>二、项目初始化</h2><h3 id="1、创建项目"><a href="#1、创建项目" class="headerlink" title="1、创建项目"></a>1、创建项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure>

<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230601085910553.png" alt="image-20230601085910553"></p>
<h3 id="2、jsconfig-json-配置别名路径"><a href="#2、jsconfig-json-配置别名路径" class="headerlink" title="2、jsconfig.json 配置别名路径"></a>2、jsconfig.json 配置别名路径</h3><p>配置别名路径可以在写代码时联想提示路径</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jsconfig.json文件中    @别名联想提示</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><em>这里需要注意的是，这个配置只是让我们在写代码，输入@时有一个路径联想提示的功能。真正实现 src 转化为@功能的是 vite.config.js 中的如下配置</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...省略其他代码</span></span><br><span class="line"><span class="comment">// @别名设置</span></span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: <span class="title function_">fileURLToPath</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、ElementPlus-自动按需导入"><a href="#3、ElementPlus-自动按需导入" class="headerlink" title="3、ElementPlus 自动按需导入"></a>3、ElementPlus 自动按需导入</h3><p>此处可以参考 ElementPlus 官网教程配置自动按需导入，并定制主题。最终配置的 vite.config.js 如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, <span class="variable constant_">URL</span> &#125; <span class="keyword">from</span> <span class="string">&quot;node:url&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="comment">// 配置elementui自动按需导入</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&quot;unplugin-auto-import/vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&quot;unplugin-vue-components/vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&quot;unplugin-vue-components/resolvers&quot;</span>;</span><br><span class="line"><span class="comment">// 导入对应包</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&quot;unplugin-element-plus/vite&quot;</span>;</span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">Components</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>(&#123; <span class="attr">importStyle</span>: <span class="string">&quot;sass&quot;</span> &#125;)],</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 按需定制主题配置</span></span><br><span class="line">    <span class="title class_">ElementPlus</span>(&#123;</span><br><span class="line">      <span class="attr">useSource</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// @别名设置</span></span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&quot;@&quot;</span>: <span class="title function_">fileURLToPath</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&quot;./src&quot;</span>, <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>)),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">css</span>: &#123;</span><br><span class="line">    <span class="attr">preprocessorOptions</span>: &#123;</span><br><span class="line">      <span class="comment">//按需导入自定义主题和自动导入scss变量</span></span><br><span class="line">      <span class="attr">scss</span>: &#123;</span><br><span class="line">        <span class="attr">additionalData</span>: <span class="string">`@use &quot;@/styles/element/index.scss&quot; as *;</span></span><br><span class="line"><span class="string">        @use &quot;@/styles/var.scss&quot; as *;`</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>按照官网教程在 src&#x2F;styles 下新建 element&#x2F;index.scss 定制化的主题样式文件</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 只需要重写你需要的即可 */</span></span><br><span class="line"><span class="keyword">@forward</span> <span class="string">&quot;element-plus/theme-chalk/src/common/var.scss&quot;</span> with (</span><br><span class="line">  <span class="variable">$colors</span>: (</span><br><span class="line">    <span class="string">&quot;primary&quot;</span>: (</span><br><span class="line">      // 主色</span><br><span class="line">      <span class="string">&quot;base&quot;</span>: <span class="number">#27ba9b</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;success&quot;</span>: (</span><br><span class="line">      // 成功色</span><br><span class="line">      <span class="string">&quot;base&quot;</span>: <span class="number">#1dc779</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;warning&quot;</span>: (</span><br><span class="line">      // 警告色</span><br><span class="line">      <span class="string">&quot;base&quot;</span>: <span class="number">#ffb302</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;danger&quot;</span>: (</span><br><span class="line">      // 危险色</span><br><span class="line">      <span class="string">&quot;base&quot;</span>: <span class="number">#e26237</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;error&quot;</span>: (</span><br><span class="line">      // 错误色</span><br><span class="line">      <span class="string">&quot;base&quot;</span>: <span class="number">#cf4444</span>,</span><br><span class="line">    ),</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="4、axios"><a href="#4、axios" class="headerlink" title="4、axios"></a>4、axios</h3><p>utils 下新建 request.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建axios实例</span></span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;http://pcapi-xiaotuxian-front-devtest.itheima.net&quot;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios请求拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(e)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios响应式拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="property">data</span>,</span><br><span class="line">  <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(e)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> request;</span><br></pre></td></tr></table></figure>

<p>src 下新建 api 文件夹，之后我们的所有接口将按模块集中管理在这个文件夹下</p>
<h3 id="5、路由"><a href="#5、路由" class="headerlink" title="5、路由"></a>5、路由</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="comment">// history: createWebHistory(&#x27;/#&#x27;),</span></span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;layout&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/index.vue&quot;</span>),</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;home&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/home/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;category/sub/:id&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;sub-category&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">            <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/sub-category/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;category/:id&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;category&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">            <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/category/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;goodsInfo/:id&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;goodsInfo&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">            <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/goodsInfo/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;cartList&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;cartList&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/cartList.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;orders&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;orders&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/orders/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;payPage/:id&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;payPage&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">            <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/payPage/index.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;paycallback&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;paycallback&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">            <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/payPage/paycallback.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;VIP&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;VIP&quot;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/VIP/index.vue&quot;</span>),</span><br><span class="line">          <span class="attr">children</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">path</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;userInfo&quot;</span>,</span><br><span class="line">              <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">                <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/VIP/userInfo.vue&quot;</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">path</span>: <span class="string">&quot;myOrders&quot;</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;myOrders&quot;</span>,</span><br><span class="line">              <span class="attr">component</span>: <span class="function">() =&gt;</span></span><br><span class="line">                <span class="keyword">import</span>(<span class="string">&quot;@/views/layout/components/VIP/myOrders.vue&quot;</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;login&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/login/index.vue&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 始终滚动到顶部</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">top</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="6、静态资源引入"><a href="#6、静态资源引入" class="headerlink" title="6、静态资源引入"></a>6、静态资源引入</h3><p>样式资源 - 把 common.scss 文件放到 styles 目录下</p>
<p><em>之后不要忘了在 main.js 中导入</em></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  common.scss</span></span><br><span class="line"><span class="comment">// 重置样式</span></span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">1240px</span>;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">1em</span>/<span class="number">1.4</span> <span class="string">&quot;Microsoft Yahei&quot;</span>, <span class="string">&quot;PingFang SC&quot;</span>, <span class="string">&quot;Avenir&quot;</span>, <span class="string">&quot;Segoe UI&quot;</span>, <span class="string">&quot;Hiragino Sans GB&quot;</span>,</span><br><span class="line">    <span class="string">&quot;STHeiti&quot;</span>, <span class="string">&quot;Microsoft Sans Serif&quot;</span>, <span class="string">&quot;WenQuanYi Micro Hei&quot;</span>, sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span>,</span><br><span class="line"><span class="selector-tag">ul</span>,</span><br><span class="line"><span class="selector-tag">h1</span>,</span><br><span class="line"><span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-tag">p</span>,</span><br><span class="line"><span class="selector-tag">dl</span>,</span><br><span class="line"><span class="selector-tag">dd</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="selector-tag">text</span>-decoration: none;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">i</span> &#123;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;search&quot;</span>]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;password&quot;</span>]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;checkbox&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  -webkit-<span class="attribute">appearance</span>: none;</span><br><span class="line">  &amp;<span class="selector-pseudo">::placeholder</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ebebeb</span> <span class="built_in">url</span>(<span class="string">&quot;@/assets/images/200.png&quot;</span>) no-repeat center / contain;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#app</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">  user-<span class="selector-tag">select</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1240px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.ellipsis</span> &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="selector-tag">text</span>-<span class="attribute">overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.ellipsis-2</span> &#123;</span><br><span class="line">  <span class="attribute">word-break</span>: break-all;</span><br><span class="line">  <span class="selector-tag">text</span>-<span class="attribute">overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  -webkit-box-orient: vertical;</span><br><span class="line">  -webkit-<span class="selector-tag">line</span>-clamp: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fl</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fr</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;.&quot;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="selector-tag">line</span>-<span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reset element</span></span><br><span class="line"><span class="selector-class">.el-breadcrumb__inner</span><span class="selector-class">.is-link</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">400</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>scss 变量</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  styles/var.scss</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$xtxColor</span>: <span class="number">#27ba9b</span>;</span><br><span class="line"><span class="variable">$helpColor</span>: <span class="number">#e26237</span>;</span><br><span class="line"><span class="variable">$sucColor</span>: <span class="number">#1dc779</span>;</span><br><span class="line"><span class="variable">$warnColor</span>: <span class="number">#ffb302</span>;</span><br><span class="line"><span class="variable">$priceColor</span>: <span class="number">#cf4444</span>;</span><br></pre></td></tr></table></figure>

<h2 id="三、Layout-组件"><a href="#三、Layout-组件" class="headerlink" title="三、Layout 组件"></a>三、Layout 组件</h2><h3 id="1、总体架构"><a href="#1、总体架构" class="headerlink" title="1、总体架构"></a>1、总体架构</h3><p>本项目一级路由有 Login 组件、Layout 组件，当然还可以有 404 组件（我并没有做）</p>
<p>Layout 组件结构如下</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230601100747054.png" alt="image-20230601100747054"></p>
<p>因此，依次创建 4 个组件并导入到 Layout 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import Topnav from &quot;./components/topnav.vue&quot;;</span><br><span class="line">import Header from &quot;./components/header.vue&quot;;</span><br><span class="line">import Footer from &quot;./components/footer.vue&quot;;</span><br><span class="line">import HeaderSticky from &quot;./components/header-sticky.vue&quot;;</span><br><span class="line">import &#123; useScroll &#125; from &quot;@vueuse/core&quot;;</span><br><span class="line">import &#123; useCategoryStore &#125; from &quot;@/stores/category&quot;;</span><br><span class="line">const &#123; y &#125; = useScroll(window);</span><br><span class="line">const &#123; getCategory &#125; = useCategoryStore();</span><br><span class="line">getCategory();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 顶部Nav栏 --&gt;</span><br><span class="line">  &lt;Topnav /&gt;</span><br><span class="line">  &lt;!-- 顶部导航栏 --&gt;</span><br><span class="line">  &lt;Header /&gt;</span><br><span class="line">  &lt;!-- 吸顶导航 --&gt;</span><br><span class="line">  &lt;HeaderSticky :y=&quot;y&quot; /&gt;</span><br><span class="line">  &lt;!-- 中间二级菜单 --&gt;</span><br><span class="line">  &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;!-- 底部 --&gt;</span><br><span class="line">  &lt;Footer /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>其中的 Topnav 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useUserInfoStore &#125; from &quot;@/stores/userInfo.js&quot;;</span><br><span class="line">import &#123; useRouter &#125; from &quot;vue-router&quot;;</span><br><span class="line">const router = useRouter();</span><br><span class="line">const &#123; userInfo, clearUserInfo &#125; = useUserInfoStore();</span><br><span class="line">// 确认退出</span><br><span class="line">const confirm = () =&gt; &#123;</span><br><span class="line">  clearUserInfo();</span><br><span class="line">  router.push(&quot;/login&quot;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;nav class=&quot;app-topnav&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &lt;template v-if=&quot;userInfo.account&quot;&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;</span><br><span class="line">              &gt;&lt;i class=&quot;iconfont icon-user&quot;&gt;&lt;/i&gt;&#123;&#123; userInfo.account &#125;&#125;&lt;/a</span><br><span class="line">            &gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;el-popconfirm</span><br><span class="line">              title=&quot;确认退出吗?&quot;</span><br><span class="line">              confirm-button-text=&quot;确认&quot;</span><br><span class="line">              cancel-button-text=&quot;取消&quot;</span><br><span class="line">              @confirm=&quot;confirm&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;template #reference&gt;</span><br><span class="line">                &lt;a href=&quot;javascript:;&quot;&gt;退出登录&lt;/a&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">            &lt;/el-popconfirm&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;javascript:;&quot;&gt;我的订单&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;/VIP&quot;&gt;会员中心&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;template v-else&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;/login&quot;&gt;请先登录&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;javascript:;&quot;&gt;帮助中心&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;javascript:;&quot;&gt;关于我们&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/nav&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.app-topnav &#123;</span><br><span class="line">  background: #333;</span><br><span class="line">  ul &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 53px;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">    align-items: center;</span><br><span class="line">    li &#123;</span><br><span class="line">      a &#123;</span><br><span class="line">        padding: 0 15px;</span><br><span class="line">        color: #cdcdcd;</span><br><span class="line">        line-height: 1;</span><br><span class="line">        display: inline-block;</span><br><span class="line"></span><br><span class="line">        i &#123;</span><br><span class="line">          font-size: 14px;</span><br><span class="line">          margin-right: 2px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;:hover &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      ~ li &#123;</span><br><span class="line">        a &#123;</span><br><span class="line">          border-left: 2px solid #666;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>Header 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useCategoryStore &#125; from &quot;@/stores/category&quot;;</span><br><span class="line">import HeadCart from &quot;./headCart.vue&quot;;</span><br><span class="line">const &#123; categoryList &#125; = toRefs(useCategoryStore());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;header class=&quot;app-header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;h1 class=&quot;logo&quot;&gt;</span><br><span class="line">        &lt;RouterLink to=&quot;/&quot;&gt;小兔鲜&lt;/RouterLink&gt;</span><br><span class="line">      &lt;/h1&gt;</span><br><span class="line">      &lt;ul class=&quot;app-header-nav&quot;&gt;</span><br><span class="line">        &lt;li class=&quot;home&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/&quot;&gt;首页&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li v-for=&quot;item in categoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;RouterLink :to=&quot;`/category/$&#123;item.id&#125;`&quot; active-class=&quot;active&quot;&gt;&#123;&#123;</span><br><span class="line">            item.name</span><br><span class="line">          &#125;&#125;&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">      &lt;div class=&quot;search&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;iconfont icon-search&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; placeholder=&quot;搜一搜&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 头部购物车 --&gt;</span><br><span class="line">      &lt;HeadCart /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/header&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.app-header &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line"></span><br><span class="line">  .container &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .logo &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      height: 132px;</span><br><span class="line">      width: 100%;</span><br><span class="line">      text-indent: -9999px;</span><br><span class="line">      background: url(&quot;@/assets/images/logo.png&quot;) no-repeat center 18px /</span><br><span class="line">        contain;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .app-header-nav &#123;</span><br><span class="line">    width: 820px;</span><br><span class="line">    display: flex;</span><br><span class="line">    padding-left: 40px;</span><br><span class="line">    position: relative;</span><br><span class="line">    z-index: 998;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      margin-right: 40px;</span><br><span class="line">      width: 38px;</span><br><span class="line">      text-align: center;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        line-height: 32px;</span><br><span class="line">        height: 32px;</span><br><span class="line">        display: inline-block;</span><br><span class="line"></span><br><span class="line">        &amp;:hover &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line">          border-bottom: 1px solid $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .active &#123;</span><br><span class="line">        color: $xtxColor;</span><br><span class="line">        border-bottom: 1px solid $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .search &#123;</span><br><span class="line">    width: 170px;</span><br><span class="line">    height: 32px;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-bottom: 1px solid #e7e7e7;</span><br><span class="line">    line-height: 32px;</span><br><span class="line"></span><br><span class="line">    .icon-search &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      margin-left: 5px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    input &#123;</span><br><span class="line">      width: 140px;</span><br><span class="line">      padding-left: 5px;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cart &#123;</span><br><span class="line">    width: 50px;</span><br><span class="line"></span><br><span class="line">    .curr &#123;</span><br><span class="line">      height: 32px;</span><br><span class="line">      line-height: 32px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      position: relative;</span><br><span class="line">      display: block;</span><br><span class="line"></span><br><span class="line">      .icon-cart &#123;</span><br><span class="line">        font-size: 22px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      em &#123;</span><br><span class="line">        font-style: normal;</span><br><span class="line">        position: absolute;</span><br><span class="line">        right: 0;</span><br><span class="line">        top: 0;</span><br><span class="line">        padding: 1px 6px;</span><br><span class="line">        line-height: 1;</span><br><span class="line">        background: $helpColor;</span><br><span class="line">        color: #fff;</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        border-radius: 10px;</span><br><span class="line">        font-family: Arial;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>HeaderSticky 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useCategoryStore &#125; from &quot;@/stores/category&quot;;</span><br><span class="line">defineProps(&#123;</span><br><span class="line">  y: &#123;</span><br><span class="line">    type: Number,</span><br><span class="line">    required: true,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; categoryList &#125; = toRefs(useCategoryStore());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app-header-sticky&quot; :class=&quot;&#123; show: y &gt; 78 &#125;&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;RouterLink class=&quot;logo&quot; to=&quot;/&quot; /&gt;</span><br><span class="line">      &lt;!-- 导航区域 --&gt;</span><br><span class="line">      &lt;ul class=&quot;app-header-nav&quot;&gt;</span><br><span class="line">        &lt;li class=&quot;home&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/&quot;&gt;首页&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li v-for=&quot;item in categoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;RouterLink :to=&quot;`/category/$&#123;item.id&#125;`&quot; active-class=&quot;active&quot;&gt;&#123;&#123;</span><br><span class="line">            item.name</span><br><span class="line">          &#125;&#125;&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">        &lt;RouterLink to=&quot;/&quot;&gt;品牌&lt;/RouterLink&gt;</span><br><span class="line">        &lt;RouterLink to=&quot;/&quot;&gt;专题&lt;/RouterLink&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.app-header-sticky &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 80px;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  z-index: 999;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border-bottom: 1px solid #e4e4e4;</span><br><span class="line">  // 此处为关键样式!!!</span><br><span class="line">  // 状态一：往上平移自身高度 + 完全透明</span><br><span class="line">  transform: translateY(-100%);</span><br><span class="line">  opacity: 0;</span><br><span class="line"></span><br><span class="line">  // 状态二：移除平移 + 完全不透明</span><br><span class="line">  &amp;.show &#123;</span><br><span class="line">    transition: all 0.3s linear;</span><br><span class="line">    transform: none;</span><br><span class="line">    opacity: 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .container &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .logo &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 80px;</span><br><span class="line">    background: url(&quot;@/assets/images/logo.png&quot;) no-repeat right 2px;</span><br><span class="line">    background-size: 160px auto;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .right &#123;</span><br><span class="line">    width: 220px;</span><br><span class="line">    display: flex;</span><br><span class="line">    text-align: center;</span><br><span class="line">    padding-left: 40px;</span><br><span class="line">    border-left: 2px solid $xtxColor;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      width: 38px;</span><br><span class="line">      margin-right: 40px;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      line-height: 1;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        color: $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.app-header-nav &#123;</span><br><span class="line">  width: 820px;</span><br><span class="line">  display: flex;</span><br><span class="line">  padding-left: 40px;</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 998;</span><br><span class="line"></span><br><span class="line">  li &#123;</span><br><span class="line">    margin-right: 40px;</span><br><span class="line">    width: 38px;</span><br><span class="line">    text-align: center;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      line-height: 32px;</span><br><span class="line">      height: 32px;</span><br><span class="line">      display: inline-block;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        color: $xtxColor;</span><br><span class="line">        border-bottom: 1px solid $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .active &#123;</span><br><span class="line">      color: $xtxColor;</span><br><span class="line">      border-bottom: 1px solid $xtxColor;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>Footer 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;footer class=&quot;app_footer&quot;&gt;</span><br><span class="line">    &lt;!-- 联系我们 --&gt;</span><br><span class="line">    &lt;div class=&quot;contact&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;dl&gt;</span><br><span class="line">          &lt;dt&gt;客户服务&lt;/dt&gt;</span><br><span class="line">          &lt;dd&gt;&lt;i class=&quot;iconfont icon-kefu&quot;&gt;&lt;/i&gt; 在线客服&lt;/dd&gt;</span><br><span class="line">          &lt;dd&gt;&lt;i class=&quot;iconfont icon-question&quot;&gt;&lt;/i&gt; 问题反馈&lt;/dd&gt;</span><br><span class="line">        &lt;/dl&gt;</span><br><span class="line">        &lt;dl&gt;</span><br><span class="line">          &lt;dt&gt;关注我们&lt;/dt&gt;</span><br><span class="line">          &lt;dd&gt;&lt;i class=&quot;iconfont icon-weixin&quot;&gt;&lt;/i&gt; 公众号&lt;/dd&gt;</span><br><span class="line">          &lt;dd&gt;&lt;i class=&quot;iconfont icon-weibo&quot;&gt;&lt;/i&gt; 微博&lt;/dd&gt;</span><br><span class="line">        &lt;/dl&gt;</span><br><span class="line">        &lt;dl&gt;</span><br><span class="line">          &lt;dt&gt;下载APP&lt;/dt&gt;</span><br><span class="line">          &lt;dd class=&quot;qrcode&quot;&gt;&lt;img src=&quot;@/assets/images/qrcode.jpg&quot; /&gt;&lt;/dd&gt;</span><br><span class="line">          &lt;dd class=&quot;download&quot;&gt;</span><br><span class="line">            &lt;span&gt;扫描二维码&lt;/span&gt;</span><br><span class="line">            &lt;span&gt;立马下载APP&lt;/span&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;下载页面&lt;/a&gt;</span><br><span class="line">          &lt;/dd&gt;</span><br><span class="line">        &lt;/dl&gt;</span><br><span class="line">        &lt;dl&gt;</span><br><span class="line">          &lt;dt&gt;服务热线&lt;/dt&gt;</span><br><span class="line">          &lt;dd class=&quot;hotline&quot;&gt;</span><br><span class="line">            400-0000-000 &lt;small&gt;周一至周日 8:00-18:00&lt;/small&gt;</span><br><span class="line">          &lt;/dd&gt;</span><br><span class="line">        &lt;/dl&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 其它 --&gt;</span><br><span class="line">    &lt;div class=&quot;extra&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;slogan&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;iconfont icon-footer01&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;span&gt;价格亲民&lt;/span&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;iconfont icon-footer02&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;span&gt;物流快捷&lt;/span&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;iconfont icon-footer03&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;span&gt;品质新鲜&lt;/span&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 版权信息 --&gt;</span><br><span class="line">        &lt;div class=&quot;copyright&quot;&gt;</span><br><span class="line">          &lt;p&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;关于我们&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;帮助中心&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;售后服务&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;配送与验收&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;商务合作&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;搜索推荐&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:;&quot;&gt;友情链接&lt;/a&gt;</span><br><span class="line">          &lt;/p&gt;</span><br><span class="line">          &lt;p&gt;CopyRight © 小兔鲜儿&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/footer&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.app_footer &#123;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background-color: #f5f5f5;</span><br><span class="line">  padding-top: 20px;</span><br><span class="line"></span><br><span class="line">  .contact &#123;</span><br><span class="line">    background: #fff;</span><br><span class="line"></span><br><span class="line">    .container &#123;</span><br><span class="line">      padding: 60px 0 40px 25px;</span><br><span class="line">      display: flex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dl &#123;</span><br><span class="line">      height: 190px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      padding: 0 72px;</span><br><span class="line">      border-right: 1px solid #f2f2f2;</span><br><span class="line">      color: #999;</span><br><span class="line"></span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        padding-left: 0;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-right: none;</span><br><span class="line">        padding-right: 0;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dt &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dd &#123;</span><br><span class="line">      margin: 36px 12px 0 0;</span><br><span class="line">      float: left;</span><br><span class="line">      width: 92px;</span><br><span class="line">      height: 92px;</span><br><span class="line">      padding-top: 10px;</span><br><span class="line">      border: 1px solid #ededed;</span><br><span class="line"></span><br><span class="line">      .iconfont &#123;</span><br><span class="line">        font-size: 36px;</span><br><span class="line">        display: block;</span><br><span class="line">        color: #666;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        .iconfont &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        margin-right: 0;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .qrcode &#123;</span><br><span class="line">      width: 92px;</span><br><span class="line">      height: 92px;</span><br><span class="line">      padding: 7px;</span><br><span class="line">      border: 1px solid #ededed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .download &#123;</span><br><span class="line">      padding-top: 5px;</span><br><span class="line">      font-size: 14px;</span><br><span class="line">      width: auto;</span><br><span class="line">      height: auto;</span><br><span class="line">      border: none;</span><br><span class="line"></span><br><span class="line">      span &#123;</span><br><span class="line">        display: block;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        line-height: 1;</span><br><span class="line">        padding: 10px 25px;</span><br><span class="line">        margin-top: 5px;</span><br><span class="line">        color: #fff;</span><br><span class="line">        border-radius: 2px;</span><br><span class="line">        background-color: $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .hotline &#123;</span><br><span class="line">      padding-top: 20px;</span><br><span class="line">      font-size: 22px;</span><br><span class="line">      color: #666;</span><br><span class="line">      width: auto;</span><br><span class="line">      height: auto;</span><br><span class="line">      border: none;</span><br><span class="line"></span><br><span class="line">      small &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        font-size: 15px;</span><br><span class="line">        color: #999;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .extra &#123;</span><br><span class="line">    background-color: #333;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .slogan &#123;</span><br><span class="line">    height: 178px;</span><br><span class="line">    line-height: 58px;</span><br><span class="line">    padding: 60px 100px;</span><br><span class="line">    border-bottom: 1px solid #434343;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      height: 58px;</span><br><span class="line">      line-height: 58px;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 28px;</span><br><span class="line"></span><br><span class="line">      i &#123;</span><br><span class="line">        font-size: 50px;</span><br><span class="line">        vertical-align: middle;</span><br><span class="line">        margin-right: 10px;</span><br><span class="line">        font-weight: 100;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      span &#123;</span><br><span class="line">        vertical-align: middle;</span><br><span class="line">        text-shadow: 0 0 1px #333;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .copyright &#123;</span><br><span class="line">    height: 170px;</span><br><span class="line">    padding-top: 40px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 15px;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      margin-bottom: 20px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 10px;</span><br><span class="line">      border-right: 1px solid #999;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-right: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、吸顶交互效果"><a href="#2、吸顶交互效果" class="headerlink" title="2、吸顶交互效果"></a>2、吸顶交互效果</h3><p>实现吸顶交互效果的核心逻辑：根据滚动距离判断当前 show 类名是否显示，大于 78 显示，小于 78，不显示</p>
<p>这里我们使用@vueuse&#x2F;core 提供的 useScroll 方法可以很方便的实现获取页面滚动距离的目的</p>
<p>VueUse 是一个为 Vue 组合式 API 提供服务的工具库，也就是说在 Vue 选项式 API 中它将不能使用</p>
<p>VueUse 官网<a target="_blank" rel="noopener" href="https://vueuse.org/">https://vueuse.org/</a></p>
<h3 id="3、Pinia-优化重复请求"><a href="#3、Pinia-优化重复请求" class="headerlink" title="3、Pinia 优化重复请求"></a>3、Pinia 优化重复请求</h3><p>注意到获取商品的分类信息在多个模块中都会用到，为了避免重复请求，我们将其抽取成一个 store 模块</p>
<p>在 src&#x2F;stores 中新建 categoryStore.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getCategoryAPI &#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/layout&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCategoryStore = <span class="title function_">defineStore</span>(<span class="string">&quot;category&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//分类列表数据</span></span><br><span class="line">  <span class="keyword">const</span> isLoading = <span class="title function_">ref</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> categoryList = <span class="title function_">ref</span>([]);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getCategory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">getCategoryAPI</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      categoryList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">result</span>;</span><br><span class="line">      isLoading.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123; categoryList, getCategory, isLoading &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="四、Home-页"><a href="#四、Home-页" class="headerlink" title="四、Home 页"></a>四、Home 页</h2><h3 id="1、总体架构-1"><a href="#1、总体架构-1" class="headerlink" title="1、总体架构"></a>1、总体架构</h3><p>Home 页整体结构如下</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230601103822925.png" alt="image-20230601103822925"></p>
<p>按照结构新增五个组件，并在 Home 模块的入口组件中引入</p>
<p>Home&#x2F;index.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import HomeCategory from &quot;./HomeCategory.vue&quot;;</span><br><span class="line">import HomeBanner from &quot;./HomeBanner.vue&quot;;</span><br><span class="line">import HomeHot from &quot;./HomeHot.vue&quot;;</span><br><span class="line">import HomeNew from &quot;./HomeNew.vue&quot;;</span><br><span class="line">import HomeProduct from &quot;./HomeProduct.vue&quot;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;!-- 分类区域 --&gt;</span><br><span class="line">    &lt;HomeCategory /&gt;</span><br><span class="line">    &lt;!-- 轮播图区域 --&gt;</span><br><span class="line">    &lt;HomeBanner /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- 新鲜好物区域 --&gt;</span><br><span class="line">  &lt;HomeNew /&gt;</span><br><span class="line">  &lt;!-- 人气推荐区域 --&gt;</span><br><span class="line">  &lt;HomeHot /&gt;</span><br><span class="line">  &lt;!-- 产品列表区域 --&gt;</span><br><span class="line">  &lt;HomeProduct /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>其中 HomeCategory 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useCategoryStore &#125; from &quot;@/stores/category&quot;;</span><br><span class="line">const &#123; categoryList, isLoading &#125; = toRefs(useCategoryStore());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home-category&quot;&gt;</span><br><span class="line">    &lt;ul class=&quot;menu&quot;&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in categoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;!-- 骨架屏 --&gt;</span><br><span class="line">        &lt;el-skeleton</span><br><span class="line">          style=&quot;width: 200px&quot;</span><br><span class="line">          :loading=&quot;isLoading&quot;</span><br><span class="line">          animated</span><br><span class="line">          :throttle=&quot;10000&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template #template&gt;</span><br><span class="line">            &lt;el-skeleton-item variant=&quot;p&quot; style=&quot;width: 32px; height: 20px&quot; /&gt;</span><br><span class="line">            &lt;el-skeleton-item</span><br><span class="line">              variant=&quot;p&quot;</span><br><span class="line">              style=&quot;width: 100px; margin-left: 10px&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template #default&gt;</span><br><span class="line">            &lt;RouterLink :to=&quot;`/category/$&#123;item.id&#125;`&quot;&gt;&#123;&#123;</span><br><span class="line">              item.name</span><br><span class="line">            &#125;&#125;&lt;/RouterLink&gt;</span><br><span class="line">            &lt;RouterLink</span><br><span class="line">              v-for=&quot;i in item.children.slice(0, 2)&quot;</span><br><span class="line">              :key=&quot;i.id&quot;</span><br><span class="line">              :to=&quot;`/category/sub/$&#123;i.id&#125;`&quot;</span><br><span class="line">              &gt;&#123;&#123; i.name &#125;&#125;&lt;/RouterLink</span><br><span class="line">            &gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-skeleton&gt;</span><br><span class="line">        &lt;!-- 弹层layer位置 --&gt;</span><br><span class="line">        &lt;div class=&quot;layer&quot;&gt;</span><br><span class="line">          &lt;h4&gt;分类推荐 &lt;small&gt;根据您的购买或浏览记录推荐&lt;/small&gt;&lt;/h4&gt;</span><br><span class="line">          &lt;ul&gt;</span><br><span class="line">            &lt;li v-for=&quot;i in item.goods&quot; :key=&quot;i.id&quot;&gt;</span><br><span class="line">              &lt;RouterLink :to=&quot;`/goodsInfo/$&#123;i.id&#125;`&quot;&gt;</span><br><span class="line">                &lt;img alt=&quot;&quot; :src=&quot;i.picture&quot; /&gt;</span><br><span class="line">                &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">                  &lt;p class=&quot;name ellipsis-2&quot;&gt;&#123;&#123; i.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                  &lt;p class=&quot;desc ellipsis&quot;&gt;&#123;&#123; i.desc &#125;&#125;&lt;/p&gt;</span><br><span class="line">                  &lt;p class=&quot;price&quot;&gt;&lt;i&gt;¥&lt;/i&gt;&#123;&#123; i.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/RouterLink&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">          &lt;/ul&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.home-category &#123;</span><br><span class="line">  width: 250px;</span><br><span class="line">  height: 500px;</span><br><span class="line">  background: rgba(0, 0, 0, 0.8);</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 99;</span><br><span class="line"></span><br><span class="line">  .menu &#123;</span><br><span class="line">    li &#123;</span><br><span class="line">      padding-left: 40px;</span><br><span class="line">      height: 55px;</span><br><span class="line">      line-height: 55px;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        background: $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        margin-right: 4px;</span><br><span class="line">        color: #fff;</span><br><span class="line"></span><br><span class="line">        &amp;:first-child &#123;</span><br><span class="line">          font-size: 16px;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .layer &#123;</span><br><span class="line">        width: 990px;</span><br><span class="line">        height: 500px;</span><br><span class="line">        background: rgba(255, 255, 255, 0.8);</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 250px;</span><br><span class="line">        top: 0;</span><br><span class="line">        display: none;</span><br><span class="line">        padding: 0 15px;</span><br><span class="line"></span><br><span class="line">        h4 &#123;</span><br><span class="line">          font-size: 20px;</span><br><span class="line">          font-weight: normal;</span><br><span class="line">          line-height: 80px;</span><br><span class="line"></span><br><span class="line">          small &#123;</span><br><span class="line">            font-size: 16px;</span><br><span class="line">            color: #666;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ul &#123;</span><br><span class="line">          display: flex;</span><br><span class="line">          flex-wrap: wrap;</span><br><span class="line"></span><br><span class="line">          li &#123;</span><br><span class="line">            width: 310px;</span><br><span class="line">            height: 120px;</span><br><span class="line">            margin-right: 15px;</span><br><span class="line">            margin-bottom: 15px;</span><br><span class="line">            border: 1px solid #eee;</span><br><span class="line">            border-radius: 4px;</span><br><span class="line">            background: #fff;</span><br><span class="line"></span><br><span class="line">            &amp;:nth-child(3n) &#123;</span><br><span class="line">              margin-right: 0;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            a &#123;</span><br><span class="line">              display: flex;</span><br><span class="line">              width: 100%;</span><br><span class="line">              height: 100%;</span><br><span class="line">              align-items: center;</span><br><span class="line">              padding: 10px;</span><br><span class="line"></span><br><span class="line">              &amp;:hover &#123;</span><br><span class="line">                background: #e3f9f4;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              img &#123;</span><br><span class="line">                width: 95px;</span><br><span class="line">                height: 95px;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              .info &#123;</span><br><span class="line">                padding-left: 10px;</span><br><span class="line">                line-height: 24px;</span><br><span class="line">                overflow: hidden;</span><br><span class="line"></span><br><span class="line">                .name &#123;</span><br><span class="line">                  font-size: 16px;</span><br><span class="line">                  color: #666;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                .desc &#123;</span><br><span class="line">                  color: #999;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                .price &#123;</span><br><span class="line">                  font-size: 22px;</span><br><span class="line">                  color: $priceColor;</span><br><span class="line"></span><br><span class="line">                  i &#123;</span><br><span class="line">                    font-size: 16px;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 关键样式  hover状态下的layer盒子变成block</span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        .layer &#123;</span><br><span class="line">          display: block;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>HomeBanner 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; getBannerAPI &#125; from &quot;@/apis/home&quot;;</span><br><span class="line">const bannerList = ref([]);</span><br><span class="line">getBannerAPI().then((res) =&gt; &#123;</span><br><span class="line">  bannerList.value = res.data.result;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home-banner&quot;&gt;</span><br><span class="line">    &lt;el-carousel height=&quot;500px&quot;&gt;</span><br><span class="line">      &lt;el-carousel-item v-for=&quot;item in bannerList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;img :src=&quot;item.imgUrl&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">      &lt;/el-carousel-item&gt;</span><br><span class="line">    &lt;/el-carousel&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.home-banner &#123;</span><br><span class="line">  width: 1240px;</span><br><span class="line">  height: 500px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  z-index: 98;</span><br><span class="line"></span><br><span class="line">  img &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 500px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>HomeNew 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import HomePanel from &quot;./HomePanel.vue&quot;;</span><br><span class="line">import &#123; getNewList &#125; from &quot;@/apis/home&quot;;</span><br><span class="line">import &#123; useRequestLazy &#125; from &quot;@/hooks/request-lazy&quot;;</span><br><span class="line">const &#123; target, list, isLoading &#125; = useRequestLazy(getNewList);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;HomePanel title=&quot;新鲜好物&quot; sub-title=&quot;新鲜出炉 品质靠谱&quot; ref=&quot;target&quot;&gt;</span><br><span class="line">    &lt;ul class=&quot;goods-list&quot;&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;!-- 骨架屏 --&gt;</span><br><span class="line">        &lt;el-skeleton style=&quot;width: 306px&quot; animated :loading=&quot;isLoading&quot;&gt;</span><br><span class="line">          &lt;template #template&gt;</span><br><span class="line">            &lt;el-skeleton-item</span><br><span class="line">              variant=&quot;image&quot;</span><br><span class="line">              style=&quot;width: 306px; height: 306px&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">            &lt;div style=&quot;padding: 14px; text-align: center&quot;&gt;</span><br><span class="line">              &lt;el-skeleton-item variant=&quot;p&quot; style=&quot;width: 50%&quot; /&gt;</span><br><span class="line">              &lt;div</span><br><span class="line">                style=&quot;display: flex; align-items: center; justify-items: space-between&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;el-skeleton-item variant=&quot;text&quot; style=&quot;margin-right: 16px&quot; /&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template #default&gt;</span><br><span class="line">            &lt;RouterLink :to=&quot;`/goodsInfo/$&#123;item.id&#125;`&quot;&gt;</span><br><span class="line">              &lt;img :src=&quot;item.picture&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">              &lt;p&gt;&#123;&#123; item.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;price&quot;&gt;&amp;yen;&#123;&#123; item.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;/RouterLink&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-skeleton&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/HomePanel&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.goods-list &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  height: 406px;</span><br><span class="line"></span><br><span class="line">  li &#123;</span><br><span class="line">    width: 306px;</span><br><span class="line">    height: 406px;</span><br><span class="line"></span><br><span class="line">    background: #f0f9f4;</span><br><span class="line">    transition: all 0.5s;</span><br><span class="line"></span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      transform: translate3d(0, -3px, 0);</span><br><span class="line">      box-shadow: 0 3px 8px rgb(0 0 0 / 20%);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 306px;</span><br><span class="line">      height: 306px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 22px;</span><br><span class="line">      padding-top: 12px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      text-overflow: ellipsis;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      white-space: nowrap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .price &#123;</span><br><span class="line">      color: $priceColor;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>这里由于几个模块结构类似，因此封装了一个 HomePanel 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">defineProps(&#123;</span><br><span class="line">  title: &#123;</span><br><span class="line">    type: String,</span><br><span class="line">    require: true,</span><br><span class="line">  &#125;,</span><br><span class="line">  subTitle: &#123;</span><br><span class="line">    type: String,</span><br><span class="line">    require: true,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home-panel&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;head&quot;&gt;</span><br><span class="line">        &lt;!-- 主标题和副标题 --&gt;</span><br><span class="line">        &lt;h3&gt;</span><br><span class="line">          &#123;&#123; title &#125;&#125;&lt;small&gt;&#123;&#123; subTitle &#125;&#125;&lt;/small&gt;</span><br><span class="line">        &lt;/h3&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 主体内容区域 --&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.home-panel &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .head &#123;</span><br><span class="line">    padding: 40px 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: flex-end;</span><br><span class="line"></span><br><span class="line">    h3 &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      font-size: 32px;</span><br><span class="line">      font-weight: normal;</span><br><span class="line">      margin-left: 6px;</span><br><span class="line">      height: 35px;</span><br><span class="line">      line-height: 35px;</span><br><span class="line"></span><br><span class="line">      small &#123;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        color: #999;</span><br><span class="line">        margin-left: 20px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>HomeHot 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import HomePanel from &quot;./HomePanel.vue&quot;;</span><br><span class="line">import &#123; getHotList &#125; from &quot;@/apis/home&quot;;</span><br><span class="line">import &#123; useRequestLazy &#125; from &quot;@/hooks/request-lazy&quot;;</span><br><span class="line">const &#123; target, list, isLoading &#125; = useRequestLazy(getHotList);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;HomePanel title=&quot;人气推荐&quot; sub-title=&quot;人气爆款 不容错过&quot; ref=&quot;target&quot;&gt;</span><br><span class="line">    &lt;ul class=&quot;goods-list&quot;&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;!-- 骨架屏 --&gt;</span><br><span class="line">        &lt;el-skeleton style=&quot;width: 306px&quot; animated :loading=&quot;isLoading&quot;&gt;</span><br><span class="line">          &lt;template #template&gt;</span><br><span class="line">            &lt;el-skeleton-item</span><br><span class="line">              variant=&quot;image&quot;</span><br><span class="line">              style=&quot;width: 306px; height: 306px&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">            &lt;div style=&quot;padding: 14px; text-align: center&quot;&gt;</span><br><span class="line">              &lt;el-skeleton-item variant=&quot;p&quot; style=&quot;width: 50%&quot; /&gt;</span><br><span class="line">              &lt;div</span><br><span class="line">                style=&quot;display: flex; align-items: center; justify-items: space-between&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;el-skeleton-item variant=&quot;text&quot; style=&quot;margin-right: 16px&quot; /&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template #default&gt;</span><br><span class="line">            &lt;RouterLink to=&quot;/&quot;&gt;</span><br><span class="line">              &lt;img :src=&quot;item.picture&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">              &lt;p class=&quot;name&quot;&gt;&#123;&#123; item.title &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;alt&quot;&gt;&#123;&#123; item.alt &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;/RouterLink&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-skeleton&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/HomePanel&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.goods-list &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  height: 406px;</span><br><span class="line"></span><br><span class="line">  li &#123;</span><br><span class="line">    width: 306px;</span><br><span class="line">    height: 406px;</span><br><span class="line"></span><br><span class="line">    background: #f0f9f4;</span><br><span class="line">    transition: all 0.5s;</span><br><span class="line"></span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      transform: translate3d(0, -3px, 0);</span><br><span class="line">      box-shadow: 0 3px 8px rgb(0 0 0 / 20%);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 306px;</span><br><span class="line">      height: 306px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 22px;</span><br><span class="line">      padding-top: 12px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      text-overflow: ellipsis;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      white-space: nowrap;</span><br><span class="line">    &#125;</span><br><span class="line">    .alt &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      color: #b5b5b5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>HomeProduct 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import HomePanel from &quot;./HomePanel.vue&quot;;</span><br><span class="line">import &#123; getGoods &#125; from &quot;@/apis/home&quot;;</span><br><span class="line">const goodsList = ref([]);</span><br><span class="line">getGoods().then((res) =&gt; &#123;</span><br><span class="line">  goodsList.value = res.data.result;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home-product&quot;&gt;</span><br><span class="line">    &lt;HomePanel :title=&quot;cate.name&quot; v-for=&quot;cate in goodsList&quot; :key=&quot;cate.id&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">        &lt;RouterLink class=&quot;cover&quot; :to=&quot;`/category/$&#123;cate.id&#125;`&quot;&gt;</span><br><span class="line">          &lt;el-image lazy fit=&quot;fill&quot; :src=&quot;cate.picture&quot;&gt;</span><br><span class="line">            &lt;template #error&gt;</span><br><span class="line">              &lt;div class=&quot;image-slot&quot;&gt;</span><br><span class="line">                &lt;el-image src=&quot;@/assets/images/200.png&quot;&gt;&lt;/el-image&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/el-image&gt;</span><br><span class="line">          &lt;strong class=&quot;label&quot;&gt;</span><br><span class="line">            &lt;span&gt;&#123;&#123; cate.name &#125;&#125;馆&lt;/span&gt;</span><br><span class="line">            &lt;span&gt;&#123;&#123; cate.saleInfo &#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;/strong&gt;</span><br><span class="line">        &lt;/RouterLink&gt;</span><br><span class="line">        &lt;ul class=&quot;goods-list&quot;&gt;</span><br><span class="line">          &lt;li v-for=&quot;good in cate.goods&quot; :key=&quot;good.id&quot;&gt;</span><br><span class="line">            &lt;GoodsItem :goods=&quot;good&quot; /&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/HomePanel&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.home-product &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">  margin-top: -20px;</span><br><span class="line">  .sub &#123;</span><br><span class="line">    margin-bottom: 2px;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      padding: 2px 12px;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      border-radius: 4px;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        background: $xtxColor;</span><br><span class="line">        color: #fff;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        margin-right: 80px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .box &#123;</span><br><span class="line">    display: flex;</span><br><span class="line"></span><br><span class="line">    .cover &#123;</span><br><span class="line">      width: 240px;</span><br><span class="line">      height: 610px;</span><br><span class="line">      margin-right: 10px;</span><br><span class="line">      position: relative;</span><br><span class="line"></span><br><span class="line">      img &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .label &#123;</span><br><span class="line">        width: 188px;</span><br><span class="line">        height: 66px;</span><br><span class="line">        display: flex;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">        color: #fff;</span><br><span class="line">        line-height: 66px;</span><br><span class="line">        font-weight: normal;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 0;</span><br><span class="line">        top: 50%;</span><br><span class="line">        transform: translate3d(0, -50%, 0);</span><br><span class="line"></span><br><span class="line">        span &#123;</span><br><span class="line">          text-align: center;</span><br><span class="line"></span><br><span class="line">          &amp;:first-child &#123;</span><br><span class="line">            width: 76px;</span><br><span class="line">            background: rgba(0, 0, 0, 0.9);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          &amp;:last-child &#123;</span><br><span class="line">            flex: 1;</span><br><span class="line">            background: rgba(0, 0, 0, 0.7);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .goods-list &#123;</span><br><span class="line">      width: 990px;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-wrap: wrap;</span><br><span class="line"></span><br><span class="line">      li &#123;</span><br><span class="line">        width: 240px;</span><br><span class="line">        height: 300px;</span><br><span class="line">        margin-right: 10px;</span><br><span class="line">        margin-bottom: 10px;</span><br><span class="line"></span><br><span class="line">        &amp;:nth-last-child(-n + 4) &#123;</span><br><span class="line">          margin-bottom: 0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;:nth-child(4n) &#123;</span><br><span class="line">          margin-right: 0;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .goods-item &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      width: 220px;</span><br><span class="line">      padding: 20px 30px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      transition: all 0.5s;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        transform: translate3d(0, -3px, 0);</span><br><span class="line">        box-shadow: 0 3px 8px rgb(0 0 0 / 20%);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      img &#123;</span><br><span class="line">        width: 160px;</span><br><span class="line">        height: 160px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      p &#123;</span><br><span class="line">        padding-top: 10px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .name &#123;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .desc &#123;</span><br><span class="line">        color: #999;</span><br><span class="line">        height: 29px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .price &#123;</span><br><span class="line">        color: $priceColor;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>同样的结构类似，并且在后面的模块中会多次用到。因此在 src&#x2F;components 下封装一个全局组件 GoodsItem</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import errorIMG from &quot;@/assets/images/200.png&quot;;</span><br><span class="line">defineProps(&#123;</span><br><span class="line">  goods: &#123;</span><br><span class="line">    type: Object,</span><br><span class="line">    default: () =&gt; &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;RouterLink :to=&quot;`/goodsInfo/$&#123;goods.id&#125;`&quot; class=&quot;goods-item&quot;&gt;</span><br><span class="line">    &lt;el-image lazy :src=&quot;goods.picture&quot; alt=&quot;&quot;&gt;</span><br><span class="line">      &lt;template #error&gt;</span><br><span class="line">        &lt;div class=&quot;image-slot&quot;&gt;</span><br><span class="line">          &lt;el-image :src=&quot;errorIMG&quot;&gt;&lt;/el-image&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-image&gt;</span><br><span class="line">    &lt;p class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p class=&quot;desc ellipsis&quot;&gt;&#123;&#123; goods.desc &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p class=&quot;price&quot;&gt;&amp;yen;&#123;&#123; goods.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/RouterLink&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.goods-item &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  width: 220px;</span><br><span class="line">  padding: 20px 30px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  transition: all 0.5s;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    transform: translate3d(0, -3px, 0);</span><br><span class="line">    box-shadow: 0 3px 8px rgb(0 0 0 / 20%);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  img &#123;</span><br><span class="line">    width: 160px;</span><br><span class="line">    height: 160px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  p &#123;</span><br><span class="line">    padding-top: 10px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .name &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .desc &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    height: 29px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .price &#123;</span><br><span class="line">    color: $priceColor;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>不要忘了全局注册它</p>
<p>在 src&#x2F;components&#x2F;index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通用组件全局注册</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">GoodsItem</span> <span class="keyword">from</span> <span class="string">&quot;./GoodsItem.vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app</span>) &#123;</span><br><span class="line">    app.<span class="title function_">component</span>(<span class="string">&quot;GoodsItem&quot;</span>, <span class="title class_">GoodsItem</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>main.js 中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...省略其他代码</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&quot;./components/index.js&quot;</span>;</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">Components</span>);</span><br><span class="line"><span class="comment">// ...省略其他代码</span></span><br></pre></td></tr></table></figure>

<h3 id="2、实现数据懒加载和图片懒加载"><a href="#2、实现数据懒加载和图片懒加载" class="headerlink" title="2、实现数据懒加载和图片懒加载"></a>2、实现数据懒加载和图片懒加载</h3><p>对于这种页面较长的网页，可以使用数据懒加载来优化性能。</p>
<p>数据懒加载的核心逻辑：当页面滚动到当前模块，也即模块在可视区域时才发起请求加载数据。而不是一上来就将数据全部加载。问题的关键在于如何判断模块是否处于可视区域了呢。</p>
<p>这里同样使用@vueuse&#x2F;core 提供的 useIntersectionObserver 方法，它可以方便的检测模块是否处于可视区域</p>
<p>由于这是一个公共的方法，因此在 src 下新建 hooks&#x2F;request-lazy.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用vueuse的useIntersectionObserver封装一个请求懒加载的方法</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useIntersectionObserver &#125; <span class="keyword">from</span> <span class="string">&quot;@vueuse/core&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useRequestLazy</span>(<span class="params">apiFn</span>) &#123;</span><br><span class="line">  <span class="comment">// 定义一个判断数据是否在加载的变量</span></span><br><span class="line">  <span class="keyword">const</span> isLoading = <span class="title function_">ref</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="comment">// 监视的目标ref对象容器，最后返回出去</span></span><br><span class="line">  <span class="keyword">const</span> target = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="comment">// 发送请求得到的数据</span></span><br><span class="line">  <span class="keyword">const</span> list = <span class="title function_">ref</span>([]);</span><br><span class="line">  <span class="keyword">const</span> &#123; stop &#125; = <span class="title function_">useIntersectionObserver</span>(target, <span class="function">(<span class="params">[&#123; isIntersecting &#125;]</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 进入可视区域的逻辑</span></span><br><span class="line">    <span class="keyword">if</span> (isIntersecting) &#123;</span><br><span class="line">      <span class="title function_">stop</span>();</span><br><span class="line">      <span class="title function_">apiFn</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        list.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">result</span>;</span><br><span class="line">        isLoading.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    target,</span><br><span class="line">    list,</span><br><span class="line">    isLoading,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以后就可以在需要做数据懒加载的地方使用它了</p>
<p>图片懒加载我直接使用了 el-image 的 lazy 属性，当然也可以自己封装一个图片懒加载自定义指令来实现。图片懒加载自定义指令的核心逻辑与数据懒加载一样，因此它主要还是用到@vueuse&#x2F;core 提供的 useIntersectionObserver 方法</p>
<h3 id="3、骨架屏效果"><a href="#3、骨架屏效果" class="headerlink" title="3、骨架屏效果"></a>3、骨架屏效果</h3><p>为了优化用户体验，这种涉及图片较多、页面较长、加载速度可能较慢的网站，可以使用骨架屏效果</p>
<p>**<em>但是，这个项目我用 Element-Plus 提供的骨架屏组件始终不生效，不知道哪里不对</em>**😂😂😂</p>
<h2 id="五、一级分类页"><a href="#五、一级分类页" class="headerlink" title="五、一级分类页"></a>五、一级分类页</h2><h3 id="1、总体架构-2"><a href="#1、总体架构-2" class="headerlink" title="1、总体架构"></a>1、总体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getTopCategoryAPI &#125; from &quot;@/apis/category&quot;;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRoute, onBeforeRouteUpdate &#125; from &quot;vue-router&quot;;</span><br><span class="line">import &#123; getBannerAPI &#125; from &quot;@/apis/home&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">// 获取一级分类数据</span><br><span class="line">const categoryData = ref(&#123;&#125;);</span><br><span class="line">const getTopCategory = (id) =&gt; &#123;</span><br><span class="line">  getTopCategoryAPI(id).then((res) =&gt; &#123;</span><br><span class="line">    categoryData.value = res.data.result;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">getTopCategory(route.params.id);</span><br><span class="line">// 会有缓存问题：当路由path一样，参数不同的时候会优先复用路由对应的组件，而不是销毁重建,调用onBeforeRouteUpdate解决该问题，它能检测路由变化</span><br><span class="line">onBeforeRouteUpdate((to) =&gt; getTopCategory(to.params.id));</span><br><span class="line">// 获取轮播图数据</span><br><span class="line">const bannerList = ref([]);</span><br><span class="line">getBannerAPI(2).then((res) =&gt; &#123;</span><br><span class="line">  bannerList.value = res.data.result;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;top-category&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container m-top-20&quot;&gt;</span><br><span class="line">      &lt;!-- 面包屑 --&gt;</span><br><span class="line">      &lt;div class=&quot;bread-container&quot;&gt;</span><br><span class="line">        &lt;el-breadcrumb separator=&quot;&gt;&quot;&gt;</span><br><span class="line">          &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item&gt;&#123;&#123; categoryData.name &#125;&#125;&lt;/el-breadcrumb-item&gt;</span><br><span class="line">        &lt;/el-breadcrumb&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 轮播图 --&gt;</span><br><span class="line">      &lt;el-carousel height=&quot;500px&quot; class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;el-carousel-item v-for=&quot;item in bannerList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;item.imgUrl&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">        &lt;/el-carousel-item&gt;</span><br><span class="line">      &lt;/el-carousel&gt;</span><br><span class="line">      &lt;!-- 分类数据 --&gt;</span><br><span class="line">      &lt;div class=&quot;sub-list&quot;&gt;</span><br><span class="line">        &lt;h3&gt;全部分类&lt;/h3&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &lt;li v-for=&quot;i in categoryData.children&quot; :key=&quot;i.id&quot;&gt;</span><br><span class="line">            &lt;RouterLink :to=&quot;`/category/sub/$&#123;i.id&#125;`&quot;&gt;</span><br><span class="line">              &lt;img :src=&quot;i.picture&quot; /&gt;</span><br><span class="line">              &lt;p&gt;&#123;&#123; i.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;/RouterLink&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;ref-goods&quot;</span><br><span class="line">        v-for=&quot;item in categoryData.children&quot;</span><br><span class="line">        :key=&quot;item.id&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;div class=&quot;head&quot;&gt;</span><br><span class="line">          &lt;h3&gt;- &#123;&#123; item.name &#125;&#125;-&lt;/h3&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;body&quot;&gt;</span><br><span class="line">          &lt;GoodsItem v-for=&quot;good in item.goods&quot; :goods=&quot;good&quot; :key=&quot;good.id&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.top-category &#123;</span><br><span class="line">  h3 &#123;</span><br><span class="line">    font-size: 28px;</span><br><span class="line">    color: #666;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 100px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .sub-list &#123;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    background-color: #fff;</span><br><span class="line"></span><br><span class="line">    ul &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      padding: 0 32px;</span><br><span class="line">      flex-wrap: wrap;</span><br><span class="line"></span><br><span class="line">      li &#123;</span><br><span class="line">        width: 168px;</span><br><span class="line">        height: 160px;</span><br><span class="line"></span><br><span class="line">        a &#123;</span><br><span class="line">          text-align: center;</span><br><span class="line">          display: block;</span><br><span class="line">          font-size: 16px;</span><br><span class="line"></span><br><span class="line">          img &#123;</span><br><span class="line">            width: 100px;</span><br><span class="line">            height: 100px;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          p &#123;</span><br><span class="line">            line-height: 40px;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          &amp;:hover &#123;</span><br><span class="line">            color: $xtxColor;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .ref-goods &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    .head &#123;</span><br><span class="line">      .xtx-more &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: 20px;</span><br><span class="line">        right: 20px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .tag &#123;</span><br><span class="line">        text-align: center;</span><br><span class="line">        color: #999;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        position: relative;</span><br><span class="line">        top: -20px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .body &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: space-around;</span><br><span class="line">      padding: 0 40px 30px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .bread-container &#123;</span><br><span class="line">    padding: 25px 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、路由缓存问题解决"><a href="#2、路由缓存问题解决" class="headerlink" title="2、路由缓存问题解决"></a>2、路由缓存问题解决</h3><p>使用带有参数的路由时需要注意的是，当路由 path 一样，参数不同的时候<strong>相同的组件实例将被重复使用</strong>。因为两个路由都渲染同个组件，比起销毁再创建，复用则显得更加高效。<strong>不过，这也意味着组件的生命周期钩子不会被调用</strong>。因此当我们在不同分类间切换时会发现，路径确实发生了变化，但对应的页面并没有任何变化</p>
<p>解决方案：使用 onBeforeRouteUpdate 钩子函数，做精确更新</p>
<p><em>详情参考<a target="_blank" rel="noopener" href="https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E5%93%8D%E5%BA%94%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E7%9A%84%E5%8F%98%E5%8C%96">https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E5%93%8D%E5%BA%94%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E7%9A%84%E5%8F%98%E5%8C%96</a></em></p>
<h2 id="六、二级分类页"><a href="#六、二级分类页" class="headerlink" title="六、二级分类页"></a>六、二级分类页</h2><h3 id="1、整体架构"><a href="#1、整体架构" class="headerlink" title="1、整体架构"></a>1、整体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getCategoryFilterAPI, getSubCategoryAPI &#125; from &quot;@/apis/sub-category&quot;;</span><br><span class="line">import &#123; useRoute &#125; from &quot;vue-router&quot;;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import GoodsItem from &quot;@/components/GoodsItem.vue&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">const subCategoryData = ref(&#123;&#125;);</span><br><span class="line">const activeName = ref(&quot;publishTime&quot;);</span><br><span class="line">getCategoryFilterAPI(route.params.id).then((res) =&gt; &#123;</span><br><span class="line">  subCategoryData.value = res.data.result;</span><br><span class="line">&#125;);</span><br><span class="line">// 选项卡改变时</span><br><span class="line">const queryData = ref(&#123;</span><br><span class="line">  categoryId: subCategoryData.value.parentId,</span><br><span class="line">  page: 1,</span><br><span class="line">  pageSize: 20,</span><br><span class="line">  sortField: &quot;publishTime&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const goodsList = ref([]);</span><br><span class="line">const getSubCategory = () =&gt; &#123;</span><br><span class="line">  getSubCategoryAPI(queryData.value).then((res) =&gt; &#123;</span><br><span class="line">    goodsList.value = [...goodsList.value, ...res.data.result.items];</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">getSubCategory();</span><br><span class="line">const changeSelected = (val) =&gt; &#123;</span><br><span class="line">  queryData.value.sortField = val;</span><br><span class="line">  getSubCategory();</span><br><span class="line">&#125;;</span><br><span class="line">// 无限滚动加载</span><br><span class="line">const disabled = ref(false);</span><br><span class="line">const load = () =&gt; &#123;</span><br><span class="line">  queryData.value.page++;</span><br><span class="line">  getSubCategoryAPI(queryData.value).then((res) =&gt; &#123;</span><br><span class="line">    goodsList.value = [...goodsList.value, ...res.data.result.items];</span><br><span class="line">    if (!res.data.result.items.length) disabled.value = true;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;!-- 面包屑 --&gt;</span><br><span class="line">    &lt;div class=&quot;bread-container&quot;&gt;</span><br><span class="line">      &lt;el-breadcrumb separator=&quot;&gt;&quot;&gt;</span><br><span class="line">        &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;</span><br><span class="line">        &lt;el-breadcrumb-item :to=&quot;`/category/$&#123;subCategoryData.parentId&#125;`&quot;&gt;&#123;&#123;</span><br><span class="line">          subCategoryData.parentName</span><br><span class="line">        &#125;&#125;&lt;/el-breadcrumb-item&gt;</span><br><span class="line">        &lt;el-breadcrumb-item&gt;&#123;&#123; subCategoryData.name &#125;&#125;&lt;/el-breadcrumb-item&gt;</span><br><span class="line">      &lt;/el-breadcrumb&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;sub-container&quot;&gt;</span><br><span class="line">      &lt;el-tabs @tab-change=&quot;changeSelected&quot; v-model=&quot;activeName&quot;&gt;</span><br><span class="line">        &lt;el-tab-pane label=&quot;最新商品&quot; name=&quot;publishTime&quot;&gt;&lt;/el-tab-pane&gt;</span><br><span class="line">        &lt;el-tab-pane label=&quot;最高人气&quot; name=&quot;orderNum&quot;&gt;&lt;/el-tab-pane&gt;</span><br><span class="line">        &lt;el-tab-pane label=&quot;评论最多&quot; name=&quot;evaluateNum&quot;&gt;&lt;/el-tab-pane&gt;</span><br><span class="line">      &lt;/el-tabs&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;body&quot;</span><br><span class="line">        v-infinite-scroll=&quot;load&quot;</span><br><span class="line">        :infinite-scroll-disabled=&quot;disabled&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;!-- 商品列表--&gt;</span><br><span class="line">        &lt;GoodsItem v-for=&quot;item in goodsList&quot; :key=&quot;item.id&quot; :goods=&quot;item&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.bread-container &#123;</span><br><span class="line">  padding: 25px 0;</span><br><span class="line">  color: #666;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.sub-container &#123;</span><br><span class="line">  padding: 20px 10px;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .body &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    padding: 0 10px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-item &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    width: 220px;</span><br><span class="line">    margin-right: 20px;</span><br><span class="line">    padding: 20px 30px;</span><br><span class="line">    text-align: center;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 160px;</span><br><span class="line">      height: 160px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      padding-top: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .desc &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">      height: 29px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .price &#123;</span><br><span class="line">      color: $priceColor;</span><br><span class="line">      font-size: 20px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .pagination-container &#123;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="七、商品详情"><a href="#七、商品详情" class="headerlink" title="七、商品详情"></a>七、商品详情</h2><h3 id="1、整体架构-1"><a href="#1、整体架构-1" class="headerlink" title="1、整体架构"></a>1、整体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getDetail &#125; from &quot;@/apis/goodsInfo&quot;;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRoute &#125; from &quot;vue-router&quot;;</span><br><span class="line">import GoodsHot from &quot;./goodsHot.vue&quot;;</span><br><span class="line">import GoodsPreview from &quot;@/components/goodsPreview.vue&quot;;</span><br><span class="line">import GoodsSKU from &quot;@/XtxSku/index.vue&quot;;</span><br><span class="line">import &#123; useCartStore &#125; from &quot;@/stores/cart&quot;;</span><br><span class="line">import &#123; ElMessage &#125; from &quot;element-plus&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">const goodsInfo = ref(&#123;&#125;);</span><br><span class="line">const getGoodsInfo = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getDetail(route.params.id);</span><br><span class="line">  goodsInfo.value = data.result;</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  getGoodsInfo();</span><br><span class="line">&#125;);</span><br><span class="line">// 数量数据</span><br><span class="line">const count = ref(1);</span><br><span class="line">const countChange = (val) =&gt; &#123;</span><br><span class="line">  count.value = val;</span><br><span class="line">&#125;;</span><br><span class="line">// SKU组件得到的数据</span><br><span class="line">const SKUData = ref(&#123;&#125;);</span><br><span class="line">const change = (data) =&gt; &#123;</span><br><span class="line">  SKUData.value = data;</span><br><span class="line">&#125;;</span><br><span class="line">// 加入购物车</span><br><span class="line">const &#123; addCart &#125; = useCartStore();</span><br><span class="line">const addtocart = () =&gt; &#123;</span><br><span class="line">  if (!SKUData.value.skuId) return ElMessage.warning(&quot;请选择规格&quot;);</span><br><span class="line">  addCart(&#123;</span><br><span class="line">    id: goodsInfo.value.id,</span><br><span class="line">    name: goodsInfo.value.name,</span><br><span class="line">    picture: goodsInfo.value.mainPictures[0],</span><br><span class="line">    price: goodsInfo.value.price,</span><br><span class="line">    count: count.value,</span><br><span class="line">    skuId: SKUData.value.skuId,</span><br><span class="line">    attrsText: SKUData.value.specsText,</span><br><span class="line">    selected: true,</span><br><span class="line">  &#125;);</span><br><span class="line">  ElMessage.success(&quot;加入购物车成功&quot;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;xtx-goods-page&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;bread-container&quot;&gt;</span><br><span class="line">        &lt;el-breadcrumb separator=&quot;&gt;&quot; v-if=&quot;goodsInfo.categories&quot;&gt;</span><br><span class="line">          &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item :to=&quot;`category/$&#123;goodsInfo.categories[1].id&#125;`&quot;</span><br><span class="line">            &gt;&#123;&#123; goodsInfo.categories[1].name &#125;&#125;</span><br><span class="line">          &lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item :to=&quot;`category/sub/$&#123;goodsInfo.categories[0].id&#125;`&quot;</span><br><span class="line">            &gt;&#123;&#123; goodsInfo.categories[0].name &#125;&#125;</span><br><span class="line">          &lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item&gt;&#123;&#123; goodsInfo.name &#125;&#125;&lt;/el-breadcrumb-item&gt;</span><br><span class="line">        &lt;/el-breadcrumb&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 商品信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;info-container&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;div class=&quot;goods-info&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;media&quot;&gt;</span><br><span class="line">              &lt;!-- 图片预览区 --&gt;</span><br><span class="line">              &lt;GoodsPreview :mainPictures=&quot;goodsInfo.mainPictures&quot; /&gt;</span><br><span class="line">              &lt;!-- 统计数量 --&gt;</span><br><span class="line">              &lt;ul class=&quot;goods-sales&quot;&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;p&gt;销量人气&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&#123;&#123; goodsInfo.salesCount &#125;&#125;+&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&lt;i class=&quot;iconfont icon-task-filling&quot;&gt;&lt;/i&gt;销量人气&lt;/p&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;p&gt;商品评价&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&#123;&#123; goodsInfo.commentCount &#125;&#125;+&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&lt;i class=&quot;iconfont icon-comment-filling&quot;&gt;&lt;/i&gt;查看评价&lt;/p&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;p&gt;收藏人气&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&#123;&#123; goodsInfo.collectCount &#125;&#125;+&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&lt;i class=&quot;iconfont icon-favorite-filling&quot;&gt;&lt;/i&gt;收藏商品&lt;/p&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;p&gt;品牌信息&lt;/p&gt;</span><br><span class="line">                  &lt;p v-if=&quot;goodsInfo.brand&quot;&gt;&#123;&#123; goodsInfo.brand.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                  &lt;p&gt;&lt;i class=&quot;iconfont icon-dynamic-filling&quot;&gt;&lt;/i&gt;品牌主页&lt;/p&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;spec&quot;&gt;</span><br><span class="line">              &lt;!-- 商品信息区 --&gt;</span><br><span class="line">              &lt;p class=&quot;g-name&quot;&gt;&#123;&#123; goodsInfo.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;g-desc&quot;&gt;&#123;&#123; goodsInfo.desc &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;g-price&quot;&gt;</span><br><span class="line">                &lt;span&gt;&#123;&#123; goodsInfo.oldPrice &#125;&#125;&lt;/span&gt;</span><br><span class="line">                &lt;span&gt;&#123;&#123; goodsInfo.price &#125;&#125;&lt;/span&gt;</span><br><span class="line">              &lt;/p&gt;</span><br><span class="line">              &lt;div class=&quot;g-service&quot;&gt;</span><br><span class="line">                &lt;dl&gt;</span><br><span class="line">                  &lt;dt&gt;促销&lt;/dt&gt;</span><br><span class="line">                  &lt;dd&gt;12月好物放送，App领券购买直降120元&lt;/dd&gt;</span><br><span class="line">                &lt;/dl&gt;</span><br><span class="line">                &lt;dl&gt;</span><br><span class="line">                  &lt;dt&gt;服务&lt;/dt&gt;</span><br><span class="line">                  &lt;dd&gt;</span><br><span class="line">                    &lt;span&gt;无忧退货&lt;/span&gt;</span><br><span class="line">                    &lt;span&gt;快速退款&lt;/span&gt;</span><br><span class="line">                    &lt;span&gt;免费包邮&lt;/span&gt;</span><br><span class="line">                    &lt;a href=&quot;javascript:;&quot;&gt;了解详情&lt;/a&gt;</span><br><span class="line">                  &lt;/dd&gt;</span><br><span class="line">                &lt;/dl&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;!-- sku组件 --&gt;</span><br><span class="line">              &lt;GoodsSKU :goods=&quot;goodsInfo&quot; @change=&quot;change&quot; /&gt;</span><br><span class="line">              &lt;!-- 数据组件 --&gt;</span><br><span class="line">              &lt;el-input-number v-model=&quot;count&quot; @change=&quot;countChange&quot; /&gt;</span><br><span class="line">              &lt;!-- 按钮组件 --&gt;</span><br><span class="line">              &lt;div&gt;</span><br><span class="line">                &lt;el-button size=&quot;large&quot; class=&quot;btn&quot; @click=&quot;addtocart&quot;&gt;</span><br><span class="line">                  加入购物车</span><br><span class="line">                &lt;/el-button&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;goods-footer&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;goods-article&quot;&gt;</span><br><span class="line">              &lt;!-- 商品详情 --&gt;</span><br><span class="line">              &lt;div class=&quot;goods-tabs&quot;&gt;</span><br><span class="line">                &lt;nav&gt;</span><br><span class="line">                  &lt;a&gt;商品详情&lt;/a&gt;</span><br><span class="line">                &lt;/nav&gt;</span><br><span class="line">                &lt;div class=&quot;goods-detail&quot; v-if=&quot;goodsInfo.details&quot;&gt;</span><br><span class="line">                  &lt;!-- 属性 --&gt;</span><br><span class="line">                  &lt;ul class=&quot;attrs&quot;&gt;</span><br><span class="line">                    &lt;li</span><br><span class="line">                      v-for=&quot;item in goodsInfo.details.properties&quot;</span><br><span class="line">                      :key=&quot;item.value&quot;</span><br><span class="line">                    &gt;</span><br><span class="line">                      &lt;span class=&quot;dt&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">                      &lt;span class=&quot;dd&quot;&gt;&#123;&#123; item.value &#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;/li&gt;</span><br><span class="line">                  &lt;/ul&gt;</span><br><span class="line">                  &lt;!-- 图片 --&gt;</span><br><span class="line">                  &lt;img</span><br><span class="line">                    v-for=&quot;img in goodsInfo.details.pictures&quot;</span><br><span class="line">                    :src=&quot;img&quot;</span><br><span class="line">                    :key=&quot;img&quot;</span><br><span class="line">                    alt=&quot;&quot;</span><br><span class="line">                  /&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;!-- 24热榜+专题推荐 --&gt;</span><br><span class="line">            &lt;div class=&quot;goods-aside&quot;&gt;</span><br><span class="line">              &lt;GoodsHot :type=&quot;1&quot; /&gt;</span><br><span class="line">              &lt;GoodsHot :type=&quot;2&quot; /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.xtx-goods-page &#123;</span><br><span class="line">  .goods-info &#123;</span><br><span class="line">    min-height: 600px;</span><br><span class="line">    background: #fff;</span><br><span class="line">    display: flex;</span><br><span class="line"></span><br><span class="line">    .media &#123;</span><br><span class="line">      width: 580px;</span><br><span class="line">      height: 600px;</span><br><span class="line">      padding: 30px 50px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .spec &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      padding: 30px 30px 30px 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-footer &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line"></span><br><span class="line">    .goods-article &#123;</span><br><span class="line">      width: 940px;</span><br><span class="line">      margin-right: 20px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .goods-aside &#123;</span><br><span class="line">      width: 280px;</span><br><span class="line">      min-height: 1000px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-tabs &#123;</span><br><span class="line">    min-height: 600px;</span><br><span class="line">    background: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-warn &#123;</span><br><span class="line">    min-height: 600px;</span><br><span class="line">    background: #fff;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .number-box &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 60px;</span><br><span class="line">      color: #999;</span><br><span class="line">      padding-left: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .g-name &#123;</span><br><span class="line">    font-size: 22px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .g-desc &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .g-price &#123;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line"></span><br><span class="line">    span &#123;</span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        content: &quot;¥&quot;;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        color: $priceColor;</span><br><span class="line">        margin-right: 10px;</span><br><span class="line">        font-size: 22px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        color: #999;</span><br><span class="line">        text-decoration: line-through;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .g-service &#123;</span><br><span class="line">    background: #f5f5f5;</span><br><span class="line">    width: 500px;</span><br><span class="line">    padding: 20px 10px 0 10px;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line"></span><br><span class="line">    dl &#123;</span><br><span class="line">      padding-bottom: 20px;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line"></span><br><span class="line">      dt &#123;</span><br><span class="line">        width: 50px;</span><br><span class="line">        color: #999;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      dd &#123;</span><br><span class="line">        color: #666;</span><br><span class="line"></span><br><span class="line">        &amp;:last-child &#123;</span><br><span class="line">          span &#123;</span><br><span class="line">            margin-right: 10px;</span><br><span class="line"></span><br><span class="line">            &amp;::before &#123;</span><br><span class="line">              content: &quot;•&quot;;</span><br><span class="line">              color: $xtxColor;</span><br><span class="line">              margin-right: 2px;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          a &#123;</span><br><span class="line">            color: $xtxColor;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-sales &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    width: 400px;</span><br><span class="line">    align-items: center;</span><br><span class="line">    text-align: center;</span><br><span class="line">    height: 140px;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      position: relative;</span><br><span class="line"></span><br><span class="line">      ~ li::after &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: 10px;</span><br><span class="line">        left: 0;</span><br><span class="line">        height: 60px;</span><br><span class="line">        border-left: 1px solid #e4e4e4;</span><br><span class="line">        content: &quot;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      p &#123;</span><br><span class="line">        &amp;:first-child &#123;</span><br><span class="line">          color: #999;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;:nth-child(2) &#123;</span><br><span class="line">          color: $priceColor;</span><br><span class="line">          margin-top: 10px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;:last-child &#123;</span><br><span class="line">          color: #666;</span><br><span class="line">          margin-top: 10px;</span><br><span class="line"></span><br><span class="line">          i &#123;</span><br><span class="line">            color: $xtxColor;</span><br><span class="line">            font-size: 14px;</span><br><span class="line">            margin-right: 2px;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          &amp;:hover &#123;</span><br><span class="line">            color: $xtxColor;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.goods-tabs &#123;</span><br><span class="line">  min-height: 600px;</span><br><span class="line">  background: #fff;</span><br><span class="line"></span><br><span class="line">  nav &#123;</span><br><span class="line">    height: 70px;</span><br><span class="line">    line-height: 70px;</span><br><span class="line">    display: flex;</span><br><span class="line">    border-bottom: 1px solid #f5f5f5;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      padding: 0 40px;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      position: relative;</span><br><span class="line"></span><br><span class="line">      &gt; span &#123;</span><br><span class="line">        color: $priceColor;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        margin-left: 10px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.goods-detail &#123;</span><br><span class="line">  padding: 40px;</span><br><span class="line"></span><br><span class="line">  .attrs &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    margin-bottom: 30px;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      margin-bottom: 10px;</span><br><span class="line">      width: 50%;</span><br><span class="line"></span><br><span class="line">      .dt &#123;</span><br><span class="line">        width: 100px;</span><br><span class="line">        color: #999;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .dd &#123;</span><br><span class="line">        flex: 1;</span><br><span class="line">        color: #666;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &gt; img &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bread-container &#123;</span><br><span class="line">  padding: 25px 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>其中热榜组件 goodsHot</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; fetchHotGoodsAPI &#125; from &quot;@/apis/goodsInfo&quot;;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRoute &#125; from &quot;vue-router&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">const queryData = defineProps([&quot;type&quot;]);</span><br><span class="line">const hotGoods = ref([]);</span><br><span class="line">const getHotGoods = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await fetchHotGoodsAPI(&#123;</span><br><span class="line">    id: route.params.id,</span><br><span class="line">    type: queryData.type,</span><br><span class="line">  &#125;);</span><br><span class="line">  hotGoods.value = data.result;</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  getHotGoods();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;goods-hot&quot;&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; queryData.type === 1 ? &quot;24小时热销榜&quot; : &quot;周热销榜&quot; &#125;&#125;&lt;/h3&gt;</span><br><span class="line">    &lt;!-- 商品区块 --&gt;</span><br><span class="line">    &lt;RouterLink</span><br><span class="line">      :to=&quot;`/goodsInfo/$&#123;item.id&#125;`&quot;</span><br><span class="line">      class=&quot;goods-item&quot;</span><br><span class="line">      v-for=&quot;item in hotGoods&quot;</span><br><span class="line">      :key=&quot;item.id&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;img :src=&quot;item.picture&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">      &lt;p class=&quot;name ellipsis&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;p class=&quot;desc ellipsis&quot;&gt;&#123;&#123; item.desc &#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;p class=&quot;price&quot;&gt;&amp;yen;&#123;&#123; item.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/RouterLink&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.goods-hot &#123;</span><br><span class="line">  h3 &#123;</span><br><span class="line">    height: 70px;</span><br><span class="line">    background: $helpColor;</span><br><span class="line">    color: #fff;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    line-height: 70px;</span><br><span class="line">    padding-left: 25px;</span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-item &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    padding: 20px 30px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    background: #fff;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 160px;</span><br><span class="line">      height: 160px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      padding-top: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .desc &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">      height: 29px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .price &#123;</span><br><span class="line">      color: $priceColor;</span><br><span class="line">      font-size: 20px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>图片预览组件 goodsPreview</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, onMounted, watch, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useMouseInElement &#125; from &quot;@vueuse/core&quot;;</span><br><span class="line">// 图片列表</span><br><span class="line">defineProps(&#123;</span><br><span class="line">  mainPictures: &#123;</span><br><span class="line">    type: Array,</span><br><span class="line">    default: () =&gt; [],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">// 当前选中的图片索引</span><br><span class="line">const currentIndex = ref(0);</span><br><span class="line">// 获取鼠标相对位置</span><br><span class="line">const target = ref(null);</span><br><span class="line">const &#123; elementX, elementY, isOutside &#125; = useMouseInElement(target);</span><br><span class="line">const X = ref(0);</span><br><span class="line">const Y = ref(0);</span><br><span class="line">// 监听鼠标相对位置的变化</span><br><span class="line">watch([elementX, elementY, isOutside], () =&gt; &#123;</span><br><span class="line">  if (isOutside.value) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  if (elementX.value &gt; 100 &amp;&amp; elementX.value &lt; 300) &#123;</span><br><span class="line">    X.value = elementX.value - 100;</span><br><span class="line">  &#125; else if (elementX.value &lt;= 100) &#123;</span><br><span class="line">    X.value = 0;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    X.value = 200;</span><br><span class="line">  &#125;</span><br><span class="line">  if (elementY.value &gt; 100 &amp;&amp; elementY.value &lt; 300) &#123;</span><br><span class="line">    Y.value = elementY.value - 100;</span><br><span class="line">  &#125; else if (elementY.value &lt;= 100) &#123;</span><br><span class="line">    Y.value = 0;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    Y.value = 200;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">const positionX = computed(() =&gt; -X.value * 2);</span><br><span class="line">const positionY = computed(() =&gt; -Y.value * 2);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;goods-image&quot;&gt;</span><br><span class="line">    &lt;!-- 左侧大图--&gt;</span><br><span class="line">    &lt;div class=&quot;middle&quot; ref=&quot;target&quot;&gt;</span><br><span class="line">      &lt;img :src=&quot;mainPictures[currentIndex]&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">      &lt;!-- 蒙层小滑块 --&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;layer&quot;</span><br><span class="line">        v-show=&quot;!isOutside&quot;</span><br><span class="line">        :style=&quot;&#123; left: `$&#123;X&#125;px`, top: `$&#123;Y&#125;px` &#125;&quot;</span><br><span class="line">      &gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 小图列表 --&gt;</span><br><span class="line">    &lt;ul class=&quot;small&quot;&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for=&quot;(img, i) in mainPictures&quot;</span><br><span class="line">        :key=&quot;i&quot;</span><br><span class="line">        @mouseenter=&quot;currentIndex = i&quot;</span><br><span class="line">        :class=&quot;&#123; active: currentIndex === i &#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;img :src=&quot;img&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;!-- 放大镜大图 --&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;large&quot;</span><br><span class="line">      :style=&quot;[</span><br><span class="line">        &#123;</span><br><span class="line">          backgroundImage: `url($&#123;mainPictures[currentIndex]&#125;)`,</span><br><span class="line">          backgroundPositionX: `$&#123;positionX&#125;px`,</span><br><span class="line">          backgroundPositionY: `$&#123;positionY&#125;px`,</span><br><span class="line">        &#125;,</span><br><span class="line">      ]&quot;</span><br><span class="line">      v-show=&quot;!isOutside&quot;</span><br><span class="line">    &gt;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.goods-image &#123;</span><br><span class="line">  width: 480px;</span><br><span class="line">  height: 400px;</span><br><span class="line">  position: relative;</span><br><span class="line">  display: flex;</span><br><span class="line"></span><br><span class="line">  .middle &#123;</span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 400px;</span><br><span class="line">    background: #f5f5f5;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .large &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 412px;</span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 400px;</span><br><span class="line">    z-index: 500;</span><br><span class="line">    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    // 背景图:盒子的大小 = 2:1  将来控制背景图的移动来实现放大的效果查看 background-position</span><br><span class="line">    background-size: 800px 800px;</span><br><span class="line">    background-color: #f8f8f8;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .layer &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 200px;</span><br><span class="line">    background: rgba(0, 0, 0, 0.2);</span><br><span class="line">    // 绝对定位 然后跟随咱们鼠标控制left和top属性就可以让滑块移动起来</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    position: absolute;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .small &#123;</span><br><span class="line">    width: 80px;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      width: 68px;</span><br><span class="line">      height: 68px;</span><br><span class="line">      margin-left: 12px;</span><br><span class="line">      margin-bottom: 15px;</span><br><span class="line">      cursor: pointer;</span><br><span class="line"></span><br><span class="line">      &amp;:hover,</span><br><span class="line">      &amp;.active &#123;</span><br><span class="line">        border: 2px solid $xtxColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、图片预览组件"><a href="#2、图片预览组件" class="headerlink" title="2、图片预览组件"></a>2、图片预览组件</h3><p>功能拆解：</p>
<ol>
<li><p>通过小图切换大图显示</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605085705589.png" alt="image-20230605085705589"></p>
</li>
<li><p>放大镜效果</p>
</li>
</ol>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605085737400.png" alt="image-20230605085737400"></p>
<p>小图切换大图实现起来比较简单，主要是放大镜效果有点复杂，我们再对其进行进一步分解：</p>
<ol>
<li><p>左侧滑块跟随鼠标移动</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605090240710.png" alt="image-20230605090240710"></p>
</li>
<li><p>右侧大图放大效果实现</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605090400445.png" alt="image-20230605090400445"></p>
</li>
<li><p>鼠标移入控制滑块和大图显示隐藏</p>
</li>
</ol>
<h3 id="3、规格组件-SKU-SPU"><a href="#3、规格组件-SKU-SPU" class="headerlink" title="3、规格组件 SKU&amp;SPU"></a>3、规格组件 SKU&amp;SPU</h3><ul>
<li>SPU（Standard Product Unit）：标准化产品单元。是商品信息聚合的最小单位，是一组可复用、易检索的标准化信息的集合，该集合描述了一个产品的特性。通俗点讲，属性值、特性相同的商品就可以称为一个 SPU。</li>
<li>SKU（Stock Keeping Unit）库存量单位，即库存进出计量的单位， 可以是以件、盒、托盘等为单位。SKU 是物理上不可分割的最小存货单元。在使用时要根据不同业态，不同管理模式来处理</li>
</ul>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605090703869.png" alt="image-20230605090703869"></p>
<p>即，spu 代表一个商品，拥有很多相同的属性。sku 代表该商品可选规格的任意组合，他是库存单位的唯一标识。</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605090822108.png" alt="image-20230605090822108"></p>
<h2 id="八、登录页"><a href="#八、登录页" class="headerlink" title="八、登录页"></a>八、登录页</h2><h3 id="1、整体架构-2"><a href="#1、整体架构-2" class="headerlink" title="1、整体架构"></a>1、整体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ElMessage &#125; from &quot;element-plus&quot;;</span><br><span class="line">import &#123; ref, toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useUserInfoStore &#125; from &quot;@/stores/userInfo&quot;;</span><br><span class="line">const ruleFormRef = ref(null);</span><br><span class="line">const ruleForm = ref(&#123;</span><br><span class="line">  account: &quot;&quot;,</span><br><span class="line">  password: &quot;&quot;,</span><br><span class="line">  agreement: false,</span><br><span class="line">&#125;);</span><br><span class="line">// 单独校验是否同意条款</span><br><span class="line">const validateAgree = (rule, value, callback) =&gt; &#123;</span><br><span class="line">  if (value) &#123;</span><br><span class="line">    callback();</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    callback(new Error(&quot;请同意条款&quot;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">const rules = ref(&#123;</span><br><span class="line">  account: [&#123; required: true, message: &quot;请输入账户&quot;, trigger: &quot;blur&quot; &#125;],</span><br><span class="line">  password: [</span><br><span class="line">    &#123; required: true, message: &quot;请输入密码&quot;, trigger: &quot;blur&quot; &#125;,</span><br><span class="line">    &#123; min: 6, max: 16, message: &quot;长度在 6 到 16 个字符&quot;, trigger: &quot;blur&quot; &#125;,</span><br><span class="line">  ],</span><br><span class="line">  agreement: [&#123; validator: validateAgree, trigger: &quot;change&quot; &#125;],</span><br><span class="line">&#125;);</span><br><span class="line">// 登录按钮</span><br><span class="line">const loginBtn = () =&gt; &#123;</span><br><span class="line">  ruleFormRef.value.validate((valid) =&gt; &#123;</span><br><span class="line">    if (valid) &#123;</span><br><span class="line">      const &#123; getUserInfo &#125; = toRefs(useUserInfoStore());</span><br><span class="line">      getUserInfo.value(ruleForm.value);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      ElMessage.error(&quot;验证失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;header class=&quot;login-header&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container m-top-20&quot;&gt;</span><br><span class="line">        &lt;h1 class=&quot;logo&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/&quot;&gt;小兔鲜&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/h1&gt;</span><br><span class="line">        &lt;RouterLink class=&quot;entry&quot; to=&quot;/&quot;&gt;</span><br><span class="line">          进入网站首页</span><br><span class="line">          &lt;i class=&quot;iconfont icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class="line">          &lt;i class=&quot;iconfont icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;/RouterLink&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">    &lt;section class=&quot;login-section&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;wrapper&quot;&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;账户登录&lt;/a&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line">        &lt;div class=&quot;account-box&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;form&quot;&gt;</span><br><span class="line">            &lt;el-form</span><br><span class="line">              label-position=&quot;right&quot;</span><br><span class="line">              label-width=&quot;60px&quot;</span><br><span class="line">              status-icon</span><br><span class="line">              ref=&quot;ruleFormRef&quot;</span><br><span class="line">              :model=&quot;ruleForm&quot;</span><br><span class="line">              :rules=&quot;rules&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;el-form-item prop=&quot;account&quot; label=&quot;账户&quot;&gt;</span><br><span class="line">                &lt;el-input v-model=&quot;ruleForm.account&quot; /&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">              &lt;el-form-item prop=&quot;password&quot; label=&quot;密码&quot;&gt;</span><br><span class="line">                &lt;el-input</span><br><span class="line">                  type=&quot;password&quot;</span><br><span class="line">                  show-password</span><br><span class="line">                  v-model=&quot;ruleForm.password&quot;</span><br><span class="line">                /&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">              &lt;el-form-item label-width=&quot;22px&quot; prop=&quot;agreement&quot;&gt;</span><br><span class="line">                &lt;el-checkbox size=&quot;large&quot; v-model=&quot;ruleForm.agreement&quot;&gt;</span><br><span class="line">                  我已同意隐私条款和服务条款</span><br><span class="line">                &lt;/el-checkbox&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">              &lt;el-button size=&quot;large&quot; class=&quot;subBtn&quot; @click=&quot;loginBtn&quot;</span><br><span class="line">                &gt;点击登录&lt;/el-button</span><br><span class="line">              &gt;</span><br><span class="line">            &lt;/el-form&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line"></span><br><span class="line">    &lt;footer class=&quot;login-footer&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;关于我们&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;帮助中心&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;售后服务&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;配送与验收&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;商务合作&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;搜索推荐&lt;/a&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot;&gt;友情链接&lt;/a&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;CopyRight &amp;copy; 小兔鲜儿&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/footer&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.login-header &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">  border-bottom: 1px solid #e4e4e4;</span><br><span class="line"></span><br><span class="line">  .container &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: flex-end;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .logo &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      height: 132px;</span><br><span class="line">      width: 100%;</span><br><span class="line">      text-indent: -9999px;</span><br><span class="line">      background: url(&quot;@/assets/images/logo.png&quot;) no-repeat center 18px /</span><br><span class="line">        contain;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .sub &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    font-size: 24px;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    margin-bottom: 38px;</span><br><span class="line">    margin-left: 20px;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .entry &#123;</span><br><span class="line">    width: 120px;</span><br><span class="line">    margin-bottom: 38px;</span><br><span class="line">    font-size: 16px;</span><br><span class="line"></span><br><span class="line">    i &#123;</span><br><span class="line">      font-size: 14px;</span><br><span class="line">      color: $xtxColor;</span><br><span class="line">      letter-spacing: -5px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.login-section &#123;</span><br><span class="line">  background: url(&quot;@/assets/images/login-bg.png&quot;) no-repeat center / cover;</span><br><span class="line">  height: 488px;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .wrapper &#123;</span><br><span class="line">    width: 380px;</span><br><span class="line">    background: #fff;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 54px;</span><br><span class="line">    transform: translate3d(100px, 0, 0);</span><br><span class="line">    box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);</span><br><span class="line"></span><br><span class="line">    nav &#123;</span><br><span class="line">      font-size: 14px;</span><br><span class="line">      height: 55px;</span><br><span class="line">      margin-bottom: 20px;</span><br><span class="line">      border-bottom: 1px solid #f5f5f5;</span><br><span class="line">      display: flex;</span><br><span class="line">      padding: 0 40px;</span><br><span class="line">      text-align: right;</span><br><span class="line">      align-items: center;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        flex: 1;</span><br><span class="line">        line-height: 1;</span><br><span class="line">        display: inline-block;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">        position: relative;</span><br><span class="line">        text-align: center;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.login-footer &#123;</span><br><span class="line">  padding: 30px 0 50px;</span><br><span class="line">  background: #fff;</span><br><span class="line"></span><br><span class="line">  p &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    color: #999;</span><br><span class="line">    padding-top: 20px;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 10px;</span><br><span class="line">      color: #999;</span><br><span class="line">      display: inline-block;</span><br><span class="line"></span><br><span class="line">      ~ a &#123;</span><br><span class="line">        border-left: 1px solid #ccc;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.account-box &#123;</span><br><span class="line">  .toggle &#123;</span><br><span class="line">    padding: 15px 40px;</span><br><span class="line">    text-align: right;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      color: $xtxColor;</span><br><span class="line"></span><br><span class="line">      i &#123;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .form &#123;</span><br><span class="line">    padding: 0 20px 20px 20px;</span><br><span class="line"></span><br><span class="line">    &amp;-item &#123;</span><br><span class="line">      margin-bottom: 28px;</span><br><span class="line"></span><br><span class="line">      .input &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        height: 36px;</span><br><span class="line"></span><br><span class="line">        &gt; i &#123;</span><br><span class="line">          width: 34px;</span><br><span class="line">          height: 34px;</span><br><span class="line">          background: #cfcdcd;</span><br><span class="line">          color: #fff;</span><br><span class="line">          position: absolute;</span><br><span class="line">          left: 1px;</span><br><span class="line">          top: 1px;</span><br><span class="line">          text-align: center;</span><br><span class="line">          line-height: 34px;</span><br><span class="line">          font-size: 18px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input &#123;</span><br><span class="line">          padding-left: 44px;</span><br><span class="line">          border: 1px solid #cfcdcd;</span><br><span class="line">          height: 36px;</span><br><span class="line">          line-height: 36px;</span><br><span class="line">          width: 100%;</span><br><span class="line"></span><br><span class="line">          &amp;.error &#123;</span><br><span class="line">            border-color: $priceColor;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          &amp;.active,</span><br><span class="line">          &amp;:focus &#123;</span><br><span class="line">            border-color: $xtxColor;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .code &#123;</span><br><span class="line">          position: absolute;</span><br><span class="line">          right: 1px;</span><br><span class="line">          top: 1px;</span><br><span class="line">          text-align: center;</span><br><span class="line">          line-height: 34px;</span><br><span class="line">          font-size: 14px;</span><br><span class="line">          background: #f5f5f5;</span><br><span class="line">          color: #666;</span><br><span class="line">          width: 90px;</span><br><span class="line">          height: 34px;</span><br><span class="line">          cursor: pointer;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &gt; .error &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        line-height: 28px;</span><br><span class="line">        color: $priceColor;</span><br><span class="line"></span><br><span class="line">        i &#123;</span><br><span class="line">          font-size: 14px;</span><br><span class="line">          margin-right: 2px;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .agree &#123;</span><br><span class="line">      a &#123;</span><br><span class="line">        color: #069;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .btn &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 40px;</span><br><span class="line">      color: #fff;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 40px;</span><br><span class="line">      background: $xtxColor;</span><br><span class="line"></span><br><span class="line">      &amp;.disabled &#123;</span><br><span class="line">        background: #cfcdcd;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .action &#123;</span><br><span class="line">    padding: 20px 40px;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    .url &#123;</span><br><span class="line">      a &#123;</span><br><span class="line">        color: #999;</span><br><span class="line">        margin-left: 10px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.subBtn &#123;</span><br><span class="line">  background: $xtxColor;</span><br><span class="line">  width: 100%;</span><br><span class="line">  color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、pinia-管理用户数据"><a href="#2、pinia-管理用户数据" class="headerlink" title="2、pinia 管理用户数据"></a>2、pinia 管理用户数据</h3><p>stores 下新建 userInfo.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; loginAPI &#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router/index.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCartStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/cart&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; mergeCart &#125; = <span class="title function_">useCartStore</span>();</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserInfoStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&quot;userInfo&quot;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//用户数据</span></span><br><span class="line">    <span class="keyword">const</span> userInfo = <span class="title function_">ref</span>(&#123;&#125;);</span><br><span class="line">    <span class="comment">// 获取用户数据</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUserInfo</span>(<span class="params">Data</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> <span class="title function_">loginAPI</span>(<span class="title class_">Data</span>);</span><br><span class="line">        userInfo.<span class="property">value</span> = data.<span class="property">result</span>;</span><br><span class="line">        <span class="title function_">mergeCart</span>();</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">        router.<span class="title function_">replace</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 清除用户数据</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">clearUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">      userInfo.<span class="property">value</span> = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123; userInfo, getUserInfo, clearUserInfo &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="3、请求拦截器统一注入-token"><a href="#3、请求拦截器统一注入-token" class="headerlink" title="3、请求拦截器统一注入 token"></a>3、请求拦截器统一注入 token</h3><p>utils&#x2F;request.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useUserInfoStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/userInfo&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;http://pcapi-xiaotuxian-front-devtest.itheima.net/&quot;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>, <span class="comment">// 单位是毫秒</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 请求拦截器，统一注入token</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; userInfo &#125; = <span class="title function_">useUserInfoStore</span>();</span><br><span class="line">  <span class="keyword">if</span> (userInfo.<span class="property">token</span>) &#123;</span><br><span class="line">    config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;userInfo.token&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 响应拦截器,这里可以将axios默认添加的一层data剥离出来</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> response,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">response</span>.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;请先登录&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> request;</span><br></pre></td></tr></table></figure>

<h2 id="九、购物车"><a href="#九、购物车" class="headerlink" title="九、购物车"></a>九、购物车</h2><h3 id="1、整体架构-3"><a href="#1、整体架构-3" class="headerlink" title="1、整体架构"></a>1、整体架构</h3><p>头部购物车 HeadCart</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useCartStore &#125; from &quot;@/stores/cart&quot;;</span><br><span class="line">import &#123; toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">const &#123; cartList, total, totalPrice, removeCart &#125; = toRefs(useCartStore());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;cart&quot;&gt;</span><br><span class="line">    &lt;a class=&quot;curr&quot; href=&quot;javascript:;&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;iconfont icon-cart&quot;&gt;&lt;/i&gt;&lt;em&gt;&#123;&#123; cartList.length &#125;&#125;&lt;/em&gt;</span><br><span class="line">    &lt;/a&gt;</span><br><span class="line">    &lt;div class=&quot;layer&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;list&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;item&quot; v-for=&quot;i in cartList&quot; :key=&quot;i.id&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;&quot;&gt;</span><br><span class="line">            &lt;img :src=&quot;i.picture&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">            &lt;div class=&quot;center&quot;&gt;</span><br><span class="line">              &lt;p class=&quot;name ellipsis-2&quot;&gt;</span><br><span class="line">                &#123;&#123; i.name &#125;&#125;</span><br><span class="line">              &lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;attr ellipsis&quot;&gt;&#123;&#123; i.attrsText &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">              &lt;p class=&quot;price&quot;&gt;&amp;yen;&#123;&#123; i.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;p class=&quot;count&quot;&gt;x&#123;&#123; i.count &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/RouterLink&gt;</span><br><span class="line">          &lt;i class=&quot;iconfont icon-close-new&quot; @click=&quot;removeCart(i)&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;foot&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;total&quot;&gt;</span><br><span class="line">          &lt;p&gt;共 &#123;&#123; total &#125;&#125; 件商品&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;&amp;yen; &#123;&#123; totalPrice.toFixed(2) &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;el-button</span><br><span class="line">          size=&quot;large&quot;</span><br><span class="line">          type=&quot;primary&quot;</span><br><span class="line">          @click=&quot;$router.push(&#x27;/cartList&#x27;)&quot;</span><br><span class="line">          &gt;去购物车结算&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.cart &#123;</span><br><span class="line">  width: 50px;</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 600;</span><br><span class="line"></span><br><span class="line">  .curr &#123;</span><br><span class="line">    height: 32px;</span><br><span class="line">    line-height: 32px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    position: relative;</span><br><span class="line">    display: block;</span><br><span class="line"></span><br><span class="line">    .icon-cart &#123;</span><br><span class="line">      font-size: 22px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    em &#123;</span><br><span class="line">      font-style: normal;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 0;</span><br><span class="line">      top: 0;</span><br><span class="line">      padding: 1px 6px;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      background: $helpColor;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">      border-radius: 10px;</span><br><span class="line">      font-family: Arial;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    .layer &#123;</span><br><span class="line">      opacity: 1;</span><br><span class="line">      transform: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .layer &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    transition: all 0.4s 0.2s;</span><br><span class="line">    transform: translateY(-200px) scale(1, 0);</span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 400px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50px;</span><br><span class="line">    right: 0;</span><br><span class="line">    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);</span><br><span class="line">    background: #fff;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    padding-top: 10px;</span><br><span class="line"></span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      content: &quot;&quot;;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 14px;</span><br><span class="line">      top: -10px;</span><br><span class="line">      width: 20px;</span><br><span class="line">      height: 20px;</span><br><span class="line">      background: #fff;</span><br><span class="line">      transform: scale(0.6, 1) rotate(45deg);</span><br><span class="line">      box-shadow: -3px -3px 5px rgba(0, 0, 0, 0.1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .foot &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      left: 0;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      height: 70px;</span><br><span class="line">      width: 100%;</span><br><span class="line">      padding: 10px;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: space-between;</span><br><span class="line">      background: #f8f8f8;</span><br><span class="line">      align-items: center;</span><br><span class="line"></span><br><span class="line">      .total &#123;</span><br><span class="line">        padding-left: 10px;</span><br><span class="line">        color: #999;</span><br><span class="line"></span><br><span class="line">        p &#123;</span><br><span class="line">          &amp;:last-child &#123;</span><br><span class="line">            font-size: 18px;</span><br><span class="line">            color: $priceColor;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .list &#123;</span><br><span class="line">    height: 310px;</span><br><span class="line">    overflow: auto;</span><br><span class="line">    padding: 0 10px;</span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar &#123;</span><br><span class="line">      width: 10px;</span><br><span class="line">      height: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar-track &#123;</span><br><span class="line">      background: #f8f8f8;</span><br><span class="line">      border-radius: 2px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar-thumb &#123;</span><br><span class="line">      background: #eee;</span><br><span class="line">      border-radius: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">      background: #ccc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .item &#123;</span><br><span class="line">      border-bottom: 1px solid #f5f5f5;</span><br><span class="line">      padding: 10px 0;</span><br><span class="line">      position: relative;</span><br><span class="line"></span><br><span class="line">      i &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        bottom: 38px;</span><br><span class="line">        right: 0;</span><br><span class="line">        opacity: 0;</span><br><span class="line">        color: #666;</span><br><span class="line">        transition: all 0.5s;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:hover &#123;</span><br><span class="line">        i &#123;</span><br><span class="line">          opacity: 1;</span><br><span class="line">          cursor: pointer;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line"></span><br><span class="line">        img &#123;</span><br><span class="line">          height: 80px;</span><br><span class="line">          width: 80px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .center &#123;</span><br><span class="line">          padding: 0 10px;</span><br><span class="line">          width: 200px;</span><br><span class="line"></span><br><span class="line">          .name &#123;</span><br><span class="line">            font-size: 16px;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          .attr &#123;</span><br><span class="line">            color: #999;</span><br><span class="line">            padding-top: 5px;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .right &#123;</span><br><span class="line">          width: 100px;</span><br><span class="line">          padding-right: 20px;</span><br><span class="line">          text-align: center;</span><br><span class="line"></span><br><span class="line">          .price &#123;</span><br><span class="line">            font-size: 16px;</span><br><span class="line">            color: $priceColor;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          .count &#123;</span><br><span class="line">            color: #999;</span><br><span class="line">            margin-top: 5px;</span><br><span class="line">            font-size: 16px;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>列表购物车 cartList</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useCartStore &#125; from &quot;@/stores/cart&quot;;</span><br><span class="line">import &#123; toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">// 注意这里因为有点击选择框导致选择框状态的改变，选择框状态的改变需要同步到pinia中，解构会使响应式数据丢失响应性，所以这里使用toRefs解构</span><br><span class="line">const &#123;</span><br><span class="line">  cartList,</span><br><span class="line">  total,</span><br><span class="line">  removeCart,</span><br><span class="line">  isCheckAll,</span><br><span class="line">  selectedCount,</span><br><span class="line">  selectedTotalPrice,</span><br><span class="line">&#125; = toRefs(useCartStore());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;xtx-cart-page&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container m-top-20&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;cart&quot;&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">          &lt;thead&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th width=&quot;120&quot;&gt;</span><br><span class="line">                &lt;el-checkbox v-model=&quot;isCheckAll&quot; /&gt;</span><br><span class="line">              &lt;/th&gt;</span><br><span class="line">              &lt;th width=&quot;400&quot;&gt;商品信息&lt;/th&gt;</span><br><span class="line">              &lt;th width=&quot;220&quot;&gt;单价&lt;/th&gt;</span><br><span class="line">              &lt;th width=&quot;180&quot;&gt;数量&lt;/th&gt;</span><br><span class="line">              &lt;th width=&quot;180&quot;&gt;小计&lt;/th&gt;</span><br><span class="line">              &lt;th width=&quot;140&quot;&gt;操作&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/thead&gt;</span><br><span class="line">          &lt;!-- 商品列表 --&gt;</span><br><span class="line">          &lt;tbody&gt;</span><br><span class="line">            &lt;tr v-for=&quot;i in cartList&quot; :key=&quot;i.id&quot;&gt;</span><br><span class="line">              &lt;td&gt;</span><br><span class="line">                &lt;el-checkbox v-model=&quot;i.selected&quot; /&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">              &lt;td&gt;</span><br><span class="line">                &lt;div class=&quot;goods&quot;&gt;</span><br><span class="line">                  &lt;RouterLink to=&quot;/&quot;</span><br><span class="line">                    &gt;&lt;img :src=&quot;i.picture&quot; alt=&quot;&quot;</span><br><span class="line">                  /&gt;&lt;/RouterLink&gt;</span><br><span class="line">                  &lt;div&gt;</span><br><span class="line">                    &lt;p class=&quot;name ellipsis&quot;&gt;</span><br><span class="line">                      &#123;&#123; i.name &#125;&#125;</span><br><span class="line">                    &lt;/p&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">              &lt;td class=&quot;tc&quot;&gt;</span><br><span class="line">                &lt;p&gt;&amp;yen;&#123;&#123; i.price &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">              &lt;td class=&quot;tc&quot;&gt;</span><br><span class="line">                &lt;el-input-number v-model=&quot;i.count&quot; /&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">              &lt;td class=&quot;tc&quot;&gt;</span><br><span class="line">                &lt;p class=&quot;f16 red&quot;&gt;&amp;yen;&#123;&#123; (i.price * i.count).toFixed(2) &#125;&#125;&lt;/p&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">              &lt;td class=&quot;tc&quot;&gt;</span><br><span class="line">                &lt;p&gt;</span><br><span class="line">                  &lt;el-popconfirm</span><br><span class="line">                    title=&quot;确认删除吗?&quot;</span><br><span class="line">                    confirm-button-text=&quot;确认&quot;</span><br><span class="line">                    cancel-button-text=&quot;取消&quot;</span><br><span class="line">                    @confirm=&quot;removeCart(i)&quot;</span><br><span class="line">                  &gt;</span><br><span class="line">                    &lt;template #reference&gt;</span><br><span class="line">                      &lt;a href=&quot;javascript:;&quot;&gt;删除&lt;/a&gt;</span><br><span class="line">                    &lt;/template&gt;</span><br><span class="line">                  &lt;/el-popconfirm&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr v-if=&quot;cartList.length === 0&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;cart-none&quot;&gt;</span><br><span class="line">                  &lt;el-empty description=&quot;购物车列表为空&quot;&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;随便逛逛&lt;/el-button&gt;</span><br><span class="line">                  &lt;/el-empty&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 操作栏 --&gt;</span><br><span class="line">      &lt;div class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;batch&quot;&gt;</span><br><span class="line">          共 &#123;&#123; total &#125;&#125; 件商品，已选择 &#123;&#123; selectedCount &#125;&#125; 件，商品合计：</span><br><span class="line">          &lt;span class=&quot;red&quot;&gt;¥ &#123;&#123; selectedTotalPrice.toFixed(2) &#125;&#125; &lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;total&quot;&gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            size=&quot;large&quot;</span><br><span class="line">            type=&quot;primary&quot;</span><br><span class="line">            @click=&quot;$router.push(&#x27;/orders&#x27;)&quot;</span><br><span class="line">            &gt;下单结算&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.xtx-cart-page &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line"></span><br><span class="line">  .cart &#123;</span><br><span class="line">    background: #fff;</span><br><span class="line">    color: #666;</span><br><span class="line"></span><br><span class="line">    table &#123;</span><br><span class="line">      border-spacing: 0;</span><br><span class="line">      border-collapse: collapse;</span><br><span class="line">      line-height: 24px;</span><br><span class="line"></span><br><span class="line">      th,</span><br><span class="line">      td &#123;</span><br><span class="line">        padding: 10px;</span><br><span class="line">        border-bottom: 1px solid #f5f5f5;</span><br><span class="line"></span><br><span class="line">        &amp;:first-child &#123;</span><br><span class="line">          text-align: left;</span><br><span class="line">          padding-left: 30px;</span><br><span class="line">          color: #999;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      th &#123;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        font-weight: normal;</span><br><span class="line">        line-height: 50px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cart-none &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    padding: 120px 0;</span><br><span class="line">    background: #fff;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">      padding: 20px 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tc &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      color: $xtxColor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .xtx-numbox &#123;</span><br><span class="line">      margin: 0 auto;</span><br><span class="line">      width: 120px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .red &#123;</span><br><span class="line">    color: $priceColor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .green &#123;</span><br><span class="line">    color: $xtxColor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .f16 &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 100px;</span><br><span class="line">      height: 100px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; div &#123;</span><br><span class="line">      width: 280px;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      padding-left: 10px;</span><br><span class="line"></span><br><span class="line">      .attr &#123;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">        color: #999;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .action &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    background: #fff;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">    height: 80px;</span><br><span class="line">    align-items: center;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 0 30px;</span><br><span class="line"></span><br><span class="line">    .xtx-checkbox &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .batch &#123;</span><br><span class="line">      a &#123;</span><br><span class="line">        margin-left: 20px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .red &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      margin-right: 20px;</span><br><span class="line">      font-weight: bold;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tit &#123;</span><br><span class="line">    color: #666;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong><em>接下来需要分两条路：一是未登录状态下操作购物车存储到本地，二是登录状态下操作购物车存储到数据库（调用接口）</em></strong></p>
<h3 id="2、pinia-管理购物车数据"><a href="#2、pinia-管理购物车数据" class="headerlink" title="2、pinia 管理购物车数据"></a>2、pinia 管理购物车数据</h3><p>由于购物车数据多个模块都需要用到，因此在 stores 新建 cart.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; insertCartAPI, delCartAPI, getCartListAPI &#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/cartList.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mergeCartAPI &#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/login.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useUserInfoStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/userInfo.js&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCartStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&quot;useCartStore&quot;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//购物车列表</span></span><br><span class="line">    <span class="keyword">const</span> cartList = <span class="title function_">ref</span>([]);</span><br><span class="line">    <span class="comment">//商品总数量</span></span><br><span class="line">    <span class="keyword">const</span> total = <span class="title function_">computed</span>(<span class="function">() =&gt;</span></span><br><span class="line">      cartList.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">count</span>, <span class="number">0</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//商品总价格</span></span><br><span class="line">    <span class="keyword">const</span> totalPrice = <span class="title function_">computed</span>(<span class="function">() =&gt;</span></span><br><span class="line">      cartList.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">count</span> * item.<span class="property">price</span>, <span class="number">0</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//已选件数</span></span><br><span class="line">    <span class="keyword">const</span> selectedCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> selectedGoods = cartList.<span class="property">value</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">selected</span>);</span><br><span class="line">      <span class="keyword">return</span> selectedGoods.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">count</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 已选商品总价</span></span><br><span class="line">    <span class="keyword">const</span> selectedTotalPrice = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> selectedGoods = cartList.<span class="property">value</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">selected</span>);</span><br><span class="line">      <span class="keyword">return</span> selectedGoods.<span class="title function_">reduce</span>(</span><br><span class="line">        <span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">count</span> * item.<span class="property">price</span>,</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 全选状态</span></span><br><span class="line">    <span class="keyword">const</span> isCheckAll = <span class="title function_">computed</span>(&#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> cartList.<span class="property">value</span>.<span class="title function_">every</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">selected</span> === <span class="literal">true</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">val</span>) &#123;</span><br><span class="line">        cartList.<span class="property">value</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> (item.<span class="property">selected</span> = val));</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 获取购物车列表</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getCartList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> <span class="title function_">getCartListAPI</span>();</span><br><span class="line">      cartList.<span class="property">value</span> = data.<span class="property">result</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 添加购物车</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">addCart</span> = <span class="keyword">async</span> (<span class="params">goods</span>) =&gt; &#123;</span><br><span class="line">      <span class="comment">//如果用户已登录，则调用接口，否则走本地购物车流程</span></span><br><span class="line">      <span class="keyword">const</span> &#123; userInfo &#125; = <span class="title function_">useUserInfoStore</span>();</span><br><span class="line">      <span class="keyword">if</span> (userInfo.<span class="property">token</span>) &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">insertCartAPI</span>(&#123;</span><br><span class="line">          <span class="attr">skuId</span>: goods.<span class="property">skuId</span>,</span><br><span class="line">          <span class="attr">count</span>: goods.<span class="property">count</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 调用添加接口后，重新获取购物车列表以覆盖本地购物车</span></span><br><span class="line">        <span class="title function_">getCartList</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//如果购物车中有该商品，数量加1，否则添加该商品</span></span><br><span class="line">        <span class="keyword">const</span> index = cartList.<span class="property">value</span>.<span class="title function_">findIndex</span>(</span><br><span class="line">          <span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">skuId</span> === goods.<span class="property">skuId</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (index === -<span class="number">1</span>) &#123;</span><br><span class="line">          cartList.<span class="property">value</span>.<span class="title function_">push</span>(goods);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          cartList.<span class="property">value</span>[index].<span class="property">count</span>++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//删除购物车的数据</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">removeCart</span> = (<span class="params">goods</span>) =&gt; &#123;</span><br><span class="line">      <span class="comment">//如果用户已登录，则调用接口，否则走本地购物车流程</span></span><br><span class="line">      <span class="keyword">const</span> &#123; userInfo &#125; = <span class="title function_">useUserInfoStore</span>();</span><br><span class="line">      <span class="keyword">if</span> (userInfo.<span class="property">token</span>) &#123;</span><br><span class="line">        <span class="title function_">delCartAPI</span>([goods.<span class="property">skuId</span>]);</span><br><span class="line">        <span class="comment">// 调用删除接口后，重新获取购物车列表以覆盖本地购物车</span></span><br><span class="line">        <span class="title function_">getCartList</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> index = cartList.<span class="property">value</span>.<span class="title function_">findIndex</span>(</span><br><span class="line">          <span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">skuId</span> === goods.<span class="property">skuId</span></span><br><span class="line">        );</span><br><span class="line">        cartList.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 合并购物车</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">mergeCart</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">mergeCartAPI</span>(cartList.<span class="property">value</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      cartList,</span><br><span class="line">      total,</span><br><span class="line">      totalPrice,</span><br><span class="line">      addCart,</span><br><span class="line">      removeCart,</span><br><span class="line">      isCheckAll,</span><br><span class="line">      selectedCount,</span><br><span class="line">      selectedTotalPrice,</span><br><span class="line">      getCartList,</span><br><span class="line">      mergeCart,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong><em>注意，这里有一个合并购物车的方法，主要是为了将用户未登录时的购物车操作在登录时合并到服务器</em></strong></p>
<h2 id="十、订单页"><a href="#十、订单页" class="headerlink" title="十、订单页"></a>十、订单页</h2><h3 id="1、整体架构-4"><a href="#1、整体架构-4" class="headerlink" title="1、整体架构"></a>1、整体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useRouter &#125; from &quot;vue-router&quot;;</span><br><span class="line">import &#123; ref, onMounted, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123;</span><br><span class="line">  getCheckoutInfoAPI,</span><br><span class="line">  addAddressAPI,</span><br><span class="line">  getAddressAPI,</span><br><span class="line">  deleteAddressAPI,</span><br><span class="line">  submitOrderAPI,</span><br><span class="line">&#125; from &quot;@/apis/orders&quot;;</span><br><span class="line">import &#123; regionData, codeToText &#125; from &quot;element-china-area-data&quot;;</span><br><span class="line">import &#123; ElMessage &#125; from &quot;element-plus&quot;;</span><br><span class="line">import &#123; useCartStore &#125; from &quot;@/stores/cart&quot;;</span><br><span class="line">const checkInfo = ref(&#123;&#125;); // 订单对象</span><br><span class="line">const curAddress = ref(&#123;&#125;); // 地址对象</span><br><span class="line">const newAddressList = ref([]); // 地址列表</span><br><span class="line">getCheckoutInfoAPI().then((res) =&gt; &#123;</span><br><span class="line">  checkInfo.value = res.data.result;</span><br><span class="line">&#125;);</span><br><span class="line">const getAddress = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getAddressAPI();</span><br><span class="line">  curAddress.value = data.result.find((item) =&gt; item.isDefault === 0);</span><br><span class="line">  newAddressList.value = data.result.map((ele) =&gt; &#123;</span><br><span class="line">    ele.isSelected = false;</span><br><span class="line">    return ele;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; getAddress());</span><br><span class="line">// 控制切换地址弹窗显示隐藏</span><br><span class="line">const dialogVisible = ref(false);</span><br><span class="line">const toggle = () =&gt; &#123;</span><br><span class="line">  dialogVisible.value = true;</span><br><span class="line">  getAddress();</span><br><span class="line">&#125;;</span><br><span class="line">// 存放临时地址</span><br><span class="line">const tempAddress = ref(&#123;&#125;);</span><br><span class="line">// 选中地址时高亮效果</span><br><span class="line">const confirmAddrsss = (item) =&gt; &#123;</span><br><span class="line">  newAddressList.value</span><br><span class="line">    .filter((element) =&gt; element.id != item.id)</span><br><span class="line">    .forEach((element) =&gt; (element.isSelected = false));</span><br><span class="line">  item.isSelected = !item.isSelected;</span><br><span class="line">  if (item.isSelected) &#123;</span><br><span class="line">    tempAddress.value = item;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">// 确定切换地址</span><br><span class="line">const toggleAddress = () =&gt; &#123;</span><br><span class="line">  if (tempAddress.value.id) &#123;</span><br><span class="line">    curAddress.value = tempAddress.value;</span><br><span class="line">    tempAddress.value = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  dialogVisible.value = false;</span><br><span class="line">&#125;;</span><br><span class="line">// 删除地址</span><br><span class="line">const removeAddress = async (item) =&gt; &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    await deleteAddressAPI(item.id);</span><br><span class="line">    ElMessage.success(&quot;删除成功&quot;);</span><br><span class="line">    getAddress();</span><br><span class="line">  &#125; catch &#123;</span><br><span class="line">    ElMessage.error(&quot;删除失败&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">// 添加地址</span><br><span class="line">// 添加地址显示隐藏</span><br><span class="line">const addDialogVisible = ref(false);</span><br><span class="line">// 表单数据</span><br><span class="line">const formData = ref(&#123;</span><br><span class="line">  receiver: &quot;&quot;,</span><br><span class="line">  contact: &quot;&quot;,</span><br><span class="line">  region: [],</span><br><span class="line">  address: &quot;&quot;,</span><br><span class="line">  postalCode: &quot;&quot;,</span><br><span class="line">  addressTags: &quot;&quot;,</span><br><span class="line">  isDefault: 1,</span><br><span class="line">&#125;);</span><br><span class="line">// 取消按钮</span><br><span class="line">const cancel = () =&gt; &#123;</span><br><span class="line">  addDialogVisible.value = false;</span><br><span class="line">  formData.value = &#123;</span><br><span class="line">    receiver: &quot;&quot;,</span><br><span class="line">    contact: &quot;&quot;,</span><br><span class="line">    region: [],</span><br><span class="line">    address: &quot;&quot;,</span><br><span class="line">    postalCode: &quot;&quot;,</span><br><span class="line">    addressTags: &quot;&quot;,</span><br><span class="line">    isDefault: 1,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">// 确认按钮</span><br><span class="line">const confirm = async () =&gt; &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    await addAddressAPI(&#123;</span><br><span class="line">      ...formData.value,</span><br><span class="line">      provinceCode: formData.value.region[0],</span><br><span class="line">      cityCode: formData.value.region[1],</span><br><span class="line">      countyCode: formData.value.region[2],</span><br><span class="line">      fullLocation:</span><br><span class="line">        codeToText[formData.value.region[0]] +</span><br><span class="line">        codeToText[formData.value.region[1]] +</span><br><span class="line">        codeToText[formData.value.region[2]] +</span><br><span class="line">        formData.value.address,</span><br><span class="line">    &#125;);</span><br><span class="line">    ElMessage.success(&quot;添加成功&quot;);</span><br><span class="line">  &#125; catch &#123;</span><br><span class="line">    ElMessage.error(&quot;添加失败&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  cancel();</span><br><span class="line">&#125;;</span><br><span class="line">// 提交订单</span><br><span class="line">// 订单数据</span><br><span class="line">const orderData = ref(&#123;</span><br><span class="line">  deliveryTimeType: 1,</span><br><span class="line">  payType: 1,</span><br><span class="line">  payChannel: 1,</span><br><span class="line">  buyerMessage: &quot;&quot;,</span><br><span class="line">  goods: computed(() =&gt; checkInfo.value.goods),</span><br><span class="line">  addressId: computed(() =&gt; curAddress.value.id),</span><br><span class="line">&#125;);</span><br><span class="line">const router = useRouter();</span><br><span class="line">const submitOrders = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await submitOrderAPI(orderData.value);</span><br><span class="line">  // 更新购物车数据</span><br><span class="line">  const &#123; removeCart &#125; = useCartStore();</span><br><span class="line">  removeCart(orderData.value);</span><br><span class="line">  router.push(`/payPage/$&#123;data.result.id&#125;`);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;xtx-pay-checkout-page&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;wrapper&quot;&gt;</span><br><span class="line">        &lt;!-- 收货地址 --&gt;</span><br><span class="line">        &lt;h3 class=&quot;box-title&quot;&gt;收货地址&lt;/h3&gt;</span><br><span class="line">        &lt;div class=&quot;box-body&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;address&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;text&quot;&gt;</span><br><span class="line">              &lt;div class=&quot;none&quot; v-if=&quot;!curAddress&quot;&gt;</span><br><span class="line">                您需要先添加收货地址才可提交订单。</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;ul v-else&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;span&gt;收&lt;i /&gt;货&lt;i /&gt;人：&lt;/span&gt;&#123;&#123; curAddress.receiver &#125;&#125;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li&gt;&lt;span&gt;联系方式：&lt;/span&gt;&#123;&#123; curAddress.contact &#125;&#125;&lt;/li&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;span&gt;收货地址：&lt;/span&gt;&#123;&#123; curAddress.fullLocation &#125;&#125;</span><br><span class="line">                  &#123;&#123; curAddress.address &#125;&#125;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;action&quot;&gt;</span><br><span class="line">              &lt;el-button size=&quot;large&quot; @click=&quot;toggle&quot;&gt;切换地址&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button size=&quot;large&quot; @click=&quot;addDialogVisible = true&quot;</span><br><span class="line">                &gt;添加地址&lt;/el-button</span><br><span class="line">              &gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 商品信息 --&gt;</span><br><span class="line">        &lt;h3 class=&quot;box-title&quot;&gt;商品信息&lt;/h3&gt;</span><br><span class="line">        &lt;div class=&quot;box-body&quot;&gt;</span><br><span class="line">          &lt;table class=&quot;goods&quot;&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">              &lt;tr&gt;</span><br><span class="line">                &lt;th width=&quot;520&quot;&gt;商品信息&lt;/th&gt;</span><br><span class="line">                &lt;th width=&quot;170&quot;&gt;单价&lt;/th&gt;</span><br><span class="line">                &lt;th width=&quot;170&quot;&gt;数量&lt;/th&gt;</span><br><span class="line">                &lt;th width=&quot;170&quot;&gt;小计&lt;/th&gt;</span><br><span class="line">                &lt;th width=&quot;170&quot;&gt;实付&lt;/th&gt;</span><br><span class="line">              &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">              &lt;tr v-for=&quot;i in checkInfo.goods&quot; :key=&quot;i.id&quot;&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot; class=&quot;info&quot;&gt;</span><br><span class="line">                    &lt;img :src=&quot;i.picture&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">                    &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">                      &lt;p&gt;&#123;&#123; i.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                      &lt;p&gt;&#123;&#123; i.attrsText &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&amp;yen;&#123;&#123; i.price &#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123; i.count &#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&amp;yen;&#123;&#123; i.totalPrice &#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&amp;yen;&#123;&#123; i.totalPayPrice &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;/tr&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">          &lt;/table&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 配送时间 --&gt;</span><br><span class="line">        &lt;h3 class=&quot;box-title&quot;&gt;配送时间&lt;/h3&gt;</span><br><span class="line">        &lt;div class=&quot;box-body&quot;&gt;</span><br><span class="line">          &lt;a class=&quot;my-btn active&quot; href=&quot;javascript:;&quot;</span><br><span class="line">            &gt;不限送货时间：周一至周日&lt;/a</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;a class=&quot;my-btn&quot; href=&quot;javascript:;&quot;&gt;工作日送货：周一至周五&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;my-btn&quot; href=&quot;javascript:;&quot;&gt;双休日、假日送货：周六至周日&lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 支付方式 --&gt;</span><br><span class="line">        &lt;h3 class=&quot;box-title&quot;&gt;支付方式&lt;/h3&gt;</span><br><span class="line">        &lt;div class=&quot;box-body&quot;&gt;</span><br><span class="line">          &lt;a class=&quot;my-btn active&quot; href=&quot;javascript:;&quot;&gt;在线支付&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;my-btn&quot; href=&quot;javascript:;&quot;&gt;货到付款&lt;/a&gt;</span><br><span class="line">          &lt;span style=&quot;color: #999&quot;&gt;货到付款需付5元手续费&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 金额明细 --&gt;</span><br><span class="line">        &lt;h3 class=&quot;box-title&quot;&gt;金额明细&lt;/h3&gt;</span><br><span class="line">        &lt;div class=&quot;box-body&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;total&quot;&gt;</span><br><span class="line">            &lt;dl&gt;</span><br><span class="line">              &lt;dt&gt;商品件数：&lt;/dt&gt;</span><br><span class="line">              &lt;dd&gt;&#123;&#123; checkInfo.summary?.goodsCount &#125;&#125;件&lt;/dd&gt;</span><br><span class="line">            &lt;/dl&gt;</span><br><span class="line">            &lt;dl&gt;</span><br><span class="line">              &lt;dt&gt;商品总价：&lt;/dt&gt;</span><br><span class="line">              &lt;dd&gt;¥&#123;&#123; checkInfo.summary?.totalPrice.toFixed(2) &#125;&#125;&lt;/dd&gt;</span><br><span class="line">            &lt;/dl&gt;</span><br><span class="line">            &lt;dl&gt;</span><br><span class="line">              &lt;dt&gt;运&lt;i&gt;&lt;/i&gt;费：&lt;/dt&gt;</span><br><span class="line">              &lt;dd&gt;¥&#123;&#123; checkInfo.summary?.postFee.toFixed(2) &#125;&#125;&lt;/dd&gt;</span><br><span class="line">            &lt;/dl&gt;</span><br><span class="line">            &lt;dl&gt;</span><br><span class="line">              &lt;dt&gt;应付总额：&lt;/dt&gt;</span><br><span class="line">              &lt;dd class=&quot;price&quot;&gt;</span><br><span class="line">                &#123;&#123; checkInfo.summary?.totalPayPrice.toFixed(2) &#125;&#125;</span><br><span class="line">              &lt;/dd&gt;</span><br><span class="line">            &lt;/dl&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 提交订单 --&gt;</span><br><span class="line">        &lt;div class=&quot;submit&quot;&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; size=&quot;large&quot; @click=&quot;submitOrders&quot;</span><br><span class="line">            &gt;提交订单&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- 切换地址 --&gt;</span><br><span class="line">  &lt;el-dialog title=&quot;切换收货地址&quot; width=&quot;30%&quot; center v-model=&quot;dialogVisible&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;addressWrapper&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;text item&quot;</span><br><span class="line">        v-for=&quot;item in newAddressList&quot;</span><br><span class="line">        :key=&quot;item.id&quot;</span><br><span class="line">        @click=&quot;confirmAddrsss(item)&quot;</span><br><span class="line">        :class=&quot;&#123; active: item.isSelected &#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;span&gt;收&lt;i /&gt;货&lt;i /&gt;人：&lt;/span&gt;&#123;&#123; item.receiver &#125;&#125;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;span&gt;联系方式：&lt;/span&gt;&#123;&#123; item.contact &#125;&#125;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;span&gt;收货地址：&lt;/span&gt;&#123;&#123; item.fullLocation + item.address &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">        &lt;i</span><br><span class="line">          class=&quot;iconfont icon-close-new close&quot;</span><br><span class="line">          @click=&quot;removeAddress(item)&quot;</span><br><span class="line">        &gt;&lt;/i&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">      &lt;span class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;取消&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;toggleAddress&quot;&gt;确定&lt;/el-button&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-dialog&gt;</span><br><span class="line">  &lt;!-- 添加地址 --&gt;</span><br><span class="line">  &lt;el-dialog title=&quot;添加收货地址&quot; width=&quot;30%&quot; center v-model=&quot;addDialogVisible&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;addressWrapper&quot;&gt;</span><br><span class="line">      &lt;el-form label-width=&quot;100px&quot; :model=&quot;formData&quot; style=&quot;max-width: 460px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;收货人&quot; required&gt;</span><br><span class="line">          &lt;el-input placeholder=&quot;请输入收货人&quot; v-model=&quot;formData.receiver&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;手机号&quot; required&gt;</span><br><span class="line">          &lt;el-input placeholder=&quot;请输入手机号&quot; v-model=&quot;formData.contact&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;地区&quot; required&gt;</span><br><span class="line">          &lt;el-cascader</span><br><span class="line">            placeholder=&quot;请选择所在地区&quot;</span><br><span class="line">            v-model=&quot;formData.region&quot;</span><br><span class="line">            :options=&quot;regionData&quot;</span><br><span class="line">            @change=&quot;handleChange&quot;</span><br><span class="line">            required</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;详细地址&quot; required&gt;</span><br><span class="line">          &lt;el-input placeholder=&quot;请输入详细地址&quot; v-model=&quot;formData.address&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;邮政编码&quot; required&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            placeholder=&quot;请输入邮政编码&quot;</span><br><span class="line">            v-model=&quot;formData.postalCode&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;地址标签&quot; required&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            placeholder=&quot;请输入地址标签&quot;</span><br><span class="line">            v-model=&quot;formData.addressTags&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;设为默认地址&quot; required&gt;</span><br><span class="line">          &lt;el-switch</span><br><span class="line">            v-model=&quot;formData.isDefault&quot;</span><br><span class="line">            :active-value=&quot;0&quot;</span><br><span class="line">            :inactive-value=&quot;1&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">      &lt;span class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;cancel&quot;&gt;取消&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;confirm&quot;&gt;确定&lt;/el-button&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-dialog&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.xtx-pay-checkout-page &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line"></span><br><span class="line">  .wrapper &#123;</span><br><span class="line">    background: #fff;</span><br><span class="line">    padding: 0 20px;</span><br><span class="line"></span><br><span class="line">    .box-title &#123;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      font-weight: normal;</span><br><span class="line">      padding-left: 10px;</span><br><span class="line">      line-height: 70px;</span><br><span class="line">      border-bottom: 1px solid #f5f5f5;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .box-body &#123;</span><br><span class="line">      padding: 20px 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.address &#123;</span><br><span class="line">  border: 1px solid #f5f5f5;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  .text &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    min-height: 90px;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    .none &#123;</span><br><span class="line">      line-height: 90px;</span><br><span class="line">      color: #999;</span><br><span class="line">      text-align: center;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; ul &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      padding: 20px;</span><br><span class="line"></span><br><span class="line">      li &#123;</span><br><span class="line">        line-height: 30px;</span><br><span class="line"></span><br><span class="line">        span &#123;</span><br><span class="line">          color: #999;</span><br><span class="line">          margin-right: 5px;</span><br><span class="line"></span><br><span class="line">          &gt; i &#123;</span><br><span class="line">            width: 0.5em;</span><br><span class="line">            display: inline-block;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; a &#123;</span><br><span class="line">      color: $xtxColor;</span><br><span class="line">      width: 160px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      height: 90px;</span><br><span class="line">      line-height: 90px;</span><br><span class="line">      border-right: 1px solid #f5f5f5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .action &#123;</span><br><span class="line">    width: 420px;</span><br><span class="line">    text-align: center;</span><br><span class="line"></span><br><span class="line">    .btn &#123;</span><br><span class="line">      width: 140px;</span><br><span class="line">      height: 46px;</span><br><span class="line">      line-height: 44px;</span><br><span class="line">      font-size: 14px;</span><br><span class="line"></span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        margin-right: 10px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.goods &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  border-collapse: collapse;</span><br><span class="line">  border-spacing: 0;</span><br><span class="line"></span><br><span class="line">  .info &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    text-align: left;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 70px;</span><br><span class="line">      height: 70px;</span><br><span class="line">      margin-right: 20px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .right &#123;</span><br><span class="line">      line-height: 24px;</span><br><span class="line"></span><br><span class="line">      p &#123;</span><br><span class="line">        &amp;:last-child &#123;</span><br><span class="line">          color: #999;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tr &#123;</span><br><span class="line">    th &#123;</span><br><span class="line">      background: #f5f5f5;</span><br><span class="line">      font-weight: normal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    td,</span><br><span class="line">    th &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">      padding: 20px;</span><br><span class="line">      border-bottom: 1px solid #f5f5f5;</span><br><span class="line"></span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        border-left: 1px solid #f5f5f5;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-right: 1px solid #f5f5f5;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.my-btn &#123;</span><br><span class="line">  width: 228px;</span><br><span class="line">  height: 50px;</span><br><span class="line">  border: 1px solid #e4e4e4;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 48px;</span><br><span class="line">  margin-right: 25px;</span><br><span class="line">  color: #666666;</span><br><span class="line">  display: inline-block;</span><br><span class="line"></span><br><span class="line">  &amp;.active,</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    border-color: $xtxColor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.total &#123;</span><br><span class="line">  dl &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">    line-height: 50px;</span><br><span class="line"></span><br><span class="line">    dt &#123;</span><br><span class="line">      i &#123;</span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dd &#123;</span><br><span class="line">      width: 240px;</span><br><span class="line">      text-align: right;</span><br><span class="line">      padding-right: 70px;</span><br><span class="line"></span><br><span class="line">      &amp;.price &#123;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        color: $priceColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.submit &#123;</span><br><span class="line">  text-align: right;</span><br><span class="line">  padding: 60px;</span><br><span class="line">  border-top: 1px solid #f5f5f5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.addressWrapper &#123;</span><br><span class="line">  max-height: 500px;</span><br><span class="line">  overflow-y: auto;</span><br><span class="line">  :deep(.el-form-item__label) &#123;</span><br><span class="line">    width: 120px !important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  position: relative;</span><br><span class="line">  min-height: 90px;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  &amp;.item &#123;</span><br><span class="line">    border: 1px solid #f5f5f5;</span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line"></span><br><span class="line">    &amp;.active,</span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      border-color: $xtxColor;</span><br><span class="line">      background: lighten($xtxColor, 50%);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;:hover .close &#123;</span><br><span class="line">      opacity: 1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; ul &#123;</span><br><span class="line">      padding: 10px;</span><br><span class="line">      font-size: 14px;</span><br><span class="line">      line-height: 30px;</span><br><span class="line">    &#125;</span><br><span class="line">    .close &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 10px;</span><br><span class="line">      right: 10px;</span><br><span class="line">      opacity: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="十一、支付页"><a href="#十一、支付页" class="headerlink" title="十一、支付页"></a>十一、支付页</h2><h3 id="1、整体结构"><a href="#1、整体结构" class="headerlink" title="1、整体结构"></a>1、整体结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getOrderAPI &#125; from &quot;@/apis/payPage&quot;;</span><br><span class="line">import &#123; useRoute &#125; from &quot;vue-router&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import dayjs from &quot;dayjs&quot;;</span><br><span class="line">import &#123; onUnmounted &#125; from &quot;vue&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">const payInfo = ref(&#123;&#125;);</span><br><span class="line">const time = ref(0);</span><br><span class="line">let timer = null;</span><br><span class="line">const getPayInfo = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getOrderAPI(route.params.id);</span><br><span class="line">  payInfo.value = data.result;</span><br><span class="line">  time.value = data.result.countdown;</span><br><span class="line">  timer = setInterval(() =&gt; &#123;</span><br><span class="line">    time.value--;</span><br><span class="line">  &#125;, 1000);</span><br><span class="line">&#125;;</span><br><span class="line">const formateTime = computed(() =&gt; dayjs.unix(time.value).format(&quot;mm分ss秒&quot;));</span><br><span class="line">onMounted(() =&gt; getPayInfo());</span><br><span class="line">// 点击支付宝付款</span><br><span class="line">const baseURL = &quot;http://pcapi-xiaotuxian-front-devtest.itheima.net/&quot;;</span><br><span class="line">const backURL = &quot;http://localhost:5173/paycallback&quot;;</span><br><span class="line">const redirectUrl = encodeURIComponent(backURL);</span><br><span class="line">const payUrl = `$&#123;baseURL&#125;pay/aliPay?orderId=$&#123;route.params.id&#125;&amp;redirect=$&#123;redirectUrl&#125;`;</span><br><span class="line">// 别忘了组件销毁时手动清除定时器，因为浏览器在组件销毁后并不会自动清除定时器</span><br><span class="line">onUnmounted(() =&gt; clearInterval(timer));</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;xtx-pay-page&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;!-- 付款信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;pay-info&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;icon iconfont icon-queren2&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;div class=&quot;tip&quot;&gt;</span><br><span class="line">          &lt;p&gt;订单提交成功！请尽快完成支付。&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;</span><br><span class="line">            支付还剩 &lt;span&gt;&#123;&#123; formateTime &#125;&#125;&lt;/span</span><br><span class="line">            &gt;, 超时后将取消订单</span><br><span class="line">          &lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;amount&quot;&gt;</span><br><span class="line">          &lt;span&gt;应付总额：&lt;/span&gt;</span><br><span class="line">          &lt;span&gt;¥&#123;&#123; payInfo.payMoney?.toFixed(2) &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 付款方式 --&gt;</span><br><span class="line">      &lt;div class=&quot;pay-type&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;head&quot;&gt;选择以下支付方式付款&lt;/p&gt;</span><br><span class="line">        &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">          &lt;p&gt;支付平台&lt;/p&gt;</span><br><span class="line">          &lt;a class=&quot;btn wx&quot; href=&quot;javascript:;&quot;&gt;&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;btn alipay&quot; :href=&quot;payUrl&quot;&gt;&lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">          &lt;p&gt;支付方式&lt;/p&gt;</span><br><span class="line">          &lt;a class=&quot;btn&quot; href=&quot;javascript:;&quot;&gt;招商银行&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;btn&quot; href=&quot;javascript:;&quot;&gt;工商银行&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;btn&quot; href=&quot;javascript:;&quot;&gt;建设银行&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;btn&quot; href=&quot;javascript:;&quot;&gt;农业银行&lt;/a&gt;</span><br><span class="line">          &lt;a class=&quot;btn&quot; href=&quot;javascript:;&quot;&gt;交通银行&lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.xtx-pay-page &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.pay-info &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  height: 240px;</span><br><span class="line">  padding: 0 80px;</span><br><span class="line"></span><br><span class="line">  .icon &#123;</span><br><span class="line">    font-size: 80px;</span><br><span class="line">    color: #1dc779;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tip &#123;</span><br><span class="line">    padding-left: 10px;</span><br><span class="line">    flex: 1;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        margin-bottom: 5px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        color: #999;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .amount &#123;</span><br><span class="line">    span &#123;</span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        color: #999;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        color: $priceColor;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.pay-type &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  padding-bottom: 70px;</span><br><span class="line"></span><br><span class="line">  p &#123;</span><br><span class="line">    line-height: 70px;</span><br><span class="line">    height: 70px;</span><br><span class="line">    padding-left: 30px;</span><br><span class="line">    font-size: 16px;</span><br><span class="line"></span><br><span class="line">    &amp;.head &#123;</span><br><span class="line">      border-bottom: 1px solid #f5f5f5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .btn &#123;</span><br><span class="line">    width: 150px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    border: 1px solid #e4e4e4;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 48px;</span><br><span class="line">    margin-left: 30px;</span><br><span class="line">    color: #666666;</span><br><span class="line">    display: inline-block;</span><br><span class="line"></span><br><span class="line">    &amp;.active,</span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      border-color: $xtxColor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;.alipay &#123;</span><br><span class="line">      background: url(https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/7b6b02396368c9314528c0bbd85a2e06.png)</span><br><span class="line">        no-repeat center / contain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;.wx &#123;</span><br><span class="line">      background: url(https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/c66f98cff8649bd5ba722c2e8067c6ca.jpg)</span><br><span class="line">        no-repeat center / contain;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、支付业务流程"><a href="#2、支付业务流程" class="headerlink" title="2、支付业务流程"></a>2、支付业务流程</h3><p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230605104940358.png" alt="image-20230605104940358"></p>
<p>因此，在前端我们只需要给<em>点击支付</em>一个 URL 地址，并携带 orderId 参数和 redirect 参数（用于指定支付完成后的回跳地址）即可。支付完成后，页面会携带订单 id 和支付状态的参数自动跳转到我们给定的这个回跳地址</p>
<h3 id="3、支付结果展示"><a href="#3、支付结果展示" class="headerlink" title="3、支付结果展示"></a>3、支付结果展示</h3><p>paycallback 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getOrderAPI &#125; from &quot;@/apis/payPage&quot;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRoute &#125; from &quot;vue-router&quot;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">const orderInfo = ref(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">const getOrderInfo = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getOrderAPI(route.query.orderId);</span><br><span class="line">  orderInfo.value = data.result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; getOrderInfo());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;xtx-pay-page&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">      &lt;!-- 支付结果 --&gt;</span><br><span class="line">      &lt;div class=&quot;pay-result&quot;&gt;</span><br><span class="line">        &lt;span</span><br><span class="line">          class=&quot;iconfont icon-queren2 green&quot;</span><br><span class="line">          v-if=&quot;$route.query.payResult === &#x27;true&#x27;&quot;</span><br><span class="line">        &gt;&lt;/span&gt;</span><br><span class="line">        &lt;span class=&quot;iconfont icon-shanchu red&quot; v-else&gt;&lt;/span&gt;</span><br><span class="line">        &lt;p class=&quot;tit&quot;&gt;</span><br><span class="line">          支付&#123;&#123; $route.query.payResult === &quot;true&quot; ? &quot;成功&quot; : &quot;失败&quot; &#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p class=&quot;tip&quot;&gt;我们将尽快为您发货，收货期间请保持手机畅通&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;支付方式：&lt;span&gt;支付宝&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          支付金额：&lt;span&gt;¥&#123;&#123; orderInfo.payMoney?.toFixed(2) &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;div class=&quot;btn&quot;&gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            type=&quot;primary&quot;</span><br><span class="line">            style=&quot;margin-right: 20px&quot;</span><br><span class="line">            @click=&quot;$router.push(&#x27;/VIP&#x27;)&quot;</span><br><span class="line">            &gt;查看订单&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button @click=&quot;$router.push(&#x27;/&#x27;)&quot;&gt;进入首页&lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;p class=&quot;alert&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;iconfont icon-tip&quot;&gt;&lt;/span&gt;</span><br><span class="line">          温馨提示：小兔鲜儿不会以订单异常、系统升级为由要求您点击任何网址链接进行退款操作，保护资产、谨慎操作。</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.pay-result &#123;</span><br><span class="line">  padding: 100px 0;</span><br><span class="line">  background: #fff;</span><br><span class="line">  text-align: center;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line"></span><br><span class="line">  &gt; .iconfont &#123;</span><br><span class="line">    font-size: 100px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .green &#123;</span><br><span class="line">    color: #1dc779;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .red &#123;</span><br><span class="line">    color: $priceColor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tit &#123;</span><br><span class="line">    font-size: 24px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tip &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  p &#123;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .btn &#123;</span><br><span class="line">    margin-top: 50px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .alert &#123;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    color: #999;</span><br><span class="line">    margin-top: 50px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="十二、会员中心"><a href="#十二、会员中心" class="headerlink" title="十二、会员中心"></a>十二、会员中心</h2><h3 id="1、整体结构-1"><a href="#1、整体结构-1" class="headerlink" title="1、整体结构"></a>1、整体结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;xtx-member-aside&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;user-manage&quot;&gt;</span><br><span class="line">        &lt;h4&gt;我的账户&lt;/h4&gt;</span><br><span class="line">        &lt;div class=&quot;links&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/VIP&quot;&gt;个人中心&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;h4&gt;交易管理&lt;/h4&gt;</span><br><span class="line">        &lt;div class=&quot;links&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/VIP/myOrders&quot;&gt;我的订单&lt;/RouterLink&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;article&quot;&gt;</span><br><span class="line">      &lt;!-- 三级路由的挂载点 --&gt;</span><br><span class="line">      &lt;RouterView /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.container &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  padding-top: 20px;</span><br><span class="line"></span><br><span class="line">  .xtx-member-aside &#123;</span><br><span class="line">    width: 220px;</span><br><span class="line">    margin-right: 20px;</span><br><span class="line">    border-radius: 2px;</span><br><span class="line">    background-color: #fff;</span><br><span class="line"></span><br><span class="line">    .user-manage &#123;</span><br><span class="line">      background-color: #fff;</span><br><span class="line"></span><br><span class="line">      h4 &#123;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">        font-weight: 400;</span><br><span class="line">        padding: 20px 52px 5px;</span><br><span class="line">        border-top: 1px solid #f6f6f6;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .links &#123;</span><br><span class="line">        padding: 0 52px 10px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      a &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        line-height: 1;</span><br><span class="line">        padding: 15px 0;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">        color: #666;</span><br><span class="line">        position: relative;</span><br><span class="line"></span><br><span class="line">        &amp;:hover &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;.active,</span><br><span class="line">        &amp;.router-link-exact-active &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line"></span><br><span class="line">          &amp;:before &#123;</span><br><span class="line">            display: block;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;:before &#123;</span><br><span class="line">          content: &quot;&quot;;</span><br><span class="line">          display: none;</span><br><span class="line">          width: 6px;</span><br><span class="line">          height: 6px;</span><br><span class="line">          border-radius: 50%;</span><br><span class="line">          position: absolute;</span><br><span class="line">          top: 19px;</span><br><span class="line">          left: -16px;</span><br><span class="line">          background-color: $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .article &#123;</span><br><span class="line">    width: 1000px;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>我的订单 myOrders 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; getUserOrder &#125; from &quot;@/apis/vip&quot;;</span><br><span class="line">import &#123; onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">// 订单列表</span><br><span class="line">const orderList = ref([]);</span><br><span class="line">const queryList = ref(&#123;</span><br><span class="line">  orderState: 0,</span><br><span class="line">  page: 1,</span><br><span class="line">  pageSize: 2,</span><br><span class="line">  totalCount: 0,</span><br><span class="line">&#125;);</span><br><span class="line">const getOrders = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getUserOrder(queryList.value);</span><br><span class="line">  orderList.value = data.result.items;</span><br><span class="line">  queryList.value.totalCount = data.result.counts;</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; getOrders());</span><br><span class="line">// tab列表</span><br><span class="line">const tabTypes = [</span><br><span class="line">  &#123; name: &quot;all&quot;, label: &quot;全部订单&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;unpay&quot;, label: &quot;待付款&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;deliver&quot;, label: &quot;待发货&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;receive&quot;, label: &quot;待收货&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;comment&quot;, label: &quot;待评价&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;complete&quot;, label: &quot;已完成&quot; &#125;,</span><br><span class="line">  &#123; name: &quot;cancel&quot;, label: &quot;已取消&quot; &#125;,</span><br><span class="line">];</span><br><span class="line">// 页码改变时</span><br><span class="line">const pageChange = async (val) =&gt; &#123;</span><br><span class="line">  queryList.value.page = val;</span><br><span class="line">  getOrders();</span><br><span class="line">&#125;;</span><br><span class="line">// tab栏切换</span><br><span class="line">const change = (value) =&gt; &#123;</span><br><span class="line">  queryList.value.orderState = value;</span><br><span class="line">  getOrders();</span><br><span class="line">&#125;;</span><br><span class="line">// 格式化订单状态显示</span><br><span class="line">const stateMap = &#123;</span><br><span class="line">  1: &quot;待付款&quot;,</span><br><span class="line">  2: &quot;待发货&quot;,</span><br><span class="line">  3: &quot;待收货&quot;,</span><br><span class="line">  4: &quot;待评价&quot;,</span><br><span class="line">  5: &quot;已完成&quot;,</span><br><span class="line">  6: &quot;已取消&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;order-container&quot;&gt;</span><br><span class="line">    &lt;el-tabs @tab-change=&quot;change&quot;&gt;</span><br><span class="line">      &lt;!-- tab切换 --&gt;</span><br><span class="line">      &lt;el-tab-pane</span><br><span class="line">        v-for=&quot;item in tabTypes&quot;</span><br><span class="line">        :key=&quot;item.name&quot;</span><br><span class="line">        :label=&quot;item.label&quot;</span><br><span class="line">      /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;main-container&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;holder-container&quot; v-if=&quot;orderList.length === 0&quot;&gt;</span><br><span class="line">          &lt;el-empty description=&quot;暂无订单数据&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div v-else&gt;</span><br><span class="line">          &lt;!-- 订单列表 --&gt;</span><br><span class="line">          &lt;div class=&quot;order-item&quot; v-for=&quot;order in orderList&quot; :key=&quot;order.id&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;head&quot;&gt;</span><br><span class="line">              &lt;span&gt;下单时间：&#123;&#123; order.createTime &#125;&#125;&lt;/span&gt;</span><br><span class="line">              &lt;span&gt;订单编号：&#123;&#123; order.id &#125;&#125;&lt;/span&gt;</span><br><span class="line">              &lt;!-- 未付款，倒计时时间还有 --&gt;</span><br><span class="line">              &lt;span class=&quot;down-time&quot; v-if=&quot;order.orderState === 1&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;iconfont icon-down-time&quot;&gt;&lt;/i&gt;</span><br><span class="line">                &lt;b&gt;付款截止: &#123;&#123; order.countdown &#125;&#125;&lt;/b&gt;</span><br><span class="line">              &lt;/span&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;body&quot;&gt;</span><br><span class="line">              &lt;div class=&quot;column goods&quot;&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                  &lt;li v-for=&quot;item in order.skus&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">                    &lt;a class=&quot;image&quot; href=&quot;javascript:;&quot;&gt;</span><br><span class="line">                      &lt;img :src=&quot;item.image&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">                    &lt;/a&gt;</span><br><span class="line">                    &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">                      &lt;p class=&quot;name ellipsis-2&quot;&gt;</span><br><span class="line">                        &#123;&#123; item.name &#125;&#125;</span><br><span class="line">                      &lt;/p&gt;</span><br><span class="line">                      &lt;p class=&quot;attr ellipsis&quot;&gt;</span><br><span class="line">                        &lt;span&gt;&#123;&#123; item.attrsText &#125;&#125;&lt;/span&gt;</span><br><span class="line">                      &lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;price&quot;&gt;¥&#123;&#123; item.realPay?.toFixed(2) &#125;&#125;&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;count&quot;&gt;x&#123;&#123; item.quantity &#125;&#125;&lt;/div&gt;</span><br><span class="line">                  &lt;/li&gt;</span><br><span class="line">                &lt;/ul&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;column state&quot;&gt;</span><br><span class="line">                &lt;p&gt;&#123;&#123; stateMap[order.orderState] &#125;&#125;&lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;order.orderState === 3&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;查看物流&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;order.orderState === 4&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;评价商品&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;order.orderState === 5&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;查看评价&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;column amount&quot;&gt;</span><br><span class="line">                &lt;p class=&quot;red&quot;&gt;¥&#123;&#123; order.payMoney?.toFixed(2) &#125;&#125;&lt;/p&gt;</span><br><span class="line">                &lt;p&gt;（含运费：¥&#123;&#123; order.postFee?.toFixed(2) &#125;&#125;）&lt;/p&gt;</span><br><span class="line">                &lt;p&gt;在线支付&lt;/p&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;column action&quot;&gt;</span><br><span class="line">                &lt;el-button</span><br><span class="line">                  v-if=&quot;order.orderState === 1&quot;</span><br><span class="line">                  type=&quot;primary&quot;</span><br><span class="line">                  size=&quot;small&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  立即付款</span><br><span class="line">                &lt;/el-button&gt;</span><br><span class="line">                &lt;el-button</span><br><span class="line">                  v-if=&quot;order.orderState === 3&quot;</span><br><span class="line">                  type=&quot;primary&quot;</span><br><span class="line">                  size=&quot;small&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  确认收货</span><br><span class="line">                &lt;/el-button&gt;</span><br><span class="line">                &lt;p&gt;&lt;a href=&quot;javascript:;&quot;&gt;查看详情&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;[2, 3, 4, 5].includes(order.orderState)&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot;&gt;再次购买&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;[4, 5].includes(order.orderState)&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot;&gt;申请售后&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                &lt;p v-if=&quot;order.orderState === 1&quot;&gt;</span><br><span class="line">                  &lt;a href=&quot;javascript:;&quot;&gt;取消订单&lt;/a&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;!-- 分页 --&gt;</span><br><span class="line">          &lt;div class=&quot;pagination-container&quot;&gt;</span><br><span class="line">            &lt;el-pagination</span><br><span class="line">              background</span><br><span class="line">              layout=&quot;prev, pager, next&quot;</span><br><span class="line">              :total=&quot;queryList.totalCount&quot;</span><br><span class="line">              :page-size=&quot;queryList.pageSize&quot;</span><br><span class="line">              :current-page=&quot;queryList.page&quot;</span><br><span class="line">              @current-change=&quot;pageChange&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-tabs&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.order-container &#123;</span><br><span class="line">  padding: 10px 20px;</span><br><span class="line"></span><br><span class="line">  .pagination-container &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .main-container &#123;</span><br><span class="line">    min-height: 500px;</span><br><span class="line"></span><br><span class="line">    .holder-container &#123;</span><br><span class="line">      min-height: 500px;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.order-item &#123;</span><br><span class="line">  margin-bottom: 20px;</span><br><span class="line">  border: 1px solid #f5f5f5;</span><br><span class="line"></span><br><span class="line">  .head &#123;</span><br><span class="line">    height: 50px;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    background: #f5f5f5;</span><br><span class="line">    padding: 0 20px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line"></span><br><span class="line">    span &#123;</span><br><span class="line">      margin-right: 20px;</span><br><span class="line"></span><br><span class="line">      &amp;.down-time &#123;</span><br><span class="line">        margin-right: 0;</span><br><span class="line">        float: right;</span><br><span class="line"></span><br><span class="line">        i &#123;</span><br><span class="line">          vertical-align: middle;</span><br><span class="line">          margin-right: 3px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        b &#123;</span><br><span class="line">          vertical-align: middle;</span><br><span class="line">          font-weight: normal;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .del &#123;</span><br><span class="line">      margin-right: 0;</span><br><span class="line">      float: right;</span><br><span class="line">      color: #999;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .body &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: stretch;</span><br><span class="line"></span><br><span class="line">    .column &#123;</span><br><span class="line">      border-left: 1px solid #f5f5f5;</span><br><span class="line">      text-align: center;</span><br><span class="line">      padding: 20px;</span><br><span class="line"></span><br><span class="line">      &gt; p &#123;</span><br><span class="line">        padding-top: 10px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        border-left: none;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;.goods &#123;</span><br><span class="line">        flex: 1;</span><br><span class="line">        padding: 0;</span><br><span class="line">        align-self: center;</span><br><span class="line"></span><br><span class="line">        ul &#123;</span><br><span class="line">          li &#123;</span><br><span class="line">            border-bottom: 1px solid #f5f5f5;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            display: flex;</span><br><span class="line"></span><br><span class="line">            &amp;:last-child &#123;</span><br><span class="line">              border-bottom: none;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .image &#123;</span><br><span class="line">              width: 70px;</span><br><span class="line">              height: 70px;</span><br><span class="line">              border: 1px solid #f5f5f5;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .info &#123;</span><br><span class="line">              width: 220px;</span><br><span class="line">              text-align: left;</span><br><span class="line">              padding: 0 10px;</span><br><span class="line"></span><br><span class="line">              p &#123;</span><br><span class="line">                margin-bottom: 5px;</span><br><span class="line"></span><br><span class="line">                &amp;.name &#123;</span><br><span class="line">                  height: 38px;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                &amp;.attr &#123;</span><br><span class="line">                  color: #999;</span><br><span class="line">                  font-size: 12px;</span><br><span class="line"></span><br><span class="line">                  span &#123;</span><br><span class="line">                    margin-right: 5px;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .price &#123;</span><br><span class="line">              width: 100px;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .count &#123;</span><br><span class="line">              width: 80px;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;.state &#123;</span><br><span class="line">        width: 120px;</span><br><span class="line"></span><br><span class="line">        .green &#123;</span><br><span class="line">          color: $xtxColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;.amount &#123;</span><br><span class="line">        width: 200px;</span><br><span class="line"></span><br><span class="line">        .red &#123;</span><br><span class="line">          color: $priceColor;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;.action &#123;</span><br><span class="line">        width: 140px;</span><br><span class="line"></span><br><span class="line">        a &#123;</span><br><span class="line">          display: block;</span><br><span class="line"></span><br><span class="line">          &amp;:hover &#123;</span><br><span class="line">            color: $xtxColor;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>个人中心 userInfo 组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useUserInfoStore &#125; from &quot;@/stores/userInfo&quot;;</span><br><span class="line">import &#123; getLikeListAPI &#125; from &quot;@/apis/vip&quot;;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">const &#123; userInfo &#125; = useUserInfoStore();</span><br><span class="line">const likeList = ref([]);</span><br><span class="line">const getLikeList = async () =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = await getLikeListAPI(&#123; limit: 4 &#125;);</span><br><span class="line">  likeList.value = data.result;</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; getLikeList());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home-overview&quot;&gt;</span><br><span class="line">    &lt;!-- 用户信息 --&gt;</span><br><span class="line">    &lt;div class=&quot;user-meta&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;avatar&quot;&gt;</span><br><span class="line">        &lt;img :src=&quot;userInfo?.avatar&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;h4&gt;&#123;&#123; userInfo?.account &#125;&#125;&lt;/h4&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">      &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;iconfont icon-hy&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;p&gt;会员中心&lt;/p&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">      &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;iconfont icon-aq&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;p&gt;安全设置&lt;/p&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">      &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;iconfont icon-dw&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;p&gt;地址管理&lt;/p&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;like-container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;home-panel&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">        &lt;h4 data-v-bcb266e0=&quot;&quot;&gt;猜你喜欢&lt;/h4&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;goods-list&quot;&gt;</span><br><span class="line">        &lt;GoodsItem v-for=&quot;good in likeList&quot; :key=&quot;good.id&quot; :goods=&quot;good&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.home-overview &#123;</span><br><span class="line">  height: 132px;</span><br><span class="line">  background: url(@/assets/images/center-bg.png) no-repeat center / cover;</span><br><span class="line">  display: flex;</span><br><span class="line"></span><br><span class="line">  .user-meta &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    .avatar &#123;</span><br><span class="line">      width: 85px;</span><br><span class="line">      height: 85px;</span><br><span class="line">      border-radius: 50%;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      margin-left: 60px;</span><br><span class="line"></span><br><span class="line">      img &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h4 &#123;</span><br><span class="line">      padding-left: 26px;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      font-weight: normal;</span><br><span class="line">      color: white;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-around;</span><br><span class="line"></span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      border-right: 1px solid #f4f4f4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    a &#123;</span><br><span class="line">      color: white;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      text-align: center;</span><br><span class="line"></span><br><span class="line">      .iconfont &#123;</span><br><span class="line">        font-size: 32px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      p &#123;</span><br><span class="line">        line-height: 32px;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.like-container &#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.home-panel &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  padding: 0 20px;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">  height: 400px;</span><br><span class="line"></span><br><span class="line">  .header &#123;</span><br><span class="line">    height: 66px;</span><br><span class="line">    border-bottom: 1px solid #f5f5f5;</span><br><span class="line">    padding: 18px 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: baseline;</span><br><span class="line"></span><br><span class="line">    h4 &#123;</span><br><span class="line">      font-size: 22px;</span><br><span class="line">      font-weight: 400;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods-list &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-around;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>这样一个基本的电商类项目就开发完成了，源码见<a target="_blank" rel="noopener" href="https://github.com/congtianfeng/xtx-pc/">https://github.com/congtianfeng/xtx-pc/</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-配合腾讯云Cos封装一个上传图片组件"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/11/22/%E9%85%8D%E5%90%88%E8%85%BE%E8%AE%AF%E4%BA%91Cos%E5%B0%81%E8%A3%85%E4%B8%80%E4%B8%AA%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E7%BB%84%E4%BB%B6/"
    >配合腾讯云Cos封装一个上传图片组件</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/11/22/%E9%85%8D%E5%90%88%E8%85%BE%E8%AE%AF%E4%BA%91Cos%E5%B0%81%E8%A3%85%E4%B8%80%E4%B8%AA%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E7%BB%84%E4%BB%B6/" class="article-date">
  <time datetime="2022-11-22T11:32:23.000Z" itemprop="datePublished">2022-11-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="一、需求分析"><a href="#一、需求分析" class="headerlink" title="一、需求分析"></a>一、需求分析</h2><p>该组件需要满足以下要求：</p>
<ol>
<li>可以显示传入的图片地址</li>
<li>可以删除传入的图片地址</li>
<li>可以上传图片到云服务器</li>
<li>上传到腾讯云之后，可以返回图片地址，显示</li>
<li>上传成功之后，可以回调成功函数</li>
</ol>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200806174643390.png" alt="image-20200806174643390"></p>
<p>从上图中，我们可以看到，实际上是有两种场景的，本地场景和已经上传的场景</p>
<h2 id="二、安装-JavaScript-SDK"><a href="#二、安装-JavaScript-SDK" class="headerlink" title="二、安装 JavaScript SDK"></a>二、<strong>安装 JavaScript SDK</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i cos-js-sdk-v5 --save</span><br></pre></td></tr></table></figure>

<h2 id="三、实例化上传-sdk"><a href="#三、实例化上传-sdk" class="headerlink" title="三、实例化上传 sdk"></a>三、<strong>实例化上传 sdk</strong></h2><table>
<thead>
<tr>
<th align="left">名称</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SecretId</td>
<td align="left">开发者拥有的项目身份识别 ID，用以身份认证，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
<tr>
<td align="left">SecretKey</td>
<td align="left">开发者拥有的项目身份密钥，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
</tbody></table>
<blockquote>
<p>注意，为了方便，这里直接将参数放置在前端代码中存储，但是腾讯云本身是不建议这么做的，因为**<code>敏感信息</code>**放在前端很容易被捕获。</p>
<p>正确的做法应该是，通过网站调用接口换取敏感信息</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/11459">相关文档</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cos = <span class="keyword">new</span> <span class="title function_">COS</span>(&#123;</span><br><span class="line">  <span class="title class_">SecretId</span>: <span class="string">&quot;COS_SECRETID&quot;</span>, <span class="comment">// 身份识别 ID</span></span><br><span class="line">  <span class="title class_">SecretKey</span>: <span class="string">&quot;COS_SECRETKEY&quot;</span>, <span class="comment">// 身份密钥</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="四、准备组件并注册"><a href="#四、准备组件并注册" class="headerlink" title="四、准备组件并注册"></a>四、准备组件并注册</h2><p><strong>新建上传图片组件</strong> <strong><code>src/components/ImageUpload/index.vue</code></strong></p>
<blockquote>
<p>上传组件，我们可以沿用 element 的 el-upload 组件,并且采用照片墙的模式 <strong><code>list-type=&quot;picture-card&quot;</code></strong></p>
</blockquote>
<p><strong>放置 el-upload 组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload list-type=&quot;picture-card&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;el-icon-plus&quot; /&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局注册组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ImageUpload</span> <span class="keyword">from</span> <span class="string">&quot;./ImageUpload&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">Vue</span>) &#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;ImageUpload&quot;</span>, <span class="title class_">ImageUpload</span>); <span class="comment">// 注册导入上传组件</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="五、上传动作调用上传腾讯云"><a href="#五、上传动作调用上传腾讯云" class="headerlink" title="五、上传动作调用上传腾讯云"></a>五、上传动作调用上传腾讯云</h2><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/35649#.E7.AE.80.E5.8D.95.E4.B8.8A.E4.BC.A0.E5.AF.B9.E8.B1.A1">腾讯云文档地址</a></p>
<h3 id="1、上传"><a href="#1、上传" class="headerlink" title="1、上传"></a>1、上传</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 进行上传操作</span></span><br><span class="line"><span class="title function_">upload</span>(<span class="params">params</span>) &#123;</span><br><span class="line"><span class="comment">//   console.log(params.file)</span></span><br><span class="line">  <span class="keyword">if</span> (params.<span class="property">file</span>) &#123;</span><br><span class="line">    <span class="comment">// 执行上传操作</span></span><br><span class="line">    cos.<span class="title function_">putObject</span>(&#123;</span><br><span class="line">      <span class="title class_">Bucket</span>: <span class="string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="comment">// 存储桶</span></span><br><span class="line">      <span class="title class_">Region</span>: <span class="string">&#x27;ap-beijing&#x27;</span>, <span class="comment">// 地域</span></span><br><span class="line">      <span class="title class_">Key</span>: params.<span class="property">file</span>.<span class="property">name</span>, <span class="comment">// 文件名</span></span><br><span class="line">      <span class="title class_">Body</span>: params.<span class="property">file</span>, <span class="comment">// 要上传的文件对象</span></span><br><span class="line">      <span class="title class_">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span> <span class="comment">// 上传的模式类型 直接默认 标准模式即可</span></span><br><span class="line">      <span class="comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span></span><br><span class="line">    &#125;, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line">      <span class="comment">// data返回数据之后 应该如何处理</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(err || data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、上传成功后处理返回数据"><a href="#2、上传成功后处理返回数据" class="headerlink" title="2、上传成功后处理返回数据"></a>2、上传成功后处理返回数据</h3><p>确定要上传记录 id</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">beforeUpload</span>(<span class="params">file</span>) &#123;</span><br><span class="line">    <span class="comment">//   先检查文件类型</span></span><br><span class="line">    <span class="keyword">const</span> types = [<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="string">&#x27;image/gif&#x27;</span>, <span class="string">&#x27;image/bmp&#x27;</span>, <span class="string">&#x27;image/png&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (!types.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> item === file.<span class="property">type</span>)) &#123;</span><br><span class="line">      <span class="comment">//   如果不存在</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 上传终止</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 检查文件大小  5M 1M = 1024KB 1KB = 1024B</span></span><br><span class="line">    <span class="keyword">const</span> maxSize = <span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">    <span class="keyword">if</span> (file.<span class="property">size</span> &gt; maxSize) &#123;</span><br><span class="line">      <span class="comment">//   超过了限制的文件大小</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;上传的图片大小不能大于5M&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//   已经确定当前上传的就是当前的这个file了</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentFileUid</span> = file.<span class="property">uid</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 最后一定要return  true</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>处理返回的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 进行上传操作</span></span><br><span class="line"><span class="title function_">upload</span>(<span class="params">params</span>) &#123;</span><br><span class="line"><span class="comment">//   console.log(params.file)</span></span><br><span class="line">  <span class="keyword">if</span> (params.<span class="property">file</span>) &#123;</span><br><span class="line">    <span class="comment">// 执行上传操作</span></span><br><span class="line">    cos.<span class="title function_">putObject</span>(&#123;</span><br><span class="line">      <span class="title class_">Bucket</span>: <span class="string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="comment">// 存储桶</span></span><br><span class="line">      <span class="title class_">Region</span>: <span class="string">&#x27;ap-beijing&#x27;</span>, <span class="comment">// 地域</span></span><br><span class="line">      <span class="title class_">Key</span>: params.<span class="property">file</span>.<span class="property">name</span>, <span class="comment">// 文件名</span></span><br><span class="line">      <span class="title class_">Body</span>: params.<span class="property">file</span>, <span class="comment">// 要上传的文件对象</span></span><br><span class="line">      <span class="title class_">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span> <span class="comment">// 上传的模式类型 直接默认 标准模式即可</span></span><br><span class="line">      <span class="comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span></span><br><span class="line">    &#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// data返回数据之后 应该如何处理</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(err || data)</span><br><span class="line">      <span class="comment">// data中有一个statusCode === 200 的时候说明上传成功</span></span><br><span class="line">      <span class="keyword">if</span> (!err &amp;&amp; data.<span class="property">statusCode</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">//   此时说明文件上传成功  要获取成功的返回地址</span></span><br><span class="line">        <span class="comment">// fileList才能显示到上传组件上 此时我们要将fileList中的数据的url地址变成 现在上传成功的地址</span></span><br><span class="line">        <span class="comment">// 目前虽然是一张图片 但是请注意 我们的fileList是一个数组</span></span><br><span class="line">        <span class="comment">// 需要知道当前上传成功的是哪一张图片</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">fileList</span> = <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 去找谁的uid等于刚刚记录下来的id</span></span><br><span class="line">          <span class="keyword">if</span> (item.<span class="property">uid</span> === <span class="variable language_">this</span>.<span class="property">currentFileUid</span>) &#123;</span><br><span class="line">            <span class="comment">// 将成功的地址赋值给原来的url属性</span></span><br><span class="line">            <span class="keyword">return</span> &#123; <span class="attr">url</span>: <span class="string">&#x27;http://&#x27;</span> + data.<span class="property">Location</span>, <span class="attr">upload</span>: <span class="literal">true</span> &#125;</span><br><span class="line">            <span class="comment">// upload 为true 表示这张图片已经上传完毕 这个属性要为我们后期应用的时候做标记</span></span><br><span class="line">            <span class="comment">// 保存  =&gt; 图片有大有小 =&gt; 上传速度有快又慢 =&gt;要根据有没有upload这个标记来决定是否去保存</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> item</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 将上传成功的地址 回写到了fileList中 fileList变化  =》 upload组件 就会根据fileList的变化而去渲染视图</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们在 fileList 中设置了属性为 upload 为 true 的属性，表示该图片已经上传成功了，如果 fileList 还有 upload 不为 true 的数据，那就表示该图片还没有上传完毕</p>
<h2 id="六、上传的进度条显示"><a href="#六、上传的进度条显示" class="headerlink" title="六、上传的进度条显示"></a>六、上传的进度条显示</h2><p><strong>放置进度条</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-progress v-if=&quot;showPercent&quot; style=&quot;width: 180px&quot; :percentage=&quot;percent&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>通过腾讯云 sdk 监听上传进度</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cos.<span class="title function_">putObject</span>(&#123;</span><br><span class="line">         <span class="comment">// 配置</span></span><br><span class="line">         <span class="title class_">Bucket</span>: <span class="string">&#x27;laogao-1302806742&#x27;</span>, <span class="comment">// 存储桶名称</span></span><br><span class="line">         <span class="title class_">Region</span>: <span class="string">&#x27;ap-guangzhou&#x27;</span>, <span class="comment">// 存储桶地域</span></span><br><span class="line">         <span class="title class_">Key</span>: params.<span class="property">file</span>.<span class="property">name</span>, <span class="comment">// 文件名作为key</span></span><br><span class="line">         <span class="title class_">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span>, <span class="comment">// 此类写死</span></span><br><span class="line">         <span class="title class_">Body</span>: params.<span class="property">file</span>, <span class="comment">// 将本地的文件赋值给腾讯云配置</span></span><br><span class="line">         <span class="comment">// 进度条</span></span><br><span class="line">         <span class="attr">onProgress</span>: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">           <span class="variable language_">this</span>.<span class="property">percent</span> = params.<span class="property">percent</span> * <span class="number">100</span></span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、完整代码"><a href="#七、完整代码" class="headerlink" title="七、完整代码"></a>七、<strong>完整代码</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 上传组件 --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- :class=&quot;&#123; class名称：布尔值 &#125;&quot; --&gt;</span><br><span class="line">    &lt;!-- el-upload之所以能够显示图片 是因为 fileList中有值 --&gt;</span><br><span class="line">    &lt;el-upload</span><br><span class="line">      list-type=&quot;picture-card&quot;</span><br><span class="line">      :file-list=&quot;fileList&quot;</span><br><span class="line">      :on-preview=&quot;preview&quot;</span><br><span class="line">      :on-remove=&quot;handleRemove&quot;</span><br><span class="line">      :on-change=&quot;changeFile&quot;</span><br><span class="line">      :before-upload=&quot;beforeUpload&quot;</span><br><span class="line">      :http-request=&quot;upload&quot;</span><br><span class="line">      action=&quot;#&quot;</span><br><span class="line">      :class=&quot;&#123; disabled: fileComputed &#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-plus&quot; /&gt;</span><br><span class="line">    &lt;/el-upload&gt;</span><br><span class="line">    &lt;el-progress</span><br><span class="line">      v-if=&quot;showPercent&quot;</span><br><span class="line">      :percentage=&quot;percent&quot;</span><br><span class="line">      style=&quot;width: 180px&quot;</span><br><span class="line">    /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 预览图片 --&gt;</span><br><span class="line">    &lt;el-dialog :visible.sync=&quot;showDialog&quot; title=&quot;图片预览&quot;&gt;</span><br><span class="line">      &lt;img :src=&quot;imgUrl&quot; alt=&quot;&quot; style=&quot;width:100%&quot; /&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import COS from &quot;cos-js-sdk-v5&quot;;</span><br><span class="line">const cos = new COS(&#123;</span><br><span class="line">  SecretId: &quot;&quot;, // 身份识别 ID</span><br><span class="line">  SecretKey: &quot;&quot;, // 身份密钥</span><br><span class="line">&#125;);</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    limit: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 1,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      showPercent: false, // 控制进度条的显示和隐藏</span><br><span class="line">      percent: 0, // 当前的进度</span><br><span class="line">      showDialog: false, // 默认隐藏</span><br><span class="line">      imgUrl: &quot;&quot;,</span><br><span class="line">      fileList: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 只要该计算属性为true 就表示 我们需要隐藏上传按钮</span><br><span class="line">    fileComputed() &#123;</span><br><span class="line">      return this.fileList.length === this.limit;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    preview(file) &#123;</span><br><span class="line">      this.imgUrl = file.url;</span><br><span class="line">      this.showDialog = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    // file就是要删除的file</span><br><span class="line">    handleRemove(file) &#123;</span><br><span class="line">      // 根据file中uid将当前的fileList中的数据进行移除</span><br><span class="line">      this.fileList = this.fileList.filter((item) =&gt; item.uid !== file.uid);</span><br><span class="line">      // filter方法会得到一个新的数组</span><br><span class="line">    &#125;,</span><br><span class="line">    // 不能够一味 的进行push 因为该函数会被多次调用 fileList其实就是当前最新的文件列表</span><br><span class="line">    changeFile(file, fileList) &#123;</span><br><span class="line">      // this.fileList = [...fileList]</span><br><span class="line">      this.fileList = fileList.map((item) =&gt; item);</span><br><span class="line">    &#125;,</span><br><span class="line">    // 上传之前检查</span><br><span class="line">    beforeUpload(file) &#123;</span><br><span class="line">      //   console.log(file)</span><br><span class="line">      // 要开始做文件上传的检查了</span><br><span class="line">      // 文件类型 文件大小</span><br><span class="line">      const types = [&quot;image/jpeg&quot;, &quot;image/gif&quot;, &quot;image/bmp&quot;, &quot;image/png&quot;];</span><br><span class="line">      if (!types.includes(file.type)) &#123;</span><br><span class="line">        this.$message.error(&quot;上传图片只能是 JPG、GIF、BMP、PNG 格式!&quot;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">      //   文件大小</span><br><span class="line">      const maxSize = 25 * 1024 * 1024;</span><br><span class="line">      if (maxSize &lt; file.size) &#123;</span><br><span class="line">        this.$message.error(&quot;图片最大的大小为5M&quot;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">      return true; // 要返回true</span><br><span class="line">    &#125;,</span><br><span class="line">    // 上传到腾讯云</span><br><span class="line">    // 自定义上传动作</span><br><span class="line">    upload(params) &#123;</span><br><span class="line">      // params中的file就是要上传的图片文件</span><br><span class="line">      //   console.log(params.file)</span><br><span class="line">      if (params.file) &#123;</span><br><span class="line">        this.showPercent = true; // 显示进度条</span><br><span class="line">        //   上传对象到腾讯云</span><br><span class="line">        cos.putObject(</span><br><span class="line">          &#123;</span><br><span class="line">            Bucket: &quot;shuiruohanyu-1302806742&quot; /* 每个人的存储桶名称 */,</span><br><span class="line">            Region: &quot;ap-nanjing&quot; /* 存储桶所在地域，必须字段 */,</span><br><span class="line">            Key: params.file.name /* 文件名称 */,</span><br><span class="line">            StorageClass: &quot;STANDARD&quot;, // 固定值</span><br><span class="line">            Body: params.file, // 上传文件对象</span><br><span class="line">            onProgress: (progressData) =&gt; &#123;</span><br><span class="line">              // console.log(progressData.percent * 100)</span><br><span class="line">              this.percent = progressData.percent * 100;</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          (err, data) =&gt; &#123;</span><br><span class="line">            console.log(err);</span><br><span class="line">            if (data.statusCode === 200 &amp;&amp; data.Location) &#123;</span><br><span class="line">              //   认为此时上传成功</span><br><span class="line">              // 需要知道当前的这个地址是谁的url地址</span><br><span class="line">              //  params.file.uid  =&gt; 当前上传文件的标识  如果找到了一一样的uid 就表示他们是一张图片</span><br><span class="line">              console.log(this.fileList);</span><br><span class="line">              // 这样相当于将原来的旧本地地址换成了新地址</span><br><span class="line">              this.fileList = this.fileList.map((item) =&gt; &#123;</span><br><span class="line">                // 将本地的地址替换成线上已经放在腾讯云之后的地址</span><br><span class="line">                if (item.uid === params.file.uid) &#123;</span><br><span class="line">                  // upload 为true的意思是 表示这张图片 已经上传过了 已经不是本地图片了</span><br><span class="line">                  return &#123; url: &quot;http://&quot; + data.Location, upload: true &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">                return item;</span><br><span class="line">              &#125;);</span><br><span class="line">              this.showPercent = false; // 关闭进度条</span><br><span class="line">              this.percent = 0; // 将进度归0</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.disabled .el-upload--picture-card &#123;</span><br><span class="line">  display: none;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>*通过上面的代码，我们会发现，我们把上传之后的图片信息都给了**<code>fileList数据</code><strong>，那么在应用时，就可以直接获取该实例的</strong><code>fileList数据即可</code>***</p>
<h2 id="八、使用"><a href="#八、使用" class="headerlink" title="八、使用"></a>八、使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;员工头像&quot;&gt;</span><br><span class="line">            &lt;!-- 放置上传图片 --&gt;</span><br><span class="line">            &lt;image-upload ref=&quot;staffPhoto&quot; /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br></pre></td></tr></table></figure>

<h3 id="1、读取时赋值"><a href="#1、读取时赋值" class="headerlink" title="1、读取时赋值"></a>1、读取时赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">getUserDetailById</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">userInfo</span> = <span class="keyword">await</span> <span class="title function_">getUserDetailById</span>(<span class="variable language_">this</span>.<span class="property">userId</span>)</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">userInfo</span>.<span class="property">staffPhoto</span>) &#123;</span><br><span class="line">     <span class="comment">// 这里我们赋值，同时需要给赋值的地址一个标记 upload: true</span></span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">staffPhoto</span>.<span class="property">fileList</span> = [&#123; <span class="attr">url</span>: <span class="variable language_">this</span>.<span class="property">userInfo</span>.<span class="property">staffPhoto</span>, <span class="attr">upload</span>: <span class="literal">true</span> &#125;]</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="2、更新图片时获取图片内容"><a href="#2、更新图片时获取图片内容" class="headerlink" title="2、更新图片时获取图片内容"></a>2、更新图片时获取图片内容</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span>  <span class="title function_">saveUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 去读取 员工上传的头像</span></span><br><span class="line">      <span class="keyword">const</span> fileList = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">staffPhoto</span>.<span class="property">fileList</span> <span class="comment">// 读取上传组件的数据</span></span><br><span class="line">      <span class="keyword">if</span> (fileList.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> !item.<span class="property">upload</span>)) &#123;</span><br><span class="line">        <span class="comment">//  如果此时去找 upload为false的图片 找到了说明 有图片还没有上传完成</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">&#x27;您当前还有图片没有上传完成！&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 通过合并 得到一个新对象</span></span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">saveUserDetailById</span>(&#123; ...<span class="variable language_">this</span>.<span class="property">userInfo</span>, <span class="attr">staffPhoto</span>: fileList &amp;&amp; fileList.<span class="property">length</span> ? fileList[<span class="number">0</span>].<span class="property">url</span> : <span class="string">&#x27;&#x27;</span> &#125;)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&#x27;保存基本信息成功&#x27;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-普通结构转化为树形结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/10/09/%E6%99%AE%E9%80%9A%E7%BB%93%E6%9E%84%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/"
    >两种方式将平铺数据转化为树形结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/10/09/%E6%99%AE%E9%80%9A%E7%BB%93%E6%9E%84%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-10-09T13:01:23.000Z" itemprop="datePublished">2022-10-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>有时候我们需要用到树形结构的数据便于我们展示像组织架构、地区这种有层级结构的信息。那么我们就需要将普通平铺的数据转化为树形结构的数据。主要是使用递归算法。</p>
<p>观察这种数据不难发现，每条数据一般至少包含 id 和 pid 两个属性，id 是每条数据独一无二的身份标识，pid 则表示与其他数据的从属关系。如果当前数据的 pid 等于另外一条数据的 id，那当前数据就是另外一条数据的子数据。</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200721010931214.png" alt="image-20200721010931214"></p>
<p>封装一个工具方法，**<code>src/utils/index.js</code>**</p>
<p>第一种：使用递归算法遍历需要处理的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  将列表型的数据转化成树形数据 =&gt; 递归算法 =&gt; 自身调用自身 =&gt; 递归的关键在于要有一个入口和一个出口，入口  	*  表示递归开始，出口则标识递归的结束。没有出口会造成死循环</span></span><br><span class="line"><span class="comment"> *  遍历树形 有一个重点 要先找一个头儿</span></span><br><span class="line"><span class="comment"> * ***/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">tranListToTreeData</span>(<span class="params">list, rootValue</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  list.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">pid</span> === rootValue) &#123;</span><br><span class="line">      <span class="comment">// 找到之后 就要去找 item 下面有没有子节点</span></span><br><span class="line">      <span class="keyword">const</span> children = <span class="title function_">tranListToTreeData</span>(list, item.<span class="property">id</span>);</span><br><span class="line">      <span class="keyword">if</span> (children.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果children的长度大于0 说明找到了子节点</span></span><br><span class="line">        item.<span class="property">children</span> = children;</span><br><span class="line">      &#125;</span><br><span class="line">      arr.<span class="title function_">push</span>(item); <span class="comment">// 将内容加入到数组中</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二种：上面的递归方式，每一次都需要遍历整个list，对于量特别大的数据来说，性能非常差，很大可能会造成卡死的情况。因此对于数据量比较大的情况（成千上万条数据），比如大型国企的人员组织架构，可以使用哈希表的方式实现树形数据的转化</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据量大时使用递归转化数据会有性能问题，可以使用哈希表优化</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">listToTree</span>(<span class="params">list, rootValue</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> map = &#123;&#125;,</span><br><span class="line">    node,</span><br><span class="line">    roots = [],</span><br><span class="line">    i</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; list.<span class="property">length</span>; i += <span class="number">1</span>) &#123;</span><br><span class="line">    map[list[i].<span class="property">org_id</span>] = i <span class="comment">// 初始化哈希表</span></span><br><span class="line">    list[i].<span class="property">children</span> = [] <span class="comment">// 初始化 children</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; list.<span class="property">length</span>; i += <span class="number">1</span>) &#123;</span><br><span class="line">    node = list[i]</span><br><span class="line">    <span class="keyword">if</span> (node.<span class="property">parent_org_id</span> !== rootValue) &#123;</span><br><span class="line">      <span class="comment">// 如果存在父级</span></span><br><span class="line">      <span class="keyword">if</span> (map[node.<span class="property">parent_org_id</span>] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        list[map[node.<span class="property">parent_org_id</span>]].<span class="property">children</span>.<span class="title function_">push</span>(node)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// else &#123;</span></span><br><span class="line">      <span class="comment">//   console.error(</span></span><br><span class="line">      <span class="comment">//     `Parent ID $&#123;node.parent_org_id&#125; not found for node ID $&#123;node.org_id&#125;`</span></span><br><span class="line">      <span class="comment">//   )</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果是顶级节点</span></span><br><span class="line">      roots.<span class="title function_">push</span>(node)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> roots</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-使用自定义指令解决图片异常情况"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/09/14/%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E8%A7%A3%E5%86%B3%E5%9B%BE%E7%89%87%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5/"
    >使用自定义指令解决图片异常情况</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/09/14/%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E8%A7%A3%E5%86%B3%E5%9B%BE%E7%89%87%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5/" class="article-date">
  <time datetime="2022-09-14T13:45:23.000Z" itemprop="datePublished">2022-09-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>项目中有时图片显示异常，我们可以使用自定义指令来指定默认图片</p>
<p>自定义指令可以采用统一的文件来管理 <strong><code>src/directives/index.js</code></strong>,这个文件负责管理所有的自定义指令</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 负责管理所有的自定义指令</span></span><br><span class="line"><span class="comment">// 只负责导出指令对象</span></span><br><span class="line"><span class="comment">// 变量名称就是指令名称</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> imageerror = &#123;</span><br><span class="line">  <span class="comment">// 指令内容</span></span><br><span class="line">  <span class="comment">// 指令作用在 图片上的 dom是图片对象</span></span><br><span class="line">  <span class="comment">// inserted 在Vue3中也改名 =&gt; mounted</span></span><br><span class="line">  <span class="title function_">inserted</span>(<span class="params">dom, options</span>) &#123;</span><br><span class="line">    <span class="comment">// inserted执行的之后 此时 并没有对 src赋值</span></span><br><span class="line">    <span class="comment">// 图片有地址 但是地址加载图片失败的时候 会执行一个函数  onerror</span></span><br><span class="line">    dom.<span class="property">src</span> = dom.<span class="property">src</span> || options.<span class="property">value</span>;</span><br><span class="line">    dom.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 监听onerror事件</span></span><br><span class="line">      <span class="comment">// options.value就是指令传过来的值</span></span><br><span class="line">      dom.<span class="property">src</span> = options.<span class="property">value</span>; <span class="comment">// 当图片异常的时候 接收指令传过来的值 让这个值作为头像的备选</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 只有src有值 并且加载失败才会触发onerror</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 此钩子会在给image赋值之后执行</span></span><br><span class="line">  <span class="comment">// 这个钩子函数在Vue3中改名了 =&gt; updated</span></span><br><span class="line">  <span class="title function_">componentUpdated</span>(<span class="params">dom, options</span>) &#123;</span><br><span class="line">    dom.<span class="property">src</span> = dom.<span class="property">src</span> || options.<span class="property">value</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在 main.js 完成自定义指令全局注册</p>
<p>如果自定义的指令较多，可以采用批量注册的方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> directives <span class="keyword">from</span> <span class="string">&quot;@/directives&quot;</span>;</span><br><span class="line"><span class="comment">// 注册自定义指令</span></span><br><span class="line"><span class="comment">// 遍历所有的导出的指令对象 完成自定义全局注册</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(directives).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 注册自定义指令</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">directive</span>(key, directives[key]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>指令注册成功后，可以在组件中直接使用了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;img v-imageerror=&quot;defaultImg&quot; :src=&quot;staffPhoto&quot; class=&quot;user-avatar&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      defaultImg: require(&quot;@/assets/common/head.jpg&quot;),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-token失效的处理"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/23/token%E5%A4%B1%E6%95%88%E7%9A%84%E5%A4%84%E7%90%86/"
    >token失效的处理</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/23/token%E5%A4%B1%E6%95%88%E7%9A%84%E5%A4%84%E7%90%86/" class="article-date">
  <time datetime="2022-08-23T09:26:23.000Z" itemprop="datePublished">2022-08-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="一、主动处理"><a href="#一、主动处理" class="headerlink" title="一、主动处理"></a>一、主动处理</h2><p>主动处理主要是前端在每次发起请求时都主动去检查一下 token 是否过期。流程图如下：</p>
<p>具体业务图如下</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200716231205153.png" alt="image-20200716231205153"></p>
<h3 id="流程图转化代码"><a href="#流程图转化代码" class="headerlink" title="流程图转化代码"></a>流程图转化代码</h3><p><strong>流程图转化代码</strong> <strong><code>src/utils/auth.js</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Cookies</span> <span class="keyword">from</span> <span class="string">&quot;js-cookie&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TokenKey</span> = <span class="string">&quot;hr-saas-111-token&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> timeKey = <span class="string">&quot;hr-sass-time-key&quot;</span>; <span class="comment">// 用来作为时间戳存储的key</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">get</span>(<span class="title class_">TokenKey</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">setToken</span>(<span class="params">token</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">set</span>(<span class="title class_">TokenKey</span>, token);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">removeToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">remove</span>(<span class="title class_">TokenKey</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">setTimeStamp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 设置当前最新的时间戳</span></span><br><span class="line">  <span class="comment">// Date.now()  new Date.getTime()</span></span><br><span class="line">  <span class="title class_">Cookies</span>.<span class="title function_">set</span>(timeKey, <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getTimeStamp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">get</span>(timeKey);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>src/utils/request.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Message</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-ui&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTimeStamp &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/auth&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TimeOut</span> = <span class="number">3600</span>; <span class="comment">// 定义超时时间</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">// 当执行 npm run dev  =&gt; .evn.development =&gt; /api =&gt; 跨域代理</span></span><br><span class="line">  <span class="attr">baseURL</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>, <span class="comment">// npm  run dev  =&gt; /api npm run build =&gt;  /prod-api</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>, <span class="comment">// 设置超时时间</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// config 是请求的配置信息</span></span><br><span class="line">    <span class="comment">// 注入token</span></span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">      <span class="comment">// 只有在有token的情况下 才有必要去检查时间戳是否超时</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">IsCheckTimeOut</span>()) &#123;</span><br><span class="line">        <span class="comment">// 如果它为true表示 过期了</span></span><br><span class="line">        <span class="comment">// token没用了 因为超时了</span></span><br><span class="line">        store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/logout&quot;</span>); <span class="comment">// 登出操作</span></span><br><span class="line">        <span class="comment">// 跳转到登录页</span></span><br><span class="line">        router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;token超时了&quot;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">      config.<span class="property">headers</span>[<span class="string">&quot;Authorization&quot;</span>] = <span class="string">`Bearer <span class="subst">$&#123;store.getters.token&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config; <span class="comment">// 必须要返回的</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// axios默认加了一层data</span></span><br><span class="line">    <span class="keyword">const</span> &#123; success, message, data &#125; = response.<span class="property">data</span>;</span><br><span class="line">    <span class="comment">//   要根据success的成功与否决定下面的操作</span></span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">      <span class="keyword">return</span> data;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 业务已经错误了 还能进then ? 不能 ！ 应该进catch</span></span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(message); <span class="comment">// 提示错误消息</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(message));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>); <span class="comment">// 提示错误信息</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error); <span class="comment">// 返回执行错误 让当前的执行链跳出成功 直接进入 catch</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// 是否超时</span></span><br><span class="line"><span class="comment">// 超时逻辑  (当前时间  - 缓存中的时间) 是否大于 时间差</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">IsCheckTimeOut</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> currentTime = <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// 当前时间戳</span></span><br><span class="line">  <span class="keyword">var</span> timeStamp = <span class="title function_">getTimeStamp</span>(); <span class="comment">// 缓存时间戳</span></span><br><span class="line">  <span class="keyword">return</span> (currentTime - timeStamp) / <span class="number">1000</span> &gt; <span class="title class_">TimeOut</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service;</span><br></pre></td></tr></table></figure>

<p>在登录的时候，如果登录成功，我们应该设置时间戳</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义login action  也需要参数 调用action时 传递过来的参数</span></span><br><span class="line"><span class="comment">// async 标记的函数其实就是一个异步函数 -&gt; 本质是还是 一个promise</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">context, data</span>) &#123;</span><br><span class="line">  <span class="comment">// 经过响应拦截器的处理之后 这里的result实际上就是 token</span></span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">login</span>(data) <span class="comment">// 实际上就是一个promise  result就是执行的结果</span></span><br><span class="line">  <span class="comment">// axios默认给数据加了一层data</span></span><br><span class="line">  <span class="comment">// 表示登录接口调用成功 也就是意味着你的用户名和密码是正确的</span></span><br><span class="line">  <span class="comment">// 现在有用户token</span></span><br><span class="line">  <span class="comment">// actions 修改state 必须通过mutations</span></span><br><span class="line">  context.<span class="title function_">commit</span>(<span class="string">&#x27;setToken&#x27;</span>, result)</span><br><span class="line">  <span class="comment">// 写入时间戳</span></span><br><span class="line">  <span class="title function_">setTimeStamp</span>() <span class="comment">// 将当前的最新时间写入缓存</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二、被动处理"><a href="#二、被动处理" class="headerlink" title="二、被动处理"></a>二、被动处理</h2><p>被动处理就是后端告诉我们超时了，我们按照后端接口做出反应即可。如果后端接口没有做处理，主动介入就是一种简单的方式</p>
<p>token 超时的错误码是**<code>10002</code>**</p>
<p><strong>代码实现</strong> <strong><code>src/utils/request.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(error) =&gt; &#123;</span><br><span class="line">  <span class="comment">// error 信息 里面 response的对象</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    error.<span class="property">response</span> &amp;&amp;</span><br><span class="line">    error.<span class="property">response</span>.<span class="property">data</span> &amp;&amp;</span><br><span class="line">    error.<span class="property">response</span>.<span class="property">data</span>.<span class="property">code</span> === <span class="number">10002</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="comment">// 当等于10002的时候 表示 后端告诉我token超时了</span></span><br><span class="line">    store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/logout&quot;</span>); <span class="comment">// 登出action 删除token</span></span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>); <span class="comment">// 提示错误信息</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>无论是主动介入还是被动处理，这些操作都是为了更好地处理 token，减少错误异常的可能性</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-AJAX"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/04/AJAX/"
    >AJAX</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/04/AJAX/" class="article-date">
  <time datetime="2022-05-04T10:14:49.000Z" itemprop="datePublished">2022-05-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="一、Ajax-基本介绍"><a href="#一、Ajax-基本介绍" class="headerlink" title="一、Ajax 基本介绍"></a>一、Ajax 基本介绍</h2><p>Ajax 的全称是 Asynchronous Javascript And XML（异步 JavaScript 和 XML）</p>
<p>通过 AJAX 可以在浏览器中向服务器发送异步请求，进行数据交互</p>
<p>最大的优势：无刷新获取数据</p>
<p>AJAX 的优点</p>
<ul>
<li>可以无需刷新页面而与服务器端进行通信（实现局部刷新）</li>
<li>允许根据用户事件来更新部分页面内容</li>
</ul>
<p>AJAX 的缺点</p>
<ul>
<li>没有浏览历史，不能回退</li>
<li>存在跨域问题(同源)</li>
<li>SEO 不友好</li>
</ul>
<p>Ajax 的典型应用场景</p>
<p>用户名检测：注册用户时，通过 ajax 的形式，动态检测用户名是否被占用</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504093210686.png" alt="image-20230504093210686"></p>
<p>搜索提示：当输入搜索关键字时，通过 ajax 的形式，动态加载搜索提示列 表<img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504093251279.png" alt="image-20230504093251279"></p>
<p>数据分页显示：当点击页码值的时候，通过 ajax 的形式，根据页码值动态 刷新表格的数据<img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504093331555.png" alt="image-20230504093331555"></p>
<p>数据的增删改查：数据的添加、删除、修改、查询操作，都需要通过 ajax 的 形式，来实现数据的交互<img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504093356633.png" alt="image-20230504093356633"></p>
<h3 id="1、XML"><a href="#1、XML" class="headerlink" title="1、XML"></a>1、XML</h3><p>XML 是一种可扩展标记语，被设计用来传输和存储数据。XML 和 HTML 类似，不同的是 HTML 中都是预定义标签，而 XML 中没有预定义标签， 全都是自定义标签，用来表示一些数据。</p>
<p>XML 格式臃肿，和数据无关的代码多，体积大，传输效率低。在 Javascript 中解析 XML 比较麻烦。现已被 JSON 代替</p>
<h3 id="2、JSON"><a href="#2、JSON" class="headerlink" title="2、JSON"></a>2、JSON</h3><p>JSON 的英文全称是 JavaScript Object Notation，即“JavaScript 对象。表示法”。简单来讲，JSON 就是 Javascript 对象和数组的字符串表示法，它使用文本表示一个 JS 对象或数组的信息，因此，JSON 的本质是字符</p>
<p>作用：JSON 是一种轻量级的文本数据交换格式，在作用上类似于 XML，专 门用于存储和传输数据，但是 JSON 比 XML 更小、更快、更易解析 现状：JSON 是在 2001 年开始被推广和使用的数据格式，到现今为止，JSON 已经成为了主流的数据交换格式</p>
<p>JSON 的两种结构</p>
<p>JSON 就是用字符串来表示 Javascript 的对象和数组。所以，JSON 中包含 对象和数组两种结构，通过这两种结构的相互嵌套，可以表示各种复杂的数据结构</p>
<p>对象结构：对象结构在 JSON 中表示为 { } 括起来的内容。数据结构为 { key: value, key: value, … } 的键值对结构。其中，key 必须是使用英文 的双引号包裹的字符串，value 的数据类型可以是数字、字符串、布尔值、null、 数组、对象 6 种类型</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504092616262.png" alt="image-20230504092616262"></p>
<p>数组结构：数组结构在 JSON 中表示为 [ ] 括起来的内容。数据结构为 [ “java”, “javascript”, 30, true … ] 。数组中数据的类型同样可以是数字、 字符串、布尔值、null、数组、对象 6 种类型</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504092646601.png" alt="image-20230504092646601"></p>
<p>JSON 语法注意事项</p>
<ul>
<li>属性名必须使用双引号包裹</li>
<li>字符串类型的值必须使用双引号包裹</li>
<li>JSON 中不允许使用单引号表示字符串</li>
<li>JSON 中不能写注释</li>
<li>JSON 的最外层必须是对象或数组格式</li>
<li>不能使用 undefined 或函数作为 JSON 的值</li>
</ul>
<p>JSON 和 JS 对象的关系</p>
<p>JSON 是 JS 对象的字符串表示法，它使用文本表示一个 JS 对象的信息， 本质是一个字符串</p>
<p>JSON 和 JS 对象的互转</p>
<p>可以使用 JSON.parse()和 JSON.stringify()方法</p>
<h2 id="二、AJAX-的使用"><a href="#二、AJAX-的使用" class="headerlink" title="二、AJAX 的使用"></a>二、AJAX 的使用</h2><p>核心对象</p>
<p>XMLHttpRequest，AJAX 的所有操作都是通过该对象进行的</p>
<p>使用步骤</p>
<ol>
<li>创建 XMLHttpRequest 对象</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure>

<p>2.设置请求信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(method, url);</span><br><span class="line"><span class="comment">//可以设置请求头，一般不设置</span></span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>发送请求</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">send</span>(body); <span class="comment">//get 请求不传 body 参数，只有 post 请求</span></span><br></pre></td></tr></table></figure>

<p>4.接收响应</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//xhr.responseXML 接收 xml 格式的响应数据</span></span><br><span class="line"><span class="comment">//xhr.responseText 接收文本格式的响应数据</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> text = xhr.<span class="property">responseText</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(text);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>xhr.readyState 可以用来查看请求当前的状态</p>
<p>0: 表示 XMLHttpRequest 实例已经生成，但是 open()方法还没有被调用。</p>
<p>1: 表示 send()方法还没有被调用，仍然可以使用 setRequestHeader()，设定 HTTP 请求的头信息</p>
<p>2: 表示 send()方法已经执行，并且头信息和状态码已经收到。</p>
<p>3: 表示正在接收服务器传来的 body</p>
<p>4: 表示服务器数据已经完全接收，或者本次接收已经失败了</p>
<p>使用 xhr 对象发起带参数的 GET 请求时，只需在调用 xhr.open 期间，为 URL 地址指定参数即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(&#x27;GET&#x27;,&#x27;http://congtf.top/tags?id=1&amp;title=技术&#x27;)</span><br></pre></td></tr></table></figure>

<p>这种在 URL 地址后面拼接的参数，叫做查询字符串</p>
<p>GET 请求携带参数的本质</p>
<p>无论使用 $.ajax()，还是使用 $.get()，又或者直接使用 xhr 对象发起 GET 请求，当需要携带参数的时候，本质上，都是直接将参数以查询字符串的形 式，追加到 URL 地址的后面，发送到服务器的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">get</span>(url, &#123; <span class="attr">name</span>: <span class="string">&quot;zs&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line">$.<span class="title function_">get</span>(url + <span class="string">&quot;?name=zs&amp;age=20&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="三、XMLHttpRequest-Level2-的新特性"><a href="#三、XMLHttpRequest-Level2-的新特性" class="headerlink" title="三、XMLHttpRequest Level2 的新特性"></a>三、XMLHttpRequest Level2 的新特性</h2><p>旧版 XMLHttpRequest 的缺点：</p>
<ul>
<li>只支持文本数据的传输，无法用来读取和上传文件</li>
<li>传送和接收数据时，没有进度信息，只能提示有没有完成</li>
</ul>
<p>XMLHttpRequest Level2 的新功能</p>
<ul>
<li>可以设置 HTTP 请求的时限</li>
<li>可以使用 FormData</li>
<li>可以上传文件</li>
<li>可以获得数据传输的进度信息</li>
</ul>
<h3 id="1、设置-HTTP-请求时限"><a href="#1、设置-HTTP-请求时限" class="headerlink" title="1、设置 HTTP 请求时限"></a>1、设置 HTTP 请求时限</h3><p>有时，Ajax 操作很耗时，而且无法预知要花多少时间。如果网速很慢，用户可能要等很久。新版本的 XMLHttpRequest 对象，增加了 timeout 属性，可 以设置 HTTP 请求的时限：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">timeout</span> = <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>

<p>上面的语句，将最长等待时间设为 3000 毫秒。过了这个时限，就自动停止 HTTP 请求。与之配套的还有一个 timeout 事件，用来指定回调函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">ontimeout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;请求超时&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="2、FormData-对象管理表单数据"><a href="#2、FormData-对象管理表单数据" class="headerlink" title="2、FormData 对象管理表单数据"></a>2、FormData 对象管理表单数据</h3><p>Ajax 操作往往用来提交表单数据。为了方便表单处理，HTML5 新增了一个 FormData 对象，可以模拟表单操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.新建FormData对象</span></span><br><span class="line"><span class="keyword">const</span> fd = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line"><span class="comment">// 2.为FormData添加表单项</span></span><br><span class="line">fd.<span class="title function_">append</span>(<span class="string">&quot;uname&quot;</span>, <span class="string">&quot;zs&quot;</span>);</span><br><span class="line">fd.<span class="title function_">append</span>(<span class="string">&quot;upwd&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line"><span class="comment">// 3.创建XHR对象</span></span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="comment">// 4.发请求</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://congtf.top&quot;</span>);</span><br><span class="line"><span class="comment">// 5.直接提交FormData对象，这与提交网页表单效果完全一样</span></span><br><span class="line">xhr.<span class="title function_">send</span>(fd);</span><br></pre></td></tr></table></figure>

<p>FormData 对象也可以用来获取网页表单的值，示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取表单元素</span></span><br><span class="line"><span class="keyword">const</span> form = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#form1&quot;</span>);</span><br><span class="line"><span class="comment">// 监听表单元素的submit事件</span></span><br><span class="line">form.<span class="title function_">addEventListener</span>(<span class="string">&quot;submit&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  <span class="comment">// 根据form表单创建FormData对象，会自动将表单数据填充到FormData对象中</span></span><br><span class="line">  <span class="keyword">const</span> fd = <span class="keyword">new</span> <span class="title class_">FormData</span>(form);</span><br><span class="line">  <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://congtf.top&quot;</span>);</span><br><span class="line">  xhr.<span class="title function_">send</span>(fd);</span><br><span class="line">  xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3、上传文件"><a href="#3、上传文件" class="headerlink" title="3、上传文件"></a>3、上传文件</h3><p>新版 XMLHttpRequest 对象，不仅可以发送文本信息，还可以上传文件</p>
<p>实现步骤</p>
<ol>
<li><p>定义 UI 结构</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件选择框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file1&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 上传按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btnUpload&quot;</span>&gt;</span>上传文件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 显示上传到服务器上的图片 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;img&quot;</span> <span class="attr">width</span>=<span class="string">&quot;800&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证是否选择了文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btnUpload = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#btnUpload&quot;</span>);</span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> files = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#file1&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (files.<span class="property">length</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">alert</span>(<span class="string">&quot;请选择要上传的文件！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 创建FormData对象</span></span><br><span class="line">  <span class="keyword">const</span> fd = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">  <span class="comment">// 追加文件</span></span><br><span class="line">  fd.<span class="title function_">append</span>(<span class="string">&quot;avatar&quot;</span>, files[<span class="number">0</span>]);</span><br><span class="line">  <span class="comment">// 创建xhr对象</span></span><br><span class="line">  <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  <span class="comment">// 发请求</span></span><br><span class="line">  xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://congtf.top&quot;</span>);</span><br><span class="line">  xhr.<span class="title function_">send</span>(fd);</span><br><span class="line">  xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">state</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">      <span class="keyword">if</span> (data.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">// 将服务器返回的图片地址设置为img标签的src属性</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#img&quot;</span>).<span class="property">src</span> = <span class="string">&quot;http://congtf.top&quot;</span> + data.<span class="property">url</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 文件上传失败</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data.message&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>向 FormData 中追加文件</p>
</li>
<li><p>使用 xhr 发起上传文件的请求</p>
</li>
<li><p>监听 onreadystatechange 事件</p>
</li>
</ol>
<h3 id="4、显示文件上传进度"><a href="#4、显示文件上传进度" class="headerlink" title="4、显示文件上传进度"></a>4、显示文件上传进度</h3><p>新版本的 XMLHttpRequest 对象中，可以通过监听 xhr.upload.onprogress 事件，来获取到文件的上传进度。语法格式如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="comment">// 监听xhr.upload的onprogress事件</span></span><br><span class="line">xhr.<span class="property">upload</span>.<span class="property">onprogress</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// e.lengthComputable是一个布尔值，表示当前上传的资源是否具有可计算的长度</span></span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">lengthComputable</span>) &#123;</span><br><span class="line">    <span class="comment">// e.loaded 表示已传输的字节</span></span><br><span class="line">    <span class="comment">// e.total 表示需要传输的总字节</span></span><br><span class="line">    <span class="keyword">const</span> percentComplete = <span class="title class_">Math</span>.<span class="title function_">ceil</span>((e.<span class="property">loaded</span> / e.<span class="property">total</span>) * <span class="number">100</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="四、axios"><a href="#四、axios" class="headerlink" title="四、axios"></a>四、axios</h2><p>axios 是专注于网络数据请求的库</p>
<p>相比于原生的 XMLHttpRequest 对象，axios 简单易用</p>
<p>相比于 jQuery，axios 更加轻量化，只专注于网络数据请求</p>
<p>axios 发起 GET 请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .<span class="title function_">get</span>(url, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="comment">/*参数*/</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(callback);</span><br></pre></td></tr></table></figure>

<p>示例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> paramsObj = &#123; <span class="attr">name</span>: <span class="string">&quot;zs&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;;</span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;http:congtf.top&quot;</span>, &#123; <span class="attr">params</span>: paramsObj &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">  <span class="comment">// axios默认包了一层data，res.data才是服务器返回的数据</span></span><br><span class="line">  <span class="keyword">const</span> result = res.<span class="property">data</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>axios 发起 POST 请求示例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dataObj = &#123; <span class="attr">name</span>: <span class="string">&quot;zs&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;;</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&quot;http:congtf.top&quot;</span>, dataObj).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">  <span class="comment">// axios默认包了一层data，res.data才是服务器返回的数据</span></span><br><span class="line">  <span class="keyword">const</span> result = res.<span class="property">data</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>直接使用 axios 发起请求:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;请求类型&quot;</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;请求的url地址&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="comment">/*POST数据*/</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    <span class="comment">/*GET参数*/</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;).<span class="title function_">then</span>(callback);</span><br></pre></td></tr></table></figure>

<h2 id="五、同源与跨域、防抖与节流"><a href="#五、同源与跨域、防抖与节流" class="headerlink" title="五、同源与跨域、防抖与节流"></a>五、同源与跨域、防抖与节流</h2><h3 id="1、同源策略"><a href="#1、同源策略" class="headerlink" title="1、同源策略"></a>1、同源策略</h3><p>如果两个页面的协议，域名和端口都相同，则两个页面具有相同的源</p>
<p>例如，下表给出了相对于 <a target="_blank" rel="noopener" href="http://www.test.com/index.html">http://www.test.com/index.html</a> （没写端口号默认 是 80）页面的同源检测</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504104555104.png" alt="image-20230504104555104"></p>
<p>同源策略（英文全称 Same origin policy）是浏览器提供的一个安全功能 MDN 官方给定的概念：同源策略限制了从同一个源加载的文档或脚本如何与来自 另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的重要安全机制</p>
<p>通俗的理解：浏览器规定，A 网站的 JavaScript 不允许和非同源的网站 C 之间进行资源的交互，例如：</p>
<ol>
<li>无法读取非同源网页的 Cookie、LocalStorage 和 IndexedDB</li>
<li>无法接触非同源网页的 DOM</li>
<li>无法向非同源地址发送 Ajax 请求</li>
</ol>
<p>同源指的是两个 URL 的协议、域名、端口一致，反之，则是跨域</p>
<p>出现跨域的根本原因：浏览器的同源策略不允许非同源的 URL 之间进行资源的交互</p>
<p>浏览器对跨域请求的拦截</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504105321422.png" alt="image-20230504105321422"></p>
<p>注意：浏览器允许发起跨域请求，但是，跨域请求回来的数据，会被浏览器 拦截，无法被页面获取到！</p>
<p>如何实现跨域数据请求</p>
<h3 id="2、JSONP"><a href="#2、JSONP" class="headerlink" title="2、JSONP"></a>2、JSONP</h3><p>出现的早，兼容性好（兼容低版本 IE）。是前端程序员为了解决跨域问题， 被迫想出来的一种临时解决方案。缺点是只支持 GET 请求，不支持 POST 请求。</p>
<p>JSONP (JSON with Padding) 是 JSON 的一种“使用模式”，可用于解决主流浏览器的跨域数据访问的问题。</p>
<p>JSONP 的实现原理</p>
<p>由于浏览器同源策略的限制，网页中无法通过 Ajax 请求非同源的接口数据。 但是在网页中有一些标签天生具有跨域能力，比如：img link iframe script。因此，JSONP 的实现原理，就是通过 script 标签的 src 属性，请求跨<br>域的数据接口，并通过函数调用的形式，接收跨域接口响应回来的数据。</p>
<p>JSONP 的使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态的创建一个script标签</span></span><br><span class="line"><span class="keyword">const</span> script <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line"><span class="comment">// 设置script的src，设置回调函数</span></span><br><span class="line">script.<span class="property">src</span>=<span class="string">&#x27;http://loacalhost:3000/testAJAX?callback=abc&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">abc</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(data.<span class="property">name</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将script添加到body中</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script)</span><br><span class="line"><span class="comment">// 服务器中路由的处理</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/testAJAX&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;收到请求&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> callback = req.<span class="property">query</span>.<span class="property">callback</span></span><br><span class="line">  <span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">20</span></span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(callback+<span class="string">&quot;(&quot;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringfy</span>(obj)+<span class="string">&quot;)&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3、CORS"><a href="#3、CORS" class="headerlink" title="3、CORS"></a>3、CORS</h3><p>CORS（Cross-Origin Resource Sharing），跨域资源共享。CORS 是官方的跨域解决方 案，它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理，支持 get 和 post 请求。跨域资源共享标准新增了一组 HTTP 首部字段，允许服务器声明哪些 源站通过浏览器有权限访问哪些资源</p>
<p>CORS 怎么工作的？</p>
<p>CORS 是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应 以后就会对响应放行</p>
<p>CORS 的使用</p>
<p>主要是服务器端的设置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/testAJAX&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// res.set(&quot;Access-Control-Allow-Origin&quot;,&quot;http://127.0.0.1:3000&quot;)</span></span><br><span class="line">  res.<span class="title function_">set</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;返回的相应&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="4、防抖"><a href="#4、防抖" class="headerlink" title="4、防抖"></a>4、防抖</h3><p>防抖策略（debounce）是当事件被触发后，延迟 n 秒后再执行回调，如果 在这 n 秒内事件又被触发，则重新计时</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230504111044196.png" alt="image-20230504111044196"></p>
<p>防抖的应用场景</p>
<p>用户在输入框中连续输入一串字符时，可以通过防抖策略，只在输入完后， 才执行查询的请求，这样可以有效减少请求次数，节约请求资源</p>
<p>防抖的基本原理是在一定时间内，将多次触发的函数调用合并为一次调用执行。当用户连续触发事件时，防抖函数会清空之前设定的定时器，并重新设定一个新的定时器来延迟函数的执行。只有当用户停止操作后，在设定的时间内没有再次触发事件，则函数才会被真正地执行一次</p>
<p>实现一个基本的防抖函数步骤如下：</p>
<ol>
<li>在函数外部设置一个计时器变量（例如 timeoutId）和函数执行的延迟时间（例如 delay）</li>
<li>当函数被触发时，清除之前设定的计时器</li>
<li>重新设定一个计时器，并用它来延迟函数的执行</li>
<li>如果在设定的延迟时间内再次触发了函数，则回到步骤 2</li>
<li>如果在设定的延迟时间内没有再次触发函数，计时器会触发执行原始函数</li>
</ol>
<p>以下是一个基本的防抖函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, delay</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeoutId;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> context = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">const</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">    timeoutId = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该函数接受两个参数：要执行的函数以及防抖延迟时间。它返回一个新函数，该函数会在防抖延迟时间内被多次调用时只执行一次原始函数</p>
<h3 id="5、节流"><a href="#5、节流" class="headerlink" title="5、节流"></a>5、节流</h3><p>节流策略（throttle），顾名思义，可以减少一段时间内事件的触发频率。</p>
<p>节流的应用场景</p>
<ol>
<li>鼠标连续不断地触发某事件（如点击），只在单位时间内只触发一次</li>
<li>懒加载时要监听计算滚动条的位置，但不必每次滑动都触发，可以降低计算 的频率，而不必去浪费 CPU 资源</li>
</ol>
<p>节流阀的概念</p>
<p>高铁卫生间是否被占用，由红绿灯控制，红灯表示被占用，绿灯表示可使用</p>
<p>假设每个人上卫生间都需要花费 5 分钟，则五分钟之内，被占用的卫生间无法被 其他人使用</p>
<p>上一个人使用完毕后，需要将红灯重置为绿灯，表示下一个人可以使用卫生 间</p>
<p>下一个人在上卫生间之前，需要先判断控制灯是否为绿色，来知晓能否上卫 生间</p>
<p>类似的</p>
<p>节流阀为空，表示可以执行下次操作；不为空，表示不能执行下次操作</p>
<p>当前操作执行完，必须将节流阀重置为空，表示可以执行下次操作了</p>
<p>每次执行操作前，必须先判断节流阀是否为空</p>
<p>一个基本的节流函数示例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func, delay</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> last = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> now = +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (now - last &lt; delay) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    last = now;</span><br><span class="line">    func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结防抖和节流的区别</p>
<p>防抖：如果事件被频繁触发，防抖能保证只有最有一次触发生效！前面 N 多 次的触发都会被忽略！当事件被触发时，函数在固定时间间隔内不被执行，只有事件停止触发后，函数才会执行一次。适用于处理一些不需要连续响应的事件（如输入框输入、按钮点击等），可以避免函数被频繁调用，提高性能和稳定性。</p>
<p>节流：如果事件被频繁触发，节流能够减少事件触发的频率，因此，节流是 有选择性地执行一部分事件！当事件被触发时，函数在固定时间间隔内最多只执行一次。适用于高频率事件（如滚动、窗口调整等），可以防止函数被频繁调用，减少不必要的计算，提高性能和响应速度</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-前端学习路线"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/27/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"
    >前端学习路线</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/27/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" class="article-date">
  <time datetime="2022-03-27T11:07:19.000Z" itemprop="datePublished">2022-03-27</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>本篇文章列出我的前端学习路线，当然后面有很多其实我还没有掌握。前面的知识当入门后面的知识当进阶吧。我也计划将此路线当做一个题纲，后期会将每一块知识展开后形成单独文章。</p>
<h2 id="一、前端入门"><a href="#一、前端入门" class="headerlink" title="一、前端入门"></a>一、前端入门</h2><h3 id="1、HTML"><a href="#1、HTML" class="headerlink" title="1、HTML"></a>1、HTML</h3><p>描述：用于定义一个网页结构的基本技术</p>
<p>各种标签：</p>
<ul>
<li><p>h 系列标签</p>
</li>
<li><p>p 标签</p>
</li>
<li><p>换行标签<br></p>
</li>
<li><p>水平分割线标签<hr></p>
</li>
<li><p>文本格式化标签（加粗标签 b 和 strong、下划线标签 u 和 ins、倾斜标签 i 和 em、删除线 s 和 del）</p>
</li>
<li><p>图片标签 img</p>
</li>
<li><p>音频标签 audio</p>
</li>
<li><p>视频标签 video</p>
</li>
<li><p>a 链接标签</p>
</li>
<li><p>无序列表标签 ul 搭配 li</p>
</li>
<li><p>有序列表标签 ol 搭配 li</p>
</li>
<li><p>自定义列表标签 dl 搭配 dt 和 dd</p>
</li>
<li><p>表格标签 table 搭配 tr、th、td 等</p>
</li>
<li><p>表单标签 input 系列、button、select、textarea、label 等</p>
</li>
</ul>
<p>标签语义化</p>
<p>HTML5 特性：</p>
<ul>
<li>语义化标签</li>
<li>浏览器支持</li>
<li>多媒体标签</li>
<li>Canvas 画布</li>
<li>本地存储<ul>
<li>localStorage</li>
<li>sessionStorage</li>
</ul>
</li>
<li>Web Workers</li>
<li>应用缓存（Cache Manifest）</li>
<li>无障碍</li>
</ul>
<h3 id="2、CSS"><a href="#2、CSS" class="headerlink" title="2、CSS"></a>2、CSS</h3><p>描述：层叠样式表，用于设计风格和布局</p>
<p>引入方式：内嵌式、外联式、行内式</p>
<p>基础选择器：</p>
<ul>
<li>标签选择器</li>
<li>类选择器</li>
<li>id 选择器</li>
<li>通配符选择器</li>
</ul>
<p>复合选择器：</p>
<ul>
<li><p>后代选择器</p>
</li>
<li><p>子代选择器</p>
</li>
<li><p>并集选择器</p>
</li>
<li><p>交集选择器</p>
</li>
<li><p>伪类选择器</p>
</li>
</ul>
<p>字体和文本样式：</p>
<ul>
<li>font-size</li>
<li>font-weight</li>
<li>font-style</li>
<li>font-family</li>
<li>text-indent</li>
<li>text-align</li>
<li>text-decoration</li>
<li>line-height</li>
</ul>
<p>背景相关样式</p>
<ul>
<li><p>background-color</p>
</li>
<li><p>background-image</p>
</li>
<li><p>background-repeat</p>
</li>
<li><p>background-position</p>
</li>
<li><p>background-size</p>
</li>
</ul>
<p>元素显示模式：块级元素、行内元素、行内块元素</p>
<p>CSS 特性：继承性、层叠性、优先级</p>
<p>文档流</p>
<ul>
<li>标准流</li>
<li>浮动流</li>
<li>定位流</li>
</ul>
<p>伪元素</p>
<p>浮动：浮动和清除浮动、BFC 机制</p>
<p>定位：静态定位、相对定位、绝对定位、子绝父相、固定定位</p>
<p>其他：对齐方式问题 vertical-align、光标类型 cursor、边框圆角 border-radius、溢出部分显示效果、元素隐藏、元素透明度、边框合并、精灵图、字体图标、文字阴影 text-shadow、盒子阴影 box-shadow、过渡、图片模糊处理 filter:blur()、SEO 优化、网站 icon 图标、CSS 书写规范</p>
<p>平面转换（2D）：位移、旋转、缩放</p>
<p>渐变</p>
<p>空间转换（3D）：位移、透视、旋转、立体呈现、缩放</p>
<p>动画</p>
<p>移动端适配：屏幕尺寸和分辨率、百分比布局（流式布局）、Flex 布局（弹性布局）、媒体查询</p>
<h3 id="3、JavaScript"><a href="#3、JavaScript" class="headerlink" title="3、JavaScript"></a>3、JavaScript</h3><p>描述：具有函数优先的轻量级，解释型或即时编译型的编程语言。</p>
<p>JavaScript 组成：</p>
<ul>
<li><p>ECMAScript：规定了 js 基础语法</p>
</li>
<li><p>Web APIs：JavaScript 暴露的一些接口，用于操作文档和浏览器</p>
</li>
</ul>
<p>数据类型</p>
<ul>
<li>值类型<ul>
<li>字符串 String</li>
<li>数组 Number</li>
<li>布尔 Boolean</li>
<li>空值 Null</li>
<li>未定义 Undefined</li>
<li>Symbol</li>
</ul>
</li>
<li>引用类型<ul>
<li>对象 Object</li>
<li>数组 Array</li>
<li>函数 Function</li>
</ul>
</li>
</ul>
<p>数据类型转换：显式转换、隐式转换</p>
<p>运算符：算术运算符、赋值运算符、一元运算符、比较运算符、逻辑运算符</p>
<p>流程控制语句：</p>
<ul>
<li><p>分支语句：if 分支语句、三元运算符、switch 语句</p>
</li>
<li><p>循环语句：while 循环、for 循环</p>
</li>
</ul>
<p>函数：匿名函数（函数表达式）、函数调用、函数传参</p>
<p>对象：内置对象</p>
<p>DOM 操作：DOM 树、DOM 对象、设置修改 DOM 元素内容、属性、样式、定时器-间歇函数、事件、回调函数、高阶函数、环境对象 this、事件对象 e、节点操作（查找、增加、删除）、事件委托、重绘回流、滚动事件、加载事件</p>
<p>BOM 操作：window 对象、定时器-延时函数、location 对象、navigator 对象、histroy 对象、本地存储、正则表达式</p>
<p>ES6：不再说了，阮一峰老师都讲到了。ES6 入门教程 <a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/">https://es6.ruanyifeng.com/</a></p>
<h2 id="二、AJAX"><a href="#二、AJAX" class="headerlink" title="二、AJAX"></a>二、AJAX</h2><p>XMLHttpRequest、axios</p>
<p>http 基础知识：浏览器的同源策略、跨域及如何解决跨域、URL、防抖、节流、http 协议</p>
<h2 id="三、git-和-github"><a href="#三、git-和-github" class="headerlink" title="三、git 和 github"></a>三、git 和 github</h2><p>使用版本控制软件，将代码托管到远程仓库</p>
<h2 id="四、Node-js"><a href="#四、Node-js" class="headerlink" title="四、Node.js"></a>四、Node.js</h2><p>这个我还没有系统的学过，也列出来以后学习</p>
<h2 id="五、框架前置"><a href="#五、框架前置" class="headerlink" title="五、框架前置"></a>五、框架前置</h2><p>ES6 的模块化：导入导出</p>
<p>Promise：回调地狱、.then、.catch、async&#x2F;await</p>
<p>事件循环 EventLoop</p>
<h2 id="六、前端工程化"><a href="#六、前端工程化" class="headerlink" title="六、前端工程化"></a>六、前端工程化</h2><p>Vue2 框架</p>
<p>Vue 的几大板块：声明式渲染、组件系统、客户端路由、大规模状态管理、构建工具</p>
<p>Vue 基础语法：</p>
<ul>
<li>插值表达式</li>
<li>MVVM 设计模式</li>
<li>v-bind</li>
<li>v-on</li>
<li>v-model</li>
<li>v-text 和 v-html</li>
<li>v-show 和 v-if</li>
<li>v-for</li>
<li>虚拟 dom 和 diff 算法</li>
<li>动态 class 和动态 style</li>
<li>过滤器</li>
<li>计算属性</li>
<li>侦听器 watch</li>
</ul>
<p>Vue 组件：</p>
<ul>
<li>组件通信</li>
<li>Vue 生命周期与钩子函数</li>
<li>$refs和$nextTick</li>
<li>动态组件与组件缓存 keep-alive</li>
<li>组件插槽（默认插槽、具名插槽、作用域插槽）</li>
</ul>
<p>Vue 路由系统：</p>
<ul>
<li>声明式导航</li>
<li>编程式导航</li>
<li>重定向与路由模式</li>
<li>路由嵌套和路由守卫</li>
</ul>
<p>Vuex：</p>
<ul>
<li>state</li>
<li>mutations</li>
<li>actions</li>
<li>getters</li>
<li>vuex 模块化</li>
</ul>
<p>CSS 预编译：</p>
<ul>
<li>LESS</li>
<li>SASS</li>
</ul>
<p>开发框架：</p>
<ul>
<li>Express</li>
<li>Koa</li>
<li>Egg</li>
</ul>
<p>组件库</p>
<ul>
<li>ElementUI（Vue）</li>
<li>VantUI（Vue）</li>
</ul>
<p>数据可视化</p>
<ul>
<li>Apache ECharts（echarts）</li>
<li>HighCharts</li>
</ul>
<p>数据 Mock</p>
<ul>
<li>描述：通过随机数据，模拟各种场景，增加单元测试的真实性。</li>
<li>Mock.js</li>
</ul>
<p>代码检查：</p>
<ul>
<li>ESLint</li>
<li>StyleLint</li>
</ul>
<p>代码风格：</p>
<ul>
<li>Prettier</li>
</ul>
<p>包管理工具：</p>
<ul>
<li>npm</li>
<li>yarn</li>
</ul>
<p>打包工具：</p>
<ul>
<li>Webpack</li>
<li>Vite</li>
</ul>
<p>部署</p>
<p>Web 服务器</p>
<p>Nginx</p>
<ul>
<li>描述：高性能的 HTTP 和反向代理 web 服务器。</li>
<li>资源：腾讯云动手实验室 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/labs/gallery">https://cloud.tencent.com/developer/labs/gallery</a></li>
<li>反向代理</li>
<li>解决跨域</li>
<li>改写请求</li>
</ul>
<p>Apache</p>
<p>容器</p>
<p><strong>Docker</strong></p>
<ul>
<li>描述：容器是一个标准化的软件单元，它将代码及其所有依赖关系打包，以便应用程序从一个计算环境可靠快速地运行到另一个计算环境。Docker 容器镜像是一个轻量的独立的可执行的软件包。包含程序运行的时候所需的一切：代码，运行时间，系统工具，系统库和设置。</li>
<li>资源：Docker 从入门到实践 <a target="_blank" rel="noopener" href="https://vuepress.mirror.docker-practice.com/">https://vuepress.mirror.docker-practice.com/</a></li>
<li>Dockerfile</li>
</ul>
<h2 id="七、性能优化"><a href="#七、性能优化" class="headerlink" title="七、性能优化"></a>七、性能优化</h2><ul>
<li>路由懒加载</li>
<li>组件懒加载</li>
<li>JS 异步加载</li>
<li>Tree shaking</li>
<li>骨架屏</li>
<li>分页加载</li>
<li>长列表虚拟滚动</li>
<li>Web Worker 优化长任务</li>
<li>图片优化（动态裁剪、懒加载、图片压缩、使用字体图标、图片转 base64 格式）</li>
<li>CDN 分发</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023-2024
        <i class="ri-heart-fill heart_icon"></i> congtianfeng
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="hasCat"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%8A%80%E6%9C%AF">技术</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=541326593&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>