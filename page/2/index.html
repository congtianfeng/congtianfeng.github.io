<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="å‰ç«¯ã€ç¨‹åºå‘˜ã€ç¼–ç¨‹ã€ä»£ç " />
       
      <meta name="description" content="è®°å½•å‰ç«¯çŸ¥è¯†å­¦ä¹ ï¼Œç»éªŒç§¯ç´¯ï¼Œè®°å½•ç”Ÿæ´»" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> hasCat</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="hasCat" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/congtianfeng"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="[object Object]" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">hasCat</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['é¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€', 'æ„¿ä½ ä¸€ç”ŸåŠªåŠ›ï¼Œä¸€ç”Ÿè¢«çˆ±', 'æƒ³è¦çš„éƒ½æ‹¥æœ‰ï¼Œå¾—ä¸åˆ°çš„éƒ½é‡Šæ€€'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-å®ç°å›¾ç‰‡ä¸Šä¼ é¢„è§ˆå’Œè£åˆ‡åŠŸèƒ½"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/02/%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E9%A2%84%E8%A7%88%E5%92%8C%E8%A3%81%E5%88%87%E5%8A%9F%E8%83%BD/"
    >å®ç°å›¾ç‰‡ä¸Šä¼ é¢„è§ˆå’Œè£åˆ‡åŠŸèƒ½</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/02/%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E9%A2%84%E8%A7%88%E5%92%8C%E8%A3%81%E5%88%87%E5%8A%9F%E8%83%BD/" class="article-date">
  <time datetime="2023-04-02T08:33:12.000Z" itemprop="datePublished">2023-04-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="ä¸€ã€çº¯å®¢æˆ·ç«¯å®ç°ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ"><a href="#ä¸€ã€çº¯å®¢æˆ·ç«¯å®ç°ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ" class="headerlink" title="ä¸€ã€çº¯å®¢æˆ·ç«¯å®ç°ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ"></a>ä¸€ã€çº¯å®¢æˆ·ç«¯å®ç°ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å®¢æˆ·ç«¯å›¾ç‰‡ä¸Šä¼ é¢„è§ˆç¤ºä¾‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.img-wrap</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">max-width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>å®¢æˆ·ç«¯å›¾ç‰‡ä¸Šä¼ é¢„è§ˆç¤ºä¾‹<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img-wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;img&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;button&gt;å¤´åƒ&lt;/button&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">hidden</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;onFileChange()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> img = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#img&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> file = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#file&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// const btn = document.querySelector(&quot;button&quot;);</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// const ipt = document.querySelector(&quot;input&quot;);</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">onFileChange</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å¾—åˆ° file-input çš„æ–‡ä»¶å¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> fileObj = file.<span class="property">files</span>[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> data = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(fileObj);</span></span><br><span class="line"><span class="language-javascript">        img.<span class="property">src</span> = data;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// btn.addEventListener(&quot;click&quot;, () =&gt; ipt.click());</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è€Œåœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œfile ç±»å‹çš„ input æ¡†åŸºæœ¬ä¸Šéƒ½æ˜¯éšè—çš„ï¼Œé€šè¿‡å¦å¤–ä¸€ä¸ªæ˜¾ç¤ºçš„å…ƒç´ çš„æŸäº›äº‹ä»¶ï¼ˆæ¯”å¦‚ç‚¹å‡»äº‹ä»¶ï¼‰ä»¥ä»£ç çš„æ–¹å¼æ‰‹åŠ¨è§¦å‘ input çš„ç‚¹å‡»äº‹ä»¶ã€‚ä¹Ÿå°±æ˜¯æ³¨é‡Šéƒ¨åˆ†ã€‚</p>
<h2 id="äºŒã€å›¾ç‰‡è£åˆ‡"><a href="#äºŒã€å›¾ç‰‡è£åˆ‡" class="headerlink" title="äºŒã€å›¾ç‰‡è£åˆ‡"></a>äºŒã€å›¾ç‰‡è£åˆ‡</h2><h3 id="1ã€å®‰è£…-cropperjs-æ’ä»¶"><a href="#1ã€å®‰è£…-cropperjs-æ’ä»¶" class="headerlink" title="1ã€å®‰è£… cropperjs æ’ä»¶"></a>1ã€å®‰è£… cropperjs æ’ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cropperjs</span><br></pre></td></tr></table></figure>

<h3 id="2ã€åˆ›å»ºå›¾ç‰‡è£å‰ªç»„ä»¶"><a href="#2ã€åˆ›å»ºå›¾ç‰‡è£å‰ªç»„ä»¶" class="headerlink" title="2ã€åˆ›å»ºå›¾ç‰‡è£å‰ªç»„ä»¶"></a>2ã€åˆ›å»ºå›¾ç‰‡è£å‰ªç»„ä»¶</h3><p>update-photo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;update-photo&quot;&gt;</span><br><span class="line">    &lt;img class=&quot;img&quot; :src=&quot;img&quot; ref=&quot;img&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;toolbar&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;cancel&quot; @click=&quot;$emit(&#x27;close&#x27;)&quot;&gt;å–æ¶ˆ&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;confirm&quot; @click=&quot;onConfirm&quot;&gt;å®Œæˆ&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &quot;cropperjs/dist/cropper.css&quot;;</span><br><span class="line">import Cropper from &quot;cropperjs&quot;;</span><br><span class="line">import &#123; updateUserPhoto &#125; from &quot;@/api/user&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;UpdatePhoto&quot;,</span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    img: &#123;</span><br><span class="line">      type: [String, Object],</span><br><span class="line">      required: true,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      cropper: null,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;&#125;,</span><br><span class="line">  watch: &#123;&#125;,</span><br><span class="line">  created() &#123;&#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    const image = this.$refs.img;</span><br><span class="line">    this.cropper = new Cropper(image, &#123;</span><br><span class="line">      viewMode: 1,</span><br><span class="line">      dragMode: &quot;move&quot;,</span><br><span class="line">      aspectRatio: 1,</span><br><span class="line">      // autoCropArea: 1,</span><br><span class="line">      cropBoxMovable: false,</span><br><span class="line">      cropBoxResizable: false,</span><br><span class="line">      background: false,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onConfirm() &#123;</span><br><span class="line">      // åŸºäºæœåŠ¡ç«¯çš„è£åˆ‡ä½¿ç”¨ getData æ–¹æ³•è·å–è£åˆ‡å‚æ•°</span><br><span class="line">      // console.log(this.cropper.getData())</span><br><span class="line"></span><br><span class="line">      // çº¯å®¢æˆ·ç«¯çš„è£åˆ‡ä½¿ç”¨ getCroppedCanvas è·å–è£åˆ‡çš„æ–‡ä»¶å¯¹è±¡</span><br><span class="line">      this.cropper.getCroppedCanvas().toBlob((blob) =&gt; &#123;</span><br><span class="line">        this.updateUserPhoto(blob);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    async updateUserPhoto(blob) &#123;</span><br><span class="line">      this.$toast.loading(&#123;</span><br><span class="line">        message: &quot;ä¿å­˜ä¸­...&quot;,</span><br><span class="line">        forbidClick: true, // ç¦æ­¢èƒŒæ™¯ç‚¹å‡»</span><br><span class="line">        duration: 0, // æŒç»­å±•ç¤º</span><br><span class="line">      &#125;);</span><br><span class="line">      try &#123;</span><br><span class="line">        // é”™è¯¯çš„ç”¨æ³•</span><br><span class="line">        // å¦‚æœæ¥å£è¦æ±‚ Content-Type æ˜¯ application/json</span><br><span class="line">        // åˆ™ä¼ é€’æ™®é€š JavaScript å¯¹è±¡</span><br><span class="line">        // updateUserPhoto(&#123;</span><br><span class="line">        //   photo: blob</span><br><span class="line">        // &#125;)</span><br><span class="line"></span><br><span class="line">        // å¦‚æœæ¥å£è¦æ±‚ Content-Type æ˜¯ multipart/form-data</span><br><span class="line">        // åˆ™ä½ å¿…é¡»ä¼ é€’ FormData å¯¹è±¡</span><br><span class="line">        const formData = new FormData();</span><br><span class="line">        formData.append(&quot;photo&quot;, blob);</span><br><span class="line"></span><br><span class="line">        const &#123; data &#125; = await updateUserPhoto(formData);</span><br><span class="line"></span><br><span class="line">        // å…³é—­å¼¹å‡ºå±‚</span><br><span class="line">        this.$emit(&quot;close&quot;);</span><br><span class="line"></span><br><span class="line">        // æ›´æ–°è§†å›¾</span><br><span class="line">        this.$emit(&quot;update-photo&quot;, data.data.photo);</span><br><span class="line"></span><br><span class="line">        // æç¤ºæˆåŠŸ</span><br><span class="line">        this.$toast.success(&quot;æ›´æ–°æˆåŠŸ&quot;);</span><br><span class="line">      &#125; catch (err) &#123;</span><br><span class="line">        this.$toast.fail(&quot;æ›´æ–°å¤±è´¥&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;less&quot;&gt;</span><br><span class="line">.update-photo &#123;</span><br><span class="line">  background-color: #000;</span><br><span class="line">  height: 100%;</span><br><span class="line">  .toolbar &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    left: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    .cancel,</span><br><span class="line">    .confirm &#123;</span><br><span class="line">      width: 90px;</span><br><span class="line">      height: 90px;</span><br><span class="line">      font-size: 30px;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.img &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  max-width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œå›¾ç‰‡è£å‰ªç»„ä»¶ä»çˆ¶ç»„ä»¶æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å›¾ç‰‡åœ°å€ã€‚åœ¨ mounted æ ¹æ®å›¾ç‰‡ dom åˆ›å»ºä¸€ä¸ª cropper å¯¹è±¡ï¼Œé‡Œé¢çš„é…ç½®å‚æ•°æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦å¡«å†™ã€‚å½“ç‚¹å‡»å®Œæˆæ—¶ï¼Œä½¿ç”¨ getCroppedCanvas è·å–è£åˆ‡çš„æ–‡ä»¶å¯¹è±¡ï¼Œå¹¶å°†è¯¥å¯¹è±¡ä¼ é€’ç»™åç«¯ã€‚</p>
<h3 id="3ã€çˆ¶ç»„ä»¶"><a href="#3ã€çˆ¶ç»„ä»¶" class="headerlink" title="3ã€çˆ¶ç»„ä»¶"></a>3ã€çˆ¶ç»„ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;van-cell</span><br><span class="line">    class=&quot;photo-cell&quot;</span><br><span class="line">    title=&quot;å¤´åƒ&quot;</span><br><span class="line">    is-link</span><br><span class="line">    center</span><br><span class="line">    @click=&quot;$refs.file.click()&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;van-image class=&quot;avatar&quot; fit=&quot;cover&quot; round :src=&quot;user.photo&quot; /&gt;</span><br><span class="line">  &lt;/van-cell&gt;</span><br><span class="line">  &lt;van-popup</span><br><span class="line">    v-model=&quot;isUpdatePhotoShow&quot;</span><br><span class="line">    position=&quot;bottom&quot;</span><br><span class="line">    style=&quot;height: 100%;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;update-photo</span><br><span class="line">      v-if=&quot;isUpdatePhotoShow&quot;</span><br><span class="line">      :img=&quot;img&quot;</span><br><span class="line">      @close=&quot;isUpdatePhotoShow = false&quot;</span><br><span class="line">      @update-photo=&quot;user.photo = $event&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/van-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; getUserProfile &#125; from &quot;@/api/user&quot;;</span><br><span class="line">import UpdatePhoto from &quot;./components/update-photo&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;UserProfile&quot;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    UpdatePhoto,</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      user: &#123;&#125;, // ä¸ªäººä¿¡æ¯</span><br><span class="line">      isUpdatePhotoShow: false,</span><br><span class="line">      img: null, // é¢„è§ˆçš„å›¾ç‰‡</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;&#125;,</span><br><span class="line">  watch: &#123;&#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.loadUserProfile();</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;&#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    async loadUserProfile() &#123;</span><br><span class="line">      try &#123;</span><br><span class="line">        const &#123; data &#125; = await getUserProfile();</span><br><span class="line">        this.user = data.data;</span><br><span class="line">      &#125; catch (err) &#123;</span><br><span class="line">        this.$toast(&quot;æ•°æ®è·å–å¤±è´¥&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    onFileChange() &#123;</span><br><span class="line">      // è·å–æ–‡ä»¶å¯¹è±¡</span><br><span class="line">      const file = this.$refs.file.files[0];</span><br><span class="line"></span><br><span class="line">      // åŸºäºæ–‡ç« å¯¹è±¡è·å– blob æ•°æ®</span><br><span class="line">      this.img = window.URL.createObjectURL(file);</span><br><span class="line"></span><br><span class="line">      // å±•ç¤ºé¢„è§ˆå›¾ç‰‡å¼¹å‡ºå±‚</span><br><span class="line">      this.isUpdatePhotoShow = true;</span><br><span class="line"></span><br><span class="line">      // file-input å¦‚æœé€‰äº†åŒä¸€ä¸ªæ–‡ä»¶ä¸ä¼šè§¦å‘ change äº‹ä»¶</span><br><span class="line">      // è§£å†³åŠæ³•å°±æ˜¯æ¯æ¬¡ä½¿ç”¨å®Œæ¯•ï¼ŒæŠŠå®ƒçš„ value æ¸…ç©º</span><br><span class="line">      this.$refs.file.value = &quot;&quot;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-æˆ‘çš„å‰ç«¯å­¦ä¹ èµ„æºæ±‡æ€»"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/27/%E6%88%91%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/"
    >æˆ‘çš„å‰ç«¯å­¦ä¹ èµ„æºæ±‡æ€»</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/27/%E6%88%91%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/" class="article-date">
  <time datetime="2023-03-27T03:23:37.000Z" itemprop="datePublished">2023-03-27</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>æœ¬ç¯‡æœ¬ç« æ˜¯æƒ³å°†æˆ‘å‰ç«¯ä¹‹è·¯ä¸Šçš„å„ç§èµ„æºï¼ŒåŒ…æ‹¬è§†é¢‘ã€åšå®¢ã€ç½‘ç«™ã€æˆ‘è‡ªå·±ç”µè„‘å¸¸ç”¨çš„è½¯ä»¶è¿›è¡Œå½’çº³æ•´ç†å¤‡ä»½ã€‚è™½ç„¶è°·æ­Œæµè§ˆå™¨ç›¸å…³çš„å·²ç»å’Œæˆ‘çš„è°·æ­Œè´¦å·ç»‘å®šäº†ï¼Œvscode ç›¸å…³çš„ä¹Ÿå’Œ github è´¦å·ç»‘å®šäº†ã€‚ä½†è¿˜æ˜¯æ‰‹åŠ¨å¤‡ä»½ä¸€ä»½å¿ƒé‡Œè¸å®ä¸€äº›ã€‚</p>
<h2 id="ä¸€ã€å¸¸ç”¨è½¯ä»¶"><a href="#ä¸€ã€å¸¸ç”¨è½¯ä»¶" class="headerlink" title="ä¸€ã€å¸¸ç”¨è½¯ä»¶"></a>ä¸€ã€å¸¸ç”¨è½¯ä»¶</h2><p>æµè§ˆå™¨ï¼šChromeã€Edgeã€Firefox</p>
<p>Chrome æµè§ˆå™¨æ’ä»¶ï¼šVue.js devtoolsã€iGG è°·æ­Œå­¦æœ¯åŠ©æ‰‹ã€RSS Reader Extension</p>
<p>ä»£ç ç¼–è¾‘å™¨ï¼šVSCode</p>
<p>VSCode æ’ä»¶ï¼šany-ruleã€Atom One Dark Themeã€Auto Rename Tagã€ChatGPT ä¸­æ–‡ç‰ˆã€Chineseï¼ˆSimplifiedï¼‰ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰ã€Code Runnerã€Codeifã€Easy LESSã€Error Lensã€ESLintã€HTML CSS Supportã€JavaScriptï¼ˆES6ï¼‰code snippetsã€jQuery Code Snippetsã€Live Serverã€Material Icon Themeã€open in browserã€Prettier-Code formatterã€px to rem&amp;rpx&amp;vwï¼ˆcssremï¼‰ã€vscode-iconsã€Vue Language Features (Volar)ã€VueHelperã€Vetur</p>
<p>VSCode å­—ä½“ï¼šFira Code</p>
<p>VSCode ä¸­ settings.json è®¾ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;editor.formatOnSave&quot;: true,</span><br><span class="line">  &quot;security.workspace.trust.untrustedFiles&quot;: &quot;open&quot;,</span><br><span class="line">  &quot;workbench.iconTheme&quot;: &quot;material-icon-theme&quot;,</span><br><span class="line">  &quot;liveServer.settings.donotShowInfoMsg&quot;: true,</span><br><span class="line">  &quot;workbench.colorCustomizations&quot;: &#123;</span><br><span class="line">    &quot;editor.lineHighlightBackground&quot;: &quot;#1073cf2d&quot;,</span><br><span class="line">    &quot;editor.lineHighlightBorder&quot;: &quot;#9fced11f&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;editor.wordWrap&quot;: &quot;off&quot;,</span><br><span class="line">  &quot;diffEditor.wordWrap&quot;: &quot;off&quot;,</span><br><span class="line">  &quot;editor.guides.bracketPairs&quot;: false,</span><br><span class="line">  &quot;liveServer.settings.CustomBrowser&quot;: &quot;chrome&quot;,</span><br><span class="line">  &quot;code-runner.runInTerminal&quot;: true,</span><br><span class="line">  &quot;vsicons.dontShowNewVersionMessage&quot;: true,</span><br><span class="line">  &quot;emmet.triggerExpansionOnTab&quot;: true,</span><br><span class="line">  &quot;explorer.confirmDelete&quot;: false,</span><br><span class="line">  &quot;editor.inlayHints.enabled&quot;: &quot;on&quot;,</span><br><span class="line">  &quot;less.compile&quot;: &#123;</span><br><span class="line">    &quot;out&quot;: &quot;../css/&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;cssrem.rootFontSize&quot;: 80,</span><br><span class="line">  &quot;cssrem.vwDesign&quot;: 1920,</span><br><span class="line">  &quot;vetur.completion.scaffoldSnippetSources&quot;: &#123;</span><br><span class="line">    &quot;workspace&quot;: &quot;ğŸ’¼&quot;,</span><br><span class="line">    &quot;user&quot;: &quot;ğŸ—’ï¸&quot;,</span><br><span class="line">    &quot;vetur&quot;: &quot;âœŒ&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;emmet.syntaxProfiles&quot;: &#123;</span><br><span class="line">    &quot;vue-html&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;vue&quot;: &quot;html&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  //vueè‡ªåŠ¨è¡¥å…¨</span><br><span class="line">  &quot;files.associations&quot;: &#123;</span><br><span class="line">    &quot;*.vue&quot;: &quot;vue&quot;,</span><br><span class="line">    &quot;*.ejs&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;*.js&quot;: &quot;javascript&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;vetur.experimental.templateInterpolationService&quot;: true,</span><br><span class="line">  &quot;vetur.validation.interpolation&quot;: false,</span><br><span class="line">  &quot;workbench.tree.renderIndentGuides&quot;: &quot;always&quot;,</span><br><span class="line">  &quot;workbench.tree.indent&quot;: 18,</span><br><span class="line">  &quot;workbench.preferredHighContrastLightColorTheme&quot;: &quot;Default Dark+&quot;,</span><br><span class="line">  &quot;workbench.preferredLightColorTheme&quot;: &quot;Default Dark+&quot;,</span><br><span class="line">  &quot;eslint.enable&quot;: true,</span><br><span class="line">  &quot;eslint.run&quot;: &quot;onType&quot;,</span><br><span class="line">  &quot;eslint.options&quot;: &#123;</span><br><span class="line">    &quot;extensions&quot;: [&quot;.js&quot;, &quot;.vue&quot;, &quot;.jsx&quot;, &quot;.tsx&quot;]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;editor.codeActionsOnSave&quot;: &#123;</span><br><span class="line">    &quot;source.fixAll.eslint&quot;: true</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;workbench.colorTheme&quot;: &quot;Atom One Dark&quot;,</span><br><span class="line">  &quot;editor.tokenColorCustomizations&quot;: &#123;</span><br><span class="line">    &quot;comments&quot;: &#123;</span><br><span class="line">      // è®¾ç½®å­—ä½“æ ·å¼ åŠ ç²— ä¸‹åˆ’çº¿ æ–œä½“ç­‰</span><br><span class="line">      &quot;fontStyle&quot;: &quot;italic&quot;,</span><br><span class="line">      // è®¾ç½®å­—ä½“é¢œè‰²</span><br><span class="line">      &quot;foreground&quot;: &quot;#4CAEE2&quot;</span><br><span class="line">    &#125;, // æ³¨é‡Š</span><br><span class="line">    &quot;keywords&quot;: &quot;#0a0&quot;, // å…³é”®å­—</span><br><span class="line">    &quot;variables&quot;: &quot;#f00&quot;, // å˜é‡å</span><br><span class="line">    &quot;strings&quot;: &quot;#e2d75dbd&quot;, // å­—ç¬¦ä¸²</span><br><span class="line">    &quot;functions&quot;: &quot;#5b99fcc9&quot;, // å‡½æ•°å</span><br><span class="line">    &quot;numbers&quot;: &quot;#AE81FF&quot; // æ•°å­—</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;prettier.trailingComma&quot;: &quot;es5&quot;,</span><br><span class="line">  &quot;[vue]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;[html]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;editor.fontLigatures&quot;: true,</span><br><span class="line">  &quot;editor.fontVariations&quot;: false,</span><br><span class="line">  &quot;settingsSync.ignoredSettings&quot;: [&quot;terminal.integrated.fontFamily&quot;],</span><br><span class="line">  &quot;editor.fontFamily&quot;: &quot;Fira Code&quot;,</span><br><span class="line">  &quot;http.proxyAuthorization&quot;: null,</span><br><span class="line">  &quot;vetur.format.defaultFormatter.js&quot;: &quot;prettier-eslint&quot;,</span><br><span class="line">  &quot;vetur.format.defaultFormatterOptions&quot;: &#123;</span><br><span class="line">    &quot;prettier&quot;: &#123;</span><br><span class="line">      &quot;singleQuote&quot;: true, //ç”¨å•å¼•å·</span><br><span class="line">      &quot;semi&quot;: false //ä¸åŠ åˆ†å·</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;editor.inlineSuggest.enabled&quot;: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ–‡æ¡£ç¬”è®°ï¼šTypora</p>
<p>æ’ä»¶&#x2F;åº”ç”¨ï¼šuToolsã€PxCook åƒç´ å¤§å¨</p>
<p>æˆªå›¾å·¥å…·ï¼šsnipaste</p>
<p>ç¿»è¯‘å·¥å…·ï¼šæœ‰é“è¯å…¸</p>
<p>VPNï¼šç›®å‰ç”¨çš„çº¢æµ·</p>
<p>API æ¥å£æµ‹è¯•å·¥å…·ï¼šPostmanã€ApiFox</p>
<p>ç”»å›¾å·¥å…·ï¼šDiagramDesignerã€draw.io</p>
<p>JSON æ ¼å¼åŒ–å·¥å…·ï¼šNotepad++ã€Notepadâ€“</p>
<p>github åŠ é€Ÿå·¥å…·ï¼šFastGithubã€SwitchHosts</p>
<p>æ•°æ®åº“ç®¡ç†å·¥å…·ï¼šNavicat</p>
<p>ç‰ˆæœ¬æ§åˆ¶ï¼šgit</p>
<p>è¿è¡Œç¯å¢ƒï¼šNode.jsï¼ˆè‡ªå¸¦ npmï¼‰ã€NVM åˆ‡æ¢ node ç‰ˆæœ¬ã€nodemon</p>
<p>æŸ¥çœ‹ npm åŒ…ï¼š<a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a></p>
<p>Web å¼€å‘æ¡†æ¶ï¼šExpress</p>
<p>å‰ç«¯æ¡†æ¶ï¼šVue</p>
<h2 id="äºŒã€å¸¸ç”¨ç½‘ç«™"><a href="#äºŒã€å¸¸ç”¨ç½‘ç«™" class="headerlink" title="äºŒã€å¸¸ç”¨ç½‘ç«™"></a>äºŒã€å¸¸ç”¨ç½‘ç«™</h2><p>Vueï¼š<a target="_blank" rel="noopener" href="https://cn.vuejs.org/">https://cn.vuejs.org/</a></p>
<p>ElementUIï¼š<a target="_blank" rel="noopener" href="https://element.eleme.cn/#/zh-CN">https://element.eleme.cn/#/zh-CN</a></p>
<p>MDNï¼š<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/">https://developer.mozilla.org/zh-CN/</a></p>
<p>GitHubï¼š<a target="_blank" rel="noopener" href="https://github.com/">https://github.com/</a></p>
<p>ç¨€åœŸæ˜é‡‘ï¼š<a target="_blank" rel="noopener" href="https://juejin.cn/">https://juejin.cn/</a></p>
<p>ä¹¦æ ˆç½‘ï¼š<a target="_blank" rel="noopener" href="https://www.bookstack.cn/">https://www.bookstack.cn/</a></p>
<p>Vantï¼š<a target="_blank" rel="noopener" href="https://vant-ui.github.io/vant/#/zh-CN">https://vant-ui.github.io/vant/?#/zh-CN</a></p>
<p>NutUIï¼š<a target="_blank" rel="noopener" href="https://nutui.jd.com/#/">https://nutui.jd.com/#/</a></p>
<p>æŸ¥è¯¢å…¼å®¹æ€§ï¼š<a target="_blank" rel="noopener" href="https://caniuse.com/">https://caniuse.com/</a></p>
<p>åœ¨çº¿å·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://tool.lu/">https://tool.lu/</a></p>
<p>lodash å·¥å…·åº“ï¼š<a target="_blank" rel="noopener" href="https://www.lodashjs.com/">https://www.lodashjs.com/</a></p>
<p>å­—ä½“å›¾æ ‡ï¼š<a target="_blank" rel="noopener" href="https://www.iconfont.cn/">https://www.iconfont.cn/</a></p>
<p>è…¾è®¯äº‘ï¼š<a target="_blank" rel="noopener" href="https://cloud.tencent.com/">https://cloud.tencent.com/</a></p>
<h2 id="ä¸‰ã€å­¦ä¹ èµ„æº"><a href="#ä¸‰ã€å­¦ä¹ èµ„æº" class="headerlink" title="ä¸‰ã€å­¦ä¹ èµ„æº"></a>ä¸‰ã€å­¦ä¹ èµ„æº</h2><p>å‰ç«¯å…¥é—¨ï¼š</p>
<p>pink è€å¸ˆå‰ç«¯å…¥é—¨æ•™ç¨‹ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV14J4114768">https://www.bilibili.com/video/BV14J4114768</a></p>
<p>ES6ï¼š <a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/">https://es6.ruanyifeng.com/</a></p>
<p>Vue2+Vue3 å°šç¡…è°·å¼ å¤©ç¦¹è€å¸ˆï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Zy4y1K7SH/?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1Zy4y1K7SH/?spm_id_from=333.337.search-card.all.click</a></p>
<p>Vue3+TS å¿«é€Ÿä¸Šæ‰‹ï¼š<a target="_blank" rel="noopener" href="https://24kcs.github.io/vue3_study/">https://24kcs.github.io/vue3_study/</a></p>
<h2 id="å››ã€å¸¸ç”¨æ’ä»¶"><a href="#å››ã€å¸¸ç”¨æ’ä»¶" class="headerlink" title="å››ã€å¸¸ç”¨æ’ä»¶"></a>å››ã€å¸¸ç”¨æ’ä»¶</h2><p>ç§»åŠ¨ç«¯ REM é€‚é…ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/cuth/postcss-pxtorem">postcss-pxtorem</a> æ˜¯ä¸€æ¬¾ postcss æ’ä»¶ï¼Œç”¨äºå°†å•ä½è½¬åŒ–ä¸º rem</li>
<li><a target="_blank" rel="noopener" href="https://github.com/amfe/lib-flexible">lib-flexible</a> ç”¨äºè®¾ç½® rem åŸºå‡†å€¼</li>
</ul>
<p>ç§»åŠ¨ç«¯ vw é€‚é…ï¼špostcss-px-to-viewport</p>
<p>ç½‘ç»œè¯·æ±‚ï¼š<a target="_blank" rel="noopener" href="https://github.com/axios/axios">axios</a></p>
<p>æ—¶é—´å¤„ç†ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://momentjs.com/">Moment.js</a></li>
<li><a target="_blank" rel="noopener" href="https://day.js.org/">Day.js</a></li>
</ul>
<p>æ–‡ç« æ ·å¼å¤„ç†ï¼š<a target="_blank" rel="noopener" href="https://github.com/sindresorhus/github-markdown-css">github-markdown-css</a></p>
<p>å›¾ç‰‡è£åˆ‡å¤„ç†ï¼š<a target="_blank" rel="noopener" href="https://github.com/fengyuanchen/cropperjs">cropper.js</a></p>
<p>åå°å‰ç«¯è§£å†³æ–¹æ¡ˆ:<a target="_blank" rel="noopener" href="https://panjiachen.gitee.io/vue-element-admin-site/zh/">vue-element-admin</a></p>
<p>Excel å¯¼å…¥å¯¼å‡ºï¼š<a target="_blank" rel="noopener" href="https://github.com/SheetJS/js-xlsx">js-xlsx</a></p>
<p>å›¾ç‰‡åœ°å€ç”ŸæˆäºŒç»´ç :qrcode</p>
<p>æ‰“å°ï¼švue-print-nb</p>
<p>æ•°æ®æŒä¹…åŒ–ï¼švuex-persistedstate</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-å½“åç«¯è¿”å›æ•°æ®ä¸­æœ‰å¤§æ•°å­—æ—¶çš„è§£å†³æ–¹æ¡ˆ"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/%E5%BD%93%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%A4%A7%E6%95%B0%E5%AD%97%E6%97%B6%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"
    >å½“åç«¯è¿”å›æ•°æ®ä¸­æœ‰å¤§æ•°å­—æ—¶çš„è§£å†³æ–¹æ¡ˆ</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/%E5%BD%93%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%A4%A7%E6%95%B0%E5%AD%97%E6%97%B6%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="article-date">
  <time datetime="2023-03-14T08:32:21.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>JavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨<code>-2^53</code>åˆ°<code>2^53</code>ä¹‹é—´ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ï¼Œè¿™ä½¿å¾— JavaScript ä¸é€‚åˆè¿›è¡Œç§‘å­¦å’Œé‡‘èæ–¹é¢çš„ç²¾ç¡®è®¡ç®—ã€‚å› æ­¤å¦‚æœåç«¯è¿”å›çš„æ•°æ®ä¸­æœ‰å¤§æ•°å­—ï¼Œå‰ç«¯ä¸åŠ ä»¥å¤„ç†å°±ä¼šå¯¼è‡´æ•°æ®ä¸èƒ½æ­£å¸¸å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>); <span class="comment">// 9007199254740992</span></span><br><span class="line"></span><br><span class="line"><span class="number">9007199254740992</span>; <span class="comment">// 9007199254740992</span></span><br><span class="line"><span class="number">9007199254740993</span>; <span class="comment">// 9007199254740992</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>) === <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¶…å‡º 2 çš„ 53 æ¬¡æ–¹ä¹‹åï¼Œä¸€ä¸ªæ•°å°±ä¸ç²¾ç¡®äº†ã€‚<br>ES6 å¼•å…¥äº†<code>Number.MAX_SAFE_INTEGER</code>å’Œ<code>Number.MIN_SAFE_INTEGER</code>è¿™ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span> === <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>) - <span class="number">1</span>;</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span> === <span class="number">9007199254740991</span>;</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Number</span>.<span class="property">MIN_SAFE_INTEGER</span> === -<span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span>;</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="title class_">Number</span>.<span class="property">MIN_SAFE_INTEGER</span> === -<span class="number">9007199254740991</span>;</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ° JavaScript èƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æé™ã€‚</p>
<p>åç«¯è¿”å›çš„æ•°æ®ä¸€èˆ¬éƒ½æ˜¯ <strong>JSON æ ¼å¼çš„å­—ç¬¦ä¸²</strong>ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&#123; \&quot;id\&quot;: 9007199254740995, \&quot;name\&quot;: \&quot;Jack\&quot;, \&quot;age\&quot;: 18 &#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿™ä¸ªå­—ç¬¦ä¸åšä»»ä½•å¤„ç†ï¼Œä½ èƒ½æ–¹ä¾¿çš„è·å–åˆ°å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šæ•°æ®å—ï¼Ÿéå¸¸éº»çƒ¦ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æŠŠå®ƒè½¬æ¢ä¸º JavaScript å¯¹è±¡æ¥ä½¿ç”¨å°±å¾ˆæ–¹ä¾¿äº†ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ axios ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨æ•°æ®ï¼Œå®ƒä¼šåœ¨å†…éƒ¨ä½¿ç”¨ <code>JSON.parse()</code> æŠŠåç«¯è¿”å›çš„æ•°æ®è½¬ä¸º JavaScript å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#123; id: 9007199254740996, name: &#x27;Jack&#x27;, age: 18 &#125;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123; &quot;id&quot;: 9007199254740995, &quot;name&quot;: &quot;Jack&quot;, &quot;age&quot;: 18 &#125;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¶…å‡ºå®‰å…¨æ•´æ•°èŒƒå›´çš„ id æ— æ³•ç²¾ç¡®è¡¨ç¤ºï¼Œè¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯ axios çš„é”™ã€‚</p>
<p>äº†è§£äº†ä»€ä¹ˆæ˜¯å¤§æ•´æ•°çš„æ¦‚å¿µï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯å¦‚ä½•è§£å†³ï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/sidorares/json-bigint">json-bigint</a> æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…ï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬å¾ˆå¥½çš„å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ä½¿ç”¨å®ƒçš„ç¬¬ä¸€æ­¥å°±æ˜¯æŠŠå®ƒå®‰è£…åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i json-bigint</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ä½¿ç”¨å®ƒçš„ä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jsonStr = <span class="string">&#x27;&#123; &quot;art_id&quot;: 1245953273786007552 &#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr)); <span class="comment">// 1245953273786007600</span></span><br><span class="line"><span class="comment">// JSON.stringify()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// JSONBig å¯ä»¥å¤„ç†æ•°æ®ä¸­è¶…å‡º JavaScript å®‰å…¨æ•´æ•°èŒƒå›´çš„é—®é¢˜</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>Big.<span class="title function_">parse</span>(jsonStr)); <span class="comment">// æŠŠ JSON æ ¼å¼çš„å­—ç¬¦ä¸²è½¬ä¸º JavaScript å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨çš„æ—¶å€™éœ€è¦æŠŠ BigNumber ç±»å‹çš„æ•°æ®è½¬ä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>Big.<span class="title function_">parse</span>(jsonStr).<span class="property">art_id</span>.<span class="title function_">toString</span>()); <span class="comment">// 1245953273786007552</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">JSON</span>Big.<span class="title function_">parse</span>(jsonStr)));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>Big.<span class="title function_">stringify</span>(<span class="title class_">JSON</span>Big.<span class="title function_">parse</span>(jsonStr))); <span class="comment">// æŠŠ JavaScript å¯¹è±¡ è½¬ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²è½¬</span></span><br></pre></td></tr></table></figure>

<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/1582099315865-5e805425-7abf-4cf2-9df3-acc2ef8f9bb9.png" alt="image.png"></p>
<blockquote>
<p>json-bigint ä¼šæŠŠè¶…å‡º JS å®‰å…¨æ•´æ•°èŒƒå›´çš„æ•°å­—è½¬ä¸ºä¸€ä¸ª BigNumber ç±»å‹çš„å¯¹è±¡ï¼Œå¯¹è±¡æ•°æ®æ˜¯å®ƒå†…éƒ¨çš„ä¸€ä¸ªç®—æ³•å¤„ç†ä¹‹åçš„ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™è½¬ä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨ã€‚</p>
</blockquote>
<p>é€šè¿‡ Axios è¯·æ±‚å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ Axios å¤„ç†ï¼ˆJSON.parseï¼‰ä¹‹åçš„ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ Axios æ‰§è¡Œå¤„ç†ä¹‹å‰æ‰‹åŠ¨ä½¿ç”¨ json-bigint æ¥è§£æå¤„ç†ã€‚Axios æä¾›äº†è‡ªå®šä¹‰å¤„ç†åŸå§‹åç«¯è¿”å›æ•°æ®çš„ APIï¼š<code>transformResponse</code> ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jsonBig <span class="keyword">from</span> <span class="string">&quot;json-bigint&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">&#x27;&#123; &quot;value&quot; : 9223372036854775807, &quot;v2&quot;: 123 &#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(jsonBig.<span class="title function_">parse</span>(json));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;http://ttapi.research.itcast.cn/&quot;</span>, <span class="comment">// æ¥å£åŸºç¡€è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// transformResponse å…è®¸è‡ªå®šä¹‰åŸå§‹çš„å“åº”æ•°æ®ï¼ˆå­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">  <span class="attr">transformResponse</span>: [</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœè½¬æ¢æˆåŠŸåˆ™è¿”å›è½¬æ¢çš„æ•°æ®ç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> jsonBig.<span class="title function_">parse</span>(data);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœè½¬æ¢å¤±è´¥ï¼Œåˆ™åŒ…è£…ä¸ºç»Ÿä¸€æ•°æ®æ ¼å¼å¹¶è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          data,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> request;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰©å±•ï¼šES2020 BigInt</p>
<p>ES2020 å¼•å…¥äº†ä¸€ç§æ–°çš„æ•°æ®ç±»å‹ BigIntï¼ˆå¤§æ•´æ•°ï¼‰ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚BigInt åªç”¨æ¥è¡¨ç¤ºæ•´æ•°ï¼Œæ²¡æœ‰ä½æ•°çš„é™åˆ¶ï¼Œä»»ä½•ä½æ•°çš„æ•´æ•°éƒ½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/BigInt">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects&#x2F;BigInt</a></li>
<li><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/number#BigInt-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">http://es6.ruanyifeng.com/#docs/number#BigInt-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B</a></li>
</ul>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-ä¸¤ç§ç§»åŠ¨ç«¯é€‚é…æ–¹æ¡ˆ"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/12/%E4%B8%A4%E7%A7%8D%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E6%96%B9%E6%A1%88/"
    >ä¸¤ç§ç§»åŠ¨ç«¯é€‚é…æ–¹æ¡ˆ</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/12/%E4%B8%A4%E7%A7%8D%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E6%96%B9%E6%A1%88/" class="article-date">
  <time datetime="2023-03-12T08:25:19.000Z" itemprop="datePublished">2023-03-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="ä¸€ã€lib-flexible-postcss-pxtorem"><a href="#ä¸€ã€lib-flexible-postcss-pxtorem" class="headerlink" title="ä¸€ã€lib-flexible+postcss-pxtorem"></a>ä¸€ã€lib-flexible<code>+</code>postcss-pxtorem</h2><p>åœ¨ç›¸å½“é•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œè¿™ä¸¤ä¸ªæ’ä»¶æ­é…éƒ½æ˜¯è§£å†³ç§»åŠ¨ç«¯å¸ƒå±€çš„ç¥å™¨ï¼Œ<code>lib-flexible</code>æ˜¯é˜¿é‡Œæ‰‹æ·˜ç³»å¼€æºçš„ä¸€ä¸ªåº“ï¼Œç”¨äºè®¾ç½® font-sizeï¼ŒåŒæ—¶å¤„ç†ä¸€äº›çª—å£ç¼©æ”¾çš„é—®é¢˜ã€‚ç›´åˆ°ä»Šå¤©ï¼Œè¿™ä¸ªæ–¹æ¡ˆä»æ˜¯è§£å†³ç§»åŠ¨ç«¯å¸ƒå±€çš„ä¸»æµæ–¹æ¡ˆã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/cuth/postcss-pxtorem">postcss-pxtorem</a> æ˜¯ä¸€æ¬¾ postcss æ’ä»¶ï¼Œç”¨äºå°†å•ä½è½¬åŒ–ä¸º rem</li>
<li><a target="_blank" rel="noopener" href="https://github.com/amfe/lib-flexible">lib-flexible</a> ç”¨äºè®¾ç½® rem åŸºå‡†å€¼</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å°†è¿™ä¸¤ä¸ªå·¥å…·é…ç½®åˆ°é¡¹ç›®ä¸­å®Œæˆ REM é€‚é…ã€‚</p>
<h3 id="1-1ä½¿ç”¨-lib-flexible-åŠ¨æ€è®¾ç½®-REM-åŸºå‡†å€¼ï¼ˆhtml-æ ‡ç­¾çš„å­—ä½“å¤§å°ï¼‰"><a href="#1-1ä½¿ç”¨-lib-flexible-åŠ¨æ€è®¾ç½®-REM-åŸºå‡†å€¼ï¼ˆhtml-æ ‡ç­¾çš„å­—ä½“å¤§å°ï¼‰" class="headerlink" title="1.1ä½¿ç”¨ lib-flexible åŠ¨æ€è®¾ç½® REM åŸºå‡†å€¼ï¼ˆhtml æ ‡ç­¾çš„å­—ä½“å¤§å°ï¼‰"></a>1.1<strong>ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/amfe/lib-flexible">lib-flexible</a> åŠ¨æ€è®¾ç½® REM åŸºå‡†å€¼ï¼ˆhtml æ ‡ç­¾çš„å­—ä½“å¤§å°ï¼‰</strong></h3><p>1ã€å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yarn add amfe-flexible</span></span><br><span class="line">npm i amfe-flexible</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶ååœ¨ <code>main.js</code> ä¸­åŠ è½½æ‰§è¡Œè¯¥æ¨¡å—</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;amfe-flexible&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æœ€åæµ‹è¯•ï¼šåœ¨æµè§ˆå™¨ä¸­åˆ‡æ¢ä¸åŒçš„æ‰‹æœºè®¾å¤‡å°ºå¯¸ï¼Œè§‚å¯Ÿ html æ ‡ç­¾ <code>font-size</code> çš„å˜åŒ–ã€‚</p>
<h3 id="1-2ä½¿ç”¨-postcss-pxtorem-å°†-px-è½¬ä¸º-rem"><a href="#1-2ä½¿ç”¨-postcss-pxtorem-å°†-px-è½¬ä¸º-rem" class="headerlink" title="1.2ä½¿ç”¨ postcss-pxtorem å°† px è½¬ä¸º rem"></a>1.2<strong>ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/cuth/postcss-pxtorem">postcss-pxtorem</a> å°† <code>px</code> è½¬ä¸º <code>rem</code></strong></h3><p>1ã€å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yarn add -D postcss-pxtorem</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-D æ˜¯ --save-dev çš„ç®€å†™</span></span><br><span class="line">npm install postcss-pxtorem -D</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶ååœ¨<strong>é¡¹ç›®æ ¹ç›®å½•</strong>ä¸­åˆ›å»º <code>.postcssrc.js</code> æ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: &#123;</span><br><span class="line">    <span class="attr">autoprefixer</span>: &#123;</span><br><span class="line">      <span class="attr">browsers</span>: [<span class="string">&quot;Android &gt;= 4.0&quot;</span>, <span class="string">&quot;iOS &gt;= 8&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;postcss-pxtorem&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">rootValue</span>: <span class="number">37.5</span>,</span><br><span class="line">      <span class="attr">propList</span>: [<span class="string">&quot;*&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>3ã€<strong>é…ç½®å®Œæ¯•ï¼Œé‡æ–°å¯åŠ¨æœåŠ¡</strong></p>
<p>æœ€åæµ‹è¯•ï¼š<strong>åˆ·æ–°æµè§ˆå™¨é¡µé¢</strong>ï¼Œå®¡æŸ¥å…ƒç´ çš„æ ·å¼æŸ¥çœ‹æ˜¯å¦å·²å°† <code>px</code> è½¬æ¢ä¸º <code>rem</code>ã€‚</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p>
<ul>
<li>è¯¥æ’ä»¶**ä¸èƒ½è½¬æ¢è¡Œå†…æ ·å¼ä¸­çš„ <code>px</code>**ï¼Œä¾‹å¦‚ <code>&lt;div style=&quot;width: 200px;&quot;&gt;&lt;/div&gt;</code></li>
</ul>
<h3 id="1-3-å…³äº-postcssrc-js-é…ç½®æ–‡ä»¶"><a href="#1-3-å…³äº-postcssrc-js-é…ç½®æ–‡ä»¶" class="headerlink" title="1.3 å…³äº .postcssrc.js é…ç½®æ–‡ä»¶"></a>1.3 å…³äº <code>.postcssrc.js</code> é…ç½®æ–‡ä»¶</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: &#123;</span><br><span class="line">    <span class="attr">autoprefixer</span>: &#123;</span><br><span class="line">      <span class="attr">browsers</span>: [<span class="string">&quot;Android &gt;= 4.0&quot;</span>, <span class="string">&quot;iOS &gt;= 8&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;postcss-pxtorem&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">rootValue</span>: <span class="number">37.5</span>,</span><br><span class="line">      <span class="attr">propList</span>: [<span class="string">&quot;*&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>.postcssrc.js</code> æ˜¯ PostCSS çš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>ï¼ˆ1ï¼‰PostCSS ä»‹ç»</p>
<p><a target="_blank" rel="noopener" href="https://postcss.org/">PostCSS</a> æ˜¯ä¸€ä¸ªå¤„ç† CSS çš„å¤„ç†å·¥å…·ï¼Œæœ¬èº«åŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼Œå®ƒä¸»è¦è´Ÿè´£è§£æ CSS ä»£ç ï¼Œå†äº¤ç”±æ’ä»¶æ¥è¿›è¡Œå¤„ç†ï¼Œå®ƒçš„æ’ä»¶ä½“ç³»éå¸¸å¼ºå¤§ï¼Œæ‰€èƒ½è¿›è¡Œçš„æ“ä½œæ˜¯å¤šç§å¤šæ ·çš„ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/postcss/autoprefixer">Autoprefixer</a> æ’ä»¶å¯ä»¥å®ç°è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨ç›¸å…³çš„å£°æ˜å‰ç¼€</li>
<li><a target="_blank" rel="noopener" href="https://github.com/csstools/postcss-preset-env">PostCSS Preset Env</a> æ’ä»¶å¯ä»¥è®©ä½ ä½¿ç”¨æ›´æ–°çš„ CSS è¯­æ³•ç‰¹æ€§å¹¶å®ç°å‘ä¸‹å…¼å®¹</li>
<li><a target="_blank" rel="noopener" href="https://github.com/cuth/postcss-pxtorem">postcss-pxtorem</a> å¯ä»¥å®ç°å°† px è½¬æ¢ä¸º rem</li>
<li>â€¦</li>
</ul>
<p>ç›®å‰ PostCSS å·²ç»æœ‰ <a target="_blank" rel="noopener" href="https://github.com/postcss/postcss/blob/master/docs/plugins.md">200 å¤šä¸ªåŠŸèƒ½å„å¼‚çš„æ’ä»¶</a>ã€‚å¼€å‘äººå‘˜ä¹Ÿå¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€è¦ï¼Œå¼€å‘å‡ºè‡ªå·±çš„ PostCSS æ’ä»¶ã€‚</p>
<p>PostCSS ä¸€èˆ¬ä¸å•ç‹¬ä½¿ç”¨ï¼Œè€Œæ˜¯ä¸å·²æœ‰çš„æ„å»ºå·¥å…·è¿›è¡Œé›†æˆã€‚</p>
<p><a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/guide/css.html#postcss">Vue CLI é»˜è®¤é›†æˆäº† PostCSS</a>ï¼Œå¹¶ä¸”é»˜è®¤å¼€å¯äº† <a target="_blank" rel="noopener" href="https://github.com/postcss/autoprefixer">autoprefixer</a> æ’ä»¶ã€‚</p>
<blockquote>
<p>Vue CLI å†…éƒ¨ä½¿ç”¨äº† PostCSSã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡ <code>.postcssrc</code> æˆ–ä»»ä½• <a target="_blank" rel="noopener" href="https://github.com/michael-ciniawsky/postcss-load-config">postcss-load-config</a> æ”¯æŒçš„é…ç½®æºæ¥é…ç½® PostCSSã€‚ä¹Ÿå¯ä»¥é€šè¿‡ <code>vue.config.js</code> ä¸­çš„ <code>css.loaderOptions.postcss</code> é…ç½® <a target="_blank" rel="noopener" href="https://github.com/postcss/postcss-loader">postcss-loader</a>ã€‚</p>
<p>æˆ‘ä»¬é»˜è®¤å¼€å¯äº† <a target="_blank" rel="noopener" href="https://github.com/postcss/autoprefixer">autoprefixer</a>ã€‚å¦‚æœè¦é…ç½®ç›®æ ‡æµè§ˆå™¨ï¼Œå¯ä½¿ç”¨ <code>package.json</code> çš„ <a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/guide/browser-compatibility.html#browserslist">browserslist</a> å­—æ®µã€‚</p>
</blockquote>
<p>ï¼ˆ2ï¼‰Autoprefixer æ’ä»¶çš„é…ç½®</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200319104557718.png" alt="image-20200319104557718"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/postcss/autoprefixer">autoprefixer</a> æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€çš„ PostCss æ’ä»¶ï¼Œ<code>browsers</code> ç”¨æ¥é…ç½®å…¼å®¹çš„æµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯ï¼Œä½†æ˜¯å†™åœ¨è¿™é‡Œçš„è¯ä¼šå¼•èµ·ç¼–è¯‘å™¨è­¦å‘Šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Replace Autoprefixer browsers option to Browserslist config.</span><br><span class="line">Use browserslist key in package.json or .browserslistrc file.</span><br><span class="line"></span><br><span class="line">Using browsers option can cause errors. Browserslist config</span><br><span class="line">can be used for Babel, Autoprefixer, postcss-normalize and other tools.</span><br><span class="line"></span><br><span class="line">If you really need to use option, rename it to overrideBrowserslist.</span><br><span class="line"></span><br><span class="line">Learn more at:</span><br><span class="line">https://github.com/browserslist/browserslist#readme</span><br><span class="line">https://twitter.com/browserslist</span><br></pre></td></tr></table></figure>

<p>è­¦å‘Šæ„æ€å°±æ˜¯è¯´ä½ åº”è¯¥å°† <code>browsers</code> é€‰é¡¹å†™åˆ° <code>package.json</code> æˆ– <code>.browserlistrc</code> æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[Android]</span><br><span class="line">&gt;= 4.0</span><br><span class="line"></span><br><span class="line">[iOS]</span><br><span class="line">&gt;= 8</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…·ä½“è¯­æ³•è¯·<a target="_blank" rel="noopener" href="https://github.com/browserslist/browserslist">å‚è€ƒè¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>ï¼ˆ3ï¼‰postcss-pxtorem æ’ä»¶çš„é…ç½®</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200319105610557.png" alt="image-20200319105610557"></p>
<ul>
<li><code>rootValue</code>ï¼šè¡¨ç¤ºæ ¹å…ƒç´ å­—ä½“å¤§å°ï¼Œå®ƒä¼šæ ¹æ®æ ¹å…ƒç´ å¤§å°è¿›è¡Œå•ä½è½¬æ¢</li>
<li><code>propList</code> ç”¨æ¥è®¾å®šå¯ä»¥ä» px è½¬ä¸º rem çš„å±æ€§<ul>
<li>ä¾‹å¦‚ <code>*</code> å°±æ˜¯æ‰€æœ‰å±æ€§éƒ½è¦è½¬æ¢ï¼Œ<code>width</code> å°±æ˜¯ä»…è½¬æ¢ <code>width</code> å±æ€§</li>
</ul>
</li>
</ul>
<p><code>rootValue</code> åº”è¯¥å¦‚ä½•è®¾ç½®å‘¢ï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä½ ä½¿ç”¨çš„æ˜¯åŸºäº lib-flexable çš„ REM é€‚é…æ–¹æ¡ˆï¼Œåˆ™åº”è¯¥è®¾ç½®ä¸ºä½ çš„è®¾è®¡ç¨¿çš„ååˆ†ä¹‹ä¸€ã€‚</span><br><span class="line">ä¾‹å¦‚è®¾è®¡ç¨¿æ˜¯ 750 å®½ï¼Œåˆ™åº”è¯¥è®¾ç½®ä¸º 75ã€‚</span><br></pre></td></tr></table></figure>

<p>å¤§å¤šæ•°è®¾è®¡ç¨¿çš„åŸå‹éƒ½æ˜¯ä»¥ iphone6 ä¸ºåŸå‹ï¼Œiphone6 è®¾å¤‡çš„å®½æ˜¯ 750ï¼Œæˆ‘ä»¬çš„è®¾è®¡ç¨¿ä¹Ÿæ˜¯è¿™æ ·ã€‚</p>
<p>ä½†æ˜¯ Vant å»ºè®®è®¾ç½®ä¸º 37.5ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸º Vant æ˜¯åŸºäº 375 å†™çš„ï¼Œæ‰€ä»¥å¦‚æœä½ è®¾ç½®ä¸º 75 çš„è¯ï¼ŒVant çš„æ ·å¼å°±å°äº†ä¸€åŠã€‚</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å¦‚æœè®¾ç½®ä¸º <code>37.5</code> çš„è¯ï¼ŒVant çš„æ ·å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æµ‹é‡è®¾è®¡ç¨¿çš„æ—¶å€™éƒ½å¿…é¡»é™¤ 2 æ‰èƒ½ä½¿ç”¨ï¼Œå¦åˆ™å°±ä¼šå˜å¾—å¾ˆå¤§ã€‚</p>
<p>è¿™æ ·åšå…¶å®ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢ï¼Ÿæˆ‘å°±æƒ³å®ç°æµ‹é‡å¤šå°‘å†™å¤šå°‘ï¼ˆä¸ç”¨æ¢ç®—ï¼‰ã€‚äºæ˜¯èªæ˜çš„ä½ å°±æƒ³ï¼Œå¯ä»¥ä¸å¯ä»¥è¿™æ ·æ¥åšï¼Ÿ</p>
<ul>
<li>å¦‚æœæ˜¯ Vant çš„æ ·å¼ï¼Œå°±æŠŠ <code>rootValue</code> è®¾ç½®ä¸º 37.5 æ¥è½¬æ¢</li>
<li>å¦‚æœæ˜¯æˆ‘ä»¬çš„æ ·å¼ï¼Œå°±æŒ‰ç…§ 75 çš„ <code>rootValue</code> æ¥è½¬æ¢</li>
</ul>
<p>é€šè¿‡<a target="_blank" rel="noopener" href="https://github.com/cuth/postcss-pxtorem#options">æŸ¥é˜…æ–‡æ¡£</a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>rootValue</code> æ”¯æŒä¸¤ç§å‚æ•°ç±»å‹ï¼š</p>
<ul>
<li>æ•°å­—ï¼šå›ºå®šå€¼</li>
<li>å‡½æ•°ï¼šåŠ¨æ€è®¡ç®—è¿”å›<ul>
<li>postcss-pxtorem å¤„ç†æ¯ä¸ª CSS æ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šæ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°</li>
<li>å®ƒä¼šæŠŠè¢«å¤„ç†çš„ CSS æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯é€šè¿‡å‚æ•°ä¼ é€’ç»™è¯¥å‡½æ•°</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PostCSS é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// é…ç½®è¦ä½¿ç”¨çš„ PostCSS æ’ä»¶</span></span><br><span class="line">  <span class="attr">plugins</span>: &#123;</span><br><span class="line">    <span class="comment">// é…ç½®ä½¿ç”¨ autoprefixer æ’ä»¶</span></span><br><span class="line">    <span class="comment">// ä½œç”¨ï¼šç”Ÿæˆæµè§ˆå™¨ CSS æ ·å¼è§„åˆ™å‰ç¼€</span></span><br><span class="line">    <span class="comment">// VueCLI å†…éƒ¨å·²ç»é…ç½®äº† autoprefixer æ’ä»¶</span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥åˆé…ç½®äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥äº§ç”Ÿå†²çªäº†</span></span><br><span class="line">    <span class="comment">// &#x27;autoprefixer&#x27;: &#123; // autoprefixer æ’ä»¶çš„é…ç½®</span></span><br><span class="line">    <span class="comment">//   // é…ç½®è¦å…¼å®¹åˆ°çš„ç¯å¢ƒä¿¡æ¯</span></span><br><span class="line">    <span class="comment">//   browsers: [&#x27;Android &gt;= 4.0&#x27;, &#x27;iOS &gt;= 8&#x27;]</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®ä½¿ç”¨ postcss-pxtorem æ’ä»¶</span></span><br><span class="line">    <span class="comment">// ä½œç”¨ï¼šæŠŠ px è½¬ä¸º rem</span></span><br><span class="line">    <span class="string">&quot;postcss-pxtorem&quot;</span>: &#123;</span><br><span class="line">      <span class="title function_">rootValue</span>(<span class="params">&#123; file &#125;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> file.<span class="title function_">indexOf</span>(<span class="string">&quot;vant&quot;</span>) !== -<span class="number">1</span> ? <span class="number">37.5</span> : <span class="number">75</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">propList</span>: [<span class="string">&quot;*&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>é…ç½®å®Œæ¯•ï¼ŒæŠŠæœåŠ¡é‡å¯ä¸€ä¸‹</p>
<h2 id="äºŒã€postcss-px-to-viewport"><a href="#äºŒã€postcss-px-to-viewport" class="headerlink" title="äºŒã€postcss-px-to-viewport"></a>äºŒã€postcss-px-to-viewport</h2><p>åœ¨æœ€è¿‘çš„ä¸€ä¸ªç§»åŠ¨ç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ¡ˆé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå¯¼è‡´æˆ‘ä¸èƒ½å°† px è½¬åŒ–ä¸º remã€‚äºæ˜¯æˆ‘åˆæ‰¾åˆ°äº†å¦å¤–ä¸€ç§æ–¹æ¡ˆ</p>
<p><code>postcss-px-to-viewport</code>æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ’ä»¶ï¼Œå®ƒå°† px è½¬æ¢æˆè§†å£å•ä½ vw <a target="_blank" rel="noopener" href="https://github.com/evrone/postcss-px-to-viewport/blob/master/README_CN.md#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0">https://github.com/evrone/postcss-px-to-viewport/blob/master/README_CN.md#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0</a></p>
<h3 id="2-1-å®‰è£…"><a href="#2-1-å®‰è£…" class="headerlink" title="2.1 å®‰è£…"></a>2.1 å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install postcss-px-to-viewport --save-dev</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add -D postcss-px-to-viewport</span><br></pre></td></tr></table></figure>

<h3 id="2-2-åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ -postcssrc-jsæ–‡ä»¶"><a href="#2-2-åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ -postcssrc-jsæ–‡ä»¶" class="headerlink" title="2.2 åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ .postcssrc.jsæ–‡ä»¶"></a>2.2 åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ <code>.postcssrc.js</code>æ–‡ä»¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: &#123;</span><br><span class="line">    <span class="string">&quot;postcss-px-to-viewport&quot;</span>: &#123;</span><br><span class="line">      <span class="comment">// é…ç½®è¯¦æƒ…å¯è§ https://github.com/evrone/postcss-px-to-viewport/blob/master/README_CN.md#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0</span></span><br><span class="line">      <span class="attr">unitToConvert</span>: <span class="string">&quot;px&quot;</span>,</span><br><span class="line">      <span class="attr">viewportWidth</span>: <span class="number">750</span>,</span><br><span class="line">      <span class="attr">unitPrecision</span>: <span class="number">5</span>,</span><br><span class="line">      <span class="attr">propList</span>: [<span class="string">&quot;*&quot;</span>],</span><br><span class="line">      <span class="attr">viewportUnit</span>: <span class="string">&quot;vw&quot;</span>,</span><br><span class="line">      <span class="attr">fontViewportUnit</span>: <span class="string">&quot;vw&quot;</span>,</span><br><span class="line">      <span class="attr">selectorBlackList</span>: [],</span><br><span class="line">      <span class="attr">minPixelValue</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">mediaQuery</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">replace</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">exclude</span>: [<span class="regexp">/node_modules/</span>],</span><br><span class="line">      <span class="attr">include</span>: <span class="literal">undefined</span>,</span><br><span class="line">      <span class="attr">landscape</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">landscapeUnit</span>: <span class="string">&quot;vw&quot;</span>,</span><br><span class="line">      <span class="attr">landscapeWidth</span>: <span class="number">1920</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æœ€åé‡å¯é¡¹ç›®å³å¯</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-ç§»åŠ¨ç«¯æœç´¢æ å®ç°"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/22/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%90%9C%E7%B4%A2%E6%A0%8F%E5%AE%9E%E7%8E%B0/"
    >ç§»åŠ¨ç«¯æœç´¢æ å®ç°</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/22/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%90%9C%E7%B4%A2%E6%A0%8F%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time datetime="2023-02-22T08:30:58.000Z" itemprop="datePublished">2023-02-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="ä¸€ã€æœç´¢æ å¸¸ç”¨åŠŸèƒ½"><a href="#ä¸€ã€æœç´¢æ å¸¸ç”¨åŠŸèƒ½" class="headerlink" title="ä¸€ã€æœç´¢æ å¸¸ç”¨åŠŸèƒ½"></a>ä¸€ã€æœç´¢æ å¸¸ç”¨åŠŸèƒ½</h2><p>ä¸€èˆ¬æœç´¢æ ä¼šæœ‰æœç´¢è”æƒ³æç¤ºåŠŸèƒ½ã€æœç´¢å†å²å’Œæœç´¢ç»“æœåŠŸèƒ½ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªç»„ä»¶æ‹†åˆ†æˆæœç´¢è”æƒ³å»ºè®®ã€æœç´¢ç»“æœã€æœç´¢å†å²è®°å½•ä¸‰ä¸ªç»„ä»¶</p>
<img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/1566431801892.png" width="250">

<h2 id="äºŒã€åˆ›å»ºçˆ¶ç»„ä»¶å¹¶é…ç½®è·¯ç”±"><a href="#äºŒã€åˆ›å»ºçˆ¶ç»„ä»¶å¹¶é…ç½®è·¯ç”±" class="headerlink" title="äºŒã€åˆ›å»ºçˆ¶ç»„ä»¶å¹¶é…ç½®è·¯ç”±"></a>äºŒã€åˆ›å»ºçˆ¶ç»„ä»¶å¹¶é…ç½®è·¯ç”±</h2><p>1ã€åˆ›å»º <code>src/views/search/index.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;search-container&quot;&gt;</span><br><span class="line">    &lt;!-- æœç´¢æ  --&gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">      Tips: åœ¨ van-search å¤–å±‚å¢åŠ  form æ ‡ç­¾ï¼Œä¸” action ä¸ä¸ºç©ºï¼Œå³å¯åœ¨ iOS è¾“å…¥æ³•ä¸­æ˜¾ç¤ºæœç´¢æŒ‰é’®</span><br><span class="line">     --&gt;</span><br><span class="line">    &lt;form action=&quot;/&quot;&gt;</span><br><span class="line">      &lt;van-search</span><br><span class="line">        v-model=&quot;searchText&quot;</span><br><span class="line">        show-action</span><br><span class="line">        placeholder=&quot;è¯·è¾“å…¥æœç´¢å…³é”®è¯&quot;</span><br><span class="line">        background=&quot;#3296fa&quot;</span><br><span class="line">        @search=&quot;onSearch&quot;</span><br><span class="line">        @cancel=&quot;onCancel&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;!-- /æœç´¢æ  --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- æœç´¢å†å²è®°å½• --&gt;</span><br><span class="line">    &lt;search-history /&gt;</span><br><span class="line">    &lt;!-- /æœç´¢å†å²è®°å½• --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- è”æƒ³å»ºè®® --&gt;</span><br><span class="line">    &lt;search-suggestion /&gt;</span><br><span class="line">    &lt;!-- /è”æƒ³å»ºè®® --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- å†å²è®°å½• --&gt;</span><br><span class="line">    &lt;search-result /&gt;</span><br><span class="line">    &lt;!-- /å†å²è®°å½• --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import SearchHistory from &quot;./components/search-history&quot;;</span><br><span class="line">import SearchSuggestion from &quot;./components/search-suggestion&quot;;</span><br><span class="line">import SearchResult from &quot;./components/search-result&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;SearchIndex&quot;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    SearchHistory,</span><br><span class="line">    SearchSuggestion,</span><br><span class="line">    SearchResult,</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      searchText: &quot;&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;&#125;,</span><br><span class="line">  watch: &#123;&#125;,</span><br><span class="line">  created() &#123;&#125;,</span><br><span class="line">  mounted() &#123;&#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSearch(val) &#123;</span><br><span class="line">      console.log(val);</span><br><span class="line">    &#125;,</span><br><span class="line">    onCancel() &#123;</span><br><span class="line">      this.$router.back();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;less&quot;&gt;</span><br><span class="line">.search-container &#123;</span><br><span class="line">  .van-search__action &#123;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶åæŠŠæœç´¢é¡µé¢çš„è·¯ç”±é…ç½®åˆ°æ ¹ç»„ä»¶è·¯ç”±ï¼ˆä¸€çº§è·¯ç”±ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/search&#x27;</span>,</span><br><span class="line">  <span class="attr">omponent</span>: <span class="title class_">Search</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€æœç´¢å†å²è®°å½•å­ç»„ä»¶"><a href="#ä¸‰ã€æœç´¢å†å²è®°å½•å­ç»„ä»¶" class="headerlink" title="ä¸‰ã€æœç´¢å†å²è®°å½•å­ç»„ä»¶"></a>ä¸‰ã€æœç´¢å†å²è®°å½•å­ç»„ä»¶</h2><p>åˆ›å»º <code>src/views/search/components/search-history.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;search-history&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;æœç´¢å†å²&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>å…¨éƒ¨åˆ é™¤<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>å®Œæˆ<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;hello&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;hello&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;hello&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;hello&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;SearchHistory&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€æœç´¢è”æƒ³å»ºè®®å­ç»„ä»¶"><a href="#å››ã€æœç´¢è”æƒ³å»ºè®®å­ç»„ä»¶" class="headerlink" title="å››ã€æœç´¢è”æƒ³å»ºè®®å­ç»„ä»¶"></a>å››ã€æœç´¢è”æƒ³å»ºè®®å­ç»„ä»¶</h2><p>åˆ›å»º <code>src/views/search/components/search-suggestion.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;search-suggestion&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;é»‘é©¬ç¨‹åºå‘˜...&quot;</span> <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;é»‘é©¬ç¨‹åºå‘˜...&quot;</span> <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;é»‘é©¬ç¨‹åºå‘˜...&quot;</span> <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;é»‘é©¬ç¨‹åºå‘˜...&quot;</span> <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;é»‘é©¬ç¨‹åºå‘˜...&quot;</span> <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;SearchSuggestion&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>äº”ã€æœç´¢ç»“æœå­ç»„ä»¶</p>
<p>åˆ›å»º <code>src/views/search/components/search-result.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;search-result&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-list</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-model</span>=<span class="string">&quot;loading&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:finished</span>=<span class="string">&quot;finished&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">finished-text</span>=<span class="string">&quot;æ²¡æœ‰æ›´å¤šäº†&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">load</span>=<span class="string">&quot;onLoad&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">v-for</span>=<span class="string">&quot;item in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> <span class="attr">:title</span>=<span class="string">&quot;item&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-list</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;SearchResult&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">list</span>: [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">finished</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å¼‚æ­¥æ›´æ–°æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// setTimeout ä»…åšç¤ºä¾‹ï¼ŒçœŸå®åœºæ™¯ä¸­ä¸€èˆ¬ä¸º ajax è¯·æ±‚</span></span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span> + <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// åŠ è½½çŠ¶æ€ç»“æŸ</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// æ•°æ®å…¨éƒ¨åŠ è½½å®Œæˆ</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span> &gt;= <span class="number">40</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">finished</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€å¤„ç†é¡µé¢æ˜¾ç¤ºçŠ¶æ€"><a href="#å…­ã€å¤„ç†é¡µé¢æ˜¾ç¤ºçŠ¶æ€" class="headerlink" title="å…­ã€å¤„ç†é¡µé¢æ˜¾ç¤ºçŠ¶æ€"></a>å…­ã€å¤„ç†é¡µé¢æ˜¾ç¤ºçŠ¶æ€</h2><p><em>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª isResultShow å˜é‡æ¥æ§åˆ¶æœç´¢ç»“æœçš„æ˜¾ç¤ºä¸å¦ã€‚å½“ç”¨æˆ·ç‚¹å‡»ç¡®å®šæˆ–è€…é€‰ä¸­æŸæ¡æœç´¢å†å²è®°å½•æ—¶å±•ç¤ºæœç´¢ç»“æœã€‚è€Œè”æƒ³å»ºè®®å’Œæœç´¢å†å²è®°å½•åˆ™å¯ä»¥é€šè¿‡æœç´¢æ æ˜¯å¦æœ‰å€¼æ¥äº’æ–¥çš„æ˜¾ç¤ºã€‚</em></p>
<p>1ã€åœ¨ <code>data</code> ä¸­æ·»åŠ æ•°æ®ç”¨æ¥æ§åˆ¶æœç´¢ç»“æœçš„æ˜¾ç¤ºçŠ¶æ€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span> () &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="attr">isResultShow</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨æ¨¡æ¿ä¸­ç»‘å®šæ¡ä»¶æ¸²æŸ“</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æœç´¢ç»“æœ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">search-result</span> <span class="attr">v-if</span>=<span class="string">&quot;isResultShow&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /æœç´¢ç»“æœ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è”æƒ³å»ºè®® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">search-suggestion</span> <span class="attr">v-else-if</span>=<span class="string">&quot;searchText&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /è”æƒ³å»ºè®® --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æœç´¢å†å²è®°å½• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">search-history</span> <span class="attr">v-else</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /æœç´¢å†å²è®°å½• --&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æœç´¢è”æƒ³å»ºè®®"><a href="#ä¸ƒã€æœç´¢è”æƒ³å»ºè®®" class="headerlink" title="ä¸ƒã€æœç´¢è”æƒ³å»ºè®®"></a>ä¸ƒã€æœç´¢è”æƒ³å»ºè®®</h2><p>åŸºæœ¬æ€è·¯ï¼š</p>
<ul>
<li>å½“æœç´¢æ¡†è¾“å…¥å†…å®¹çš„æ—¶å€™ï¼Œè¯·æ±‚åŠ è½½è”æƒ³å»ºè®®çš„æ•°æ®</li>
<li>å°†è¯·æ±‚å¾—åˆ°çš„ç»“æœç»‘å®šåˆ°æ¨¡æ¿ä¸­</li>
</ul>
<h3 id="åŸºæœ¬åŠŸèƒ½"><a href="#åŸºæœ¬åŠŸèƒ½" class="headerlink" title="åŸºæœ¬åŠŸèƒ½"></a>åŸºæœ¬åŠŸèƒ½</h3><p>ä¸€ã€å°†çˆ¶ç»„ä»¶ä¸­æœç´¢æ¡†è¾“å…¥çš„å†…å®¹ä¼ ç»™è”æƒ³å»ºè®®å­ç»„ä»¶</p>
<p>äºŒã€åœ¨å­ç»„ä»¶ä¸­ç›‘è§†æœç´¢æ¡†è¾“å…¥å†…å®¹çš„å˜åŒ–ï¼Œå¦‚æœå˜åŒ–åˆ™è¯·æ±‚è·å–è”æƒ³å»ºè®®æ•°æ®</p>
<p>ä¸‰ã€å°†è·å–åˆ°çš„è”æƒ³å»ºè®®æ•°æ®å±•ç¤ºåˆ°åˆ—è¡¨ä¸­</p>
<h3 id="é˜²æŠ–ä¼˜åŒ–"><a href="#é˜²æŠ–ä¼˜åŒ–" class="headerlink" title="é˜²æŠ–ä¼˜åŒ–"></a>é˜²æŠ–ä¼˜åŒ–</h3><p>1ã€å®‰è£… lodash</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yarn add lodash</span></span><br><span class="line">npm i lodash</span><br></pre></td></tr></table></figure>

<p>2ã€é˜²æŠ–å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lodash æ”¯æŒæŒ‰éœ€åŠ è½½ï¼Œæœ‰åˆ©äºæ‰“åŒ…ç»“æœä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">import</span> &#123; debounce &#125; <span class="keyword">from</span> <span class="string">&quot;lodash&quot;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸å»ºè®®ä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼Œå› ä¸ºè¿™æ ·ä¼šåŠ è½½æ•´ä¸ªæ¨¡å—ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&quot;lodash&quot;</span>;</span><br><span class="line">_.<span class="title function_">debounce</span>();</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// debounce å‡½æ•°</span></span><br><span class="line"><span class="comment">// å‚æ•°1ï¼šå‡½æ•°</span></span><br><span class="line"><span class="comment">// å‚æ•°2ï¼šé˜²æŠ–æ—¶é—´</span></span><br><span class="line"><span class="comment">// è¿”å›å€¼ï¼šé˜²æŠ–ä¹‹åçš„å‡½æ•°ï¼Œå’Œå‚æ•°1åŠŸèƒ½æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="attr">onSearchInput</span>: <span class="title function_">debounce</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> searchContent = <span class="variable language_">this</span>.<span class="property">searchContent</span></span><br><span class="line">  <span class="keyword">if</span> (!searchContent) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. è¯·æ±‚è·å–æ•°æ®</span></span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> <span class="title function_">getSuggestions</span>(searchContent)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. å°†æ•°æ®æ·»åŠ åˆ°ç»„ä»¶å®ä¾‹ä¸­</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">suggestions</span> = data.<span class="property">data</span>.<span class="property">options</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. æ¨¡æ¿ç»‘å®š</span></span><br><span class="line">&#125;, <span class="number">200</span>),</span><br></pre></td></tr></table></figure>

<p><strong><em>PC ç«¯çš„è”æƒ³æœç´¢åˆ™å¯ä»¥å€ŸåŠ© elementPlus çš„ Autocomplete è‡ªåŠ¨è¡¥å…¨è¾“å…¥æ¡†ç»„ä»¶è½»æ˜“å®ç°</em></strong></p>
<h2 id="å…«ã€æœç´¢å…³é”®å­—é«˜äº®"><a href="#å…«ã€æœç´¢å…³é”®å­—é«˜äº®" class="headerlink" title="å…«ã€æœç´¢å…³é”®å­—é«˜äº®"></a>å…«ã€æœç´¢å…³é”®å­—é«˜äº®</h2><p>å¦‚ä½•å°†å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå­—ç¬¦åœ¨<strong>ç½‘é¡µ</strong>ä¸­é«˜äº®å±•ç¤ºï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;Hello World&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å°†éœ€è¦é«˜äº®çš„å­—ç¬¦åŒ…è£¹ HTML æ ‡ç­¾ï¼Œä¸ºå…¶å•ç‹¬è®¾ç½®é¢œè‰²ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;Hello &lt;span style=&quot;</span><span class="attr">color</span>: red<span class="string">&quot;&gt;World&lt;/span&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ Vue ä¸­å¦‚ä½•æ¸²æŸ“å¸¦æœ‰ HTML æ ‡ç­¾çš„å­—ç¬¦ä¸²ï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">htmlStr</span>: <span class="string">&#x27;Hello &lt;span style=&quot;color: red&quot;&gt;World&lt;/span&gt;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; htmlStr &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">&quot;htmlStr&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>![image-20200112154732044](E:\web å‰ç«¯å¼€å‘\02-é…å¥—è¯¾ä»¶\005- Vue.js åŸºç¡€åˆ°é«˜çº§é¡¹ç›®å®æˆ˜\é˜¶æ®µäº”ï¼šç¤¾äº¤åª’ä½“-å¤´æ¡é¡¹ç›®èµ„æ–™\å‰ç«¯ vue ç§»åŠ¨ç«¯é¡¹ç›®èµ„æ–™\vue ç§»åŠ¨ç«¯é¡¹ç›®ç¬¬ä¸€å¤©\è®²ä¹‰\è®²ä¹‰\assets\image-20200112154732044.png)</p>
<p>å¦‚ä½•æŠŠå­—ç¬¦ä¸²ä¸­æŒ‡å®šå­—ç¬¦ç»Ÿä¸€æ›¿æ¢ä¸ºé«˜äº®ï¼ˆåŒ…è£¹äº† HTMLï¼‰çš„å­—ç¬¦ï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœï¼š&lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt; World</span></span><br><span class="line"><span class="string">&quot;Hello World&quot;</span>.<span class="title function_">replace</span>(<span class="string">&quot;Hello&quot;</span>, <span class="string">&#x27;&lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œreplace æ–¹æ³•çš„å­—ç¬¦ä¸²åŒ¹é…åªèƒ½æ›¿æ¢ç¬¬1ä¸ªæ»¡è¶³çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment">// &lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt; World Hello abc</span></span><br><span class="line"><span class="string">&quot;Hello World Hello abc&quot;</span>.<span class="title function_">replace</span>(</span><br><span class="line">  <span class="string">&quot;Hello&quot;</span>,</span><br><span class="line">  <span class="string">&#x27;&lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt;&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæƒ³è¦å…¨æ–‡æ›¿æ¢ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">// g å…¨å±€</span></span><br><span class="line"><span class="comment">// i å¿½ç•¥å¤§å°å†™</span></span><br><span class="line"><span class="comment">// &lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt; World &lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt; abc</span></span><br><span class="line"><span class="string">&quot;Hello World Hello abc&quot;</span>.<span class="title function_">replace</span>(</span><br><span class="line">  <span class="regexp">/Hello/gi</span>,</span><br><span class="line">  <span class="string">&#x27;&lt;span style=&quot;color: red&quot;&gt;Hello&lt;/span&gt;&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸€ä¸ªå°æ‰©å±•ï¼šä½¿ç”¨å­—ç¬¦ä¸²çš„ split ç»“åˆæ•°ç»„çš„ join æ–¹æ³•å®ç°é«˜äº®</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;hello world ä½ å¥½ hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [&quot;&quot;, &quot; world ä½ å¥½ &quot;, &quot;&quot;]</span></span><br><span class="line"><span class="keyword">const</span> arr = str.<span class="title function_">split</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;&lt;span&gt;hello&lt;/span&gt; world ä½ å¥½ &lt;span&gt;hello&lt;/span&gt;&quot;</span></span><br><span class="line">arr.<span class="title function_">join</span>(<span class="string">&quot;&lt;span&gt;hello&lt;/span&gt;&quot;</span>);</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¸‹é¢æ˜¯å…·ä½“çš„å¤„ç†ã€‚</p>
<p>1ã€åœ¨ methods ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•å¤„ç†é«˜äº®</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‚æ•° source: åŸå§‹å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">// å‚æ•° keyword: éœ€è¦é«˜äº®çš„å…³é”®è¯</span></span><br><span class="line"><span class="comment">// è¿”å›å€¼ï¼šæ›¿æ¢ä¹‹åçš„é«˜äº®å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="title function_">highlight</span> (source, keyword) &#123;</span><br><span class="line">  <span class="comment">// /searchContent/ æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ä¸€åˆ‡å†…å®¹éƒ½ä¼šå½“åšå­—ç¬¦ä¸²ä½¿ç”¨</span></span><br><span class="line">  <span class="comment">// è¿™é‡Œå¯ä»¥ new RegExp æ–¹å¼æ ¹æ®å­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">  <span class="comment">// RegExp æ˜¯åŸç”Ÿ JavaScript çš„å†…ç½®æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="comment">// å‚æ•°1ï¼šå­—ç¬¦ä¸²ï¼Œæ³¨æ„ï¼Œè¿™é‡Œä¸è¦åŠ  //</span></span><br><span class="line">  <span class="comment">// å‚æ•°2ï¼šåŒ¹é…æ¨¡å¼ï¼Œg å…¨å±€ï¼Œi å¿½ç•¥å¤§å°å†™</span></span><br><span class="line">  <span class="keyword">const</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(keyword, <span class="string">&#x27;gi&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> source.<span class="title function_">replace</span>(reg, <span class="string">`&lt;span style=&quot;color: #3296fa&quot;&gt;<span class="subst">$&#123;keyword&#125;</span>&lt;/span&gt;`</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶ååœ¨è”æƒ³å»ºè®®åˆ—è¡¨é¡¹ä¸­ç»‘å®šè°ƒç”¨</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è”æƒ³å»ºè®® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">van-cell-group</span> <span class="attr">v-else-if</span>=<span class="string">&quot;searchContent&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span></span></span><br><span class="line"><span class="tag">    <span class="attr">icon</span>=<span class="string">&quot;search&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in suggestions&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">click</span>=<span class="string">&quot;onSearch(item)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span> <span class="attr">v-html</span>=<span class="string">&quot;highlight(item, searchContent)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">van-cell-group</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /è”æƒ³å»ºè®® --&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¹ã€æœç´¢ç»“æœ"><a href="#ä¹ã€æœç´¢ç»“æœ" class="headerlink" title="ä¹ã€æœç´¢ç»“æœ"></a>ä¹ã€æœç´¢ç»“æœ</h2><p>æ€è·¯ï¼š</p>
<ul>
<li>æ‰¾åˆ°æ•°æ®æ¥å£</li>
<li>è¯·æ±‚è·å–æ•°æ®</li>
<li>å°†æ•°æ®å±•ç¤ºåˆ°æ¨¡æ¿ä¸­</li>
</ul>
<p>ä¸€ã€è·å–æœç´¢å…³é”®å­—</p>
<p>1ã€å£°æ˜æ¥æ”¶çˆ¶ç»„ä»¶ä¸­çš„æœç´¢æ¡†è¾“å…¥çš„å†…å®¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">  <span class="attr">q</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ é€’æ•°æ®</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æœç´¢ç»“æœ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">search-result</span> <span class="attr">v-if</span>=<span class="string">&quot;isResultShow&quot;</span> <span class="attr">:q</span>=<span class="string">&quot;searchText&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /æœç´¢ç»“æœ --&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ååœ¨è°ƒè¯•å·¥å…·ä¸­æŸ¥çœ‹ç¡®è®¤æ˜¯å¦æ¥æ”¶åˆ° props æ•°æ®ã€‚</p>
<p>![image-20200112162223915](E:\web å‰ç«¯å¼€å‘\02-é…å¥—è¯¾ä»¶\005- Vue.js åŸºç¡€åˆ°é«˜çº§é¡¹ç›®å®æˆ˜\é˜¶æ®µäº”ï¼šç¤¾äº¤åª’ä½“-å¤´æ¡é¡¹ç›®èµ„æ–™\å‰ç«¯ vue ç§»åŠ¨ç«¯é¡¹ç›®èµ„æ–™\vue ç§»åŠ¨ç«¯é¡¹ç›®ç¬¬ä¸€å¤©\è®²ä¹‰\è®²ä¹‰\assets\image-20200112162223915.png)</p>
<p>äºŒã€è¯·æ±‚è·å–æ•°æ®</p>
<p>1ã€åœ¨ <code>api/serach.js</code> æ·»åŠ å°è£…è·å–æœç´¢ç»“æœçš„è¯·æ±‚æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–æœç´¢ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getSearch</span>(<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/app/v1_0/search&quot;</span>,</span><br><span class="line">    params,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€è¯·æ±‚è·å–</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="keyword">import</span> &#123; getSearch &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/search&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;SearchResult&#x27;</span>,</span><br><span class="line">  <span class="attr">components</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">q</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">require</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">data</span> () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">list</span>: [],</span><br><span class="line">      <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">finished</span>: <span class="literal">false</span>,</span><br><span class="line">+      <span class="attr">page</span>: <span class="number">1</span>,</span><br><span class="line">+      <span class="attr">perPage</span>: <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">computed</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">watch</span>: &#123;&#125;,</span><br><span class="line">  <span class="title function_">created</span> () &#123;&#125;,</span><br><span class="line">  <span class="title function_">mounted</span> () &#123;&#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">+++    <span class="keyword">async</span> <span class="title function_">onLoad</span> () &#123;</span><br><span class="line">      <span class="comment">// 1. è¯·æ±‚è·å–æ•°æ®</span></span><br><span class="line">      <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> <span class="title function_">getSearch</span>(&#123;</span><br><span class="line">        <span class="attr">page</span>: <span class="variable language_">this</span>.<span class="property">page</span>, <span class="comment">// é¡µç </span></span><br><span class="line">        <span class="attr">per_page</span>: <span class="variable language_">this</span>.<span class="property">perPage</span>, <span class="comment">// æ¯é¡µå¤§å°</span></span><br><span class="line">        <span class="attr">q</span>: <span class="variable language_">this</span>.<span class="property">q</span> <span class="comment">// æœç´¢å…³é”®å­—</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 2. å°†æ•°æ®æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span></span><br><span class="line">      <span class="keyword">const</span> &#123; results &#125; = data.<span class="property">data</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(...results)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 3. è®¾ç½®åŠ è½½çŠ¶æ€ç»“æŸ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 4. åˆ¤æ–­æ•°æ®æ˜¯å¦åŠ è½½å®Œæ¯•</span></span><br><span class="line">      <span class="keyword">if</span> (results.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">page</span>++ <span class="comment">// æ›´æ–°è·å–ä¸‹ä¸€é¡µæ•°æ®çš„é¡µç </span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">finished</span> = <span class="literal">true</span> <span class="comment">// æ²¡æœ‰æ•°æ®äº†ï¼Œå°†åŠ è½½çŠ¶æ€è®¾ç½®ç»“æŸï¼Œä¸å† onLoad</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‰ã€æœ€åï¼Œæ¨¡æ¿ç»‘å®š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">van-list</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">&quot;loading&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:finished</span>=<span class="string">&quot;finished&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">finished-text</span>=<span class="string">&quot;æ²¡æœ‰æ›´å¤šäº†&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">load</span>=<span class="string">&quot;onLoad&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span></span></span><br><span class="line"><span class="tag">    +</span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;(article, index) in list&quot;</span></span></span><br><span class="line"><span class="tag">    +</span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">    +</span></span><br><span class="line"><span class="tag">    <span class="attr">:title</span>=<span class="string">&quot;article.title&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">van-list</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="åã€æœç´¢å†å²è®°å½•"><a href="#åã€æœç´¢å†å²è®°å½•" class="headerlink" title="åã€æœç´¢å†å²è®°å½•"></a>åã€æœç´¢å†å²è®°å½•</h2><h3 id="æ·»åŠ å†å²è®°å½•"><a href="#æ·»åŠ å†å²è®°å½•" class="headerlink" title="æ·»åŠ å†å²è®°å½•"></a>æ·»åŠ å†å²è®°å½•</h3><p>å½“å‘ç”Ÿæœç´¢çš„æ—¶å€™æˆ‘ä»¬æ‰éœ€è¦è®°å½•å†å²è®°å½•ã€‚</p>
<p>1ã€åœ¨ data ä¸­æ·»åŠ ä¸€ä¸ªæ•°æ®ç”¨æ¥å­˜å‚¨å†å²è®°å½•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">searchHistories</span>: []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨è§¦å‘æœç´¢çš„æ—¶å€™ï¼Œè®°å½•å†å²è®°å½•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onSearch</span> (val) &#123;</span><br><span class="line">  <span class="comment">// æ›´æ–°æ–‡æœ¬æ¡†å†…å®¹</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">searchText</span> = val</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å­˜å‚¨æœç´¢å†å²è®°å½•</span></span><br><span class="line">  <span class="comment">// è¦æ±‚ï¼šä¸è¦æœ‰é‡å¤å†å²è®°å½•ã€æœ€æ–°çš„æ’åœ¨æœ€å‰é¢</span></span><br><span class="line">  <span class="keyword">const</span> index = <span class="variable language_">this</span>.<span class="property">searchHistories</span>.<span class="title function_">indexOf</span>(val)</span><br><span class="line">  <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">searchHistories</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">searchHistories</span>.<span class="title function_">unshift</span>(val)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¸²æŸ“æœç´¢ç»“æœ</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isResultShow</span> = <span class="literal">true</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="å±•ç¤ºå†å²è®°å½•"><a href="#å±•ç¤ºå†å²è®°å½•" class="headerlink" title="å±•ç¤ºå†å²è®°å½•"></a>å±•ç¤ºå†å²è®°å½•</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å†å²è®°å½• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">van-cell-group</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;å†å²è®°å½•&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>å…¨éƒ¨åˆ é™¤<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>å®Œæˆ<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">:title</span>=<span class="string">&quot;item&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in searchHistories&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">van-cell-group</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /å†å²è®°å½• --&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤å†å²è®°å½•"><a href="#åˆ é™¤å†å²è®°å½•" class="headerlink" title="åˆ é™¤å†å²è®°å½•"></a>åˆ é™¤å†å²è®°å½•</h3><p>åŸºæœ¬æ€è·¯ï¼š</p>
<ul>
<li>ç»™å†å²è®°å½•ä¸­çš„æ¯ä¸€é¡¹æ³¨å†Œç‚¹å‡»äº‹ä»¶</li>
<li>åœ¨å¤„ç†å‡½æ•°ä¸­åˆ¤æ–­<ul>
<li>å¦‚æœæ˜¯åˆ é™¤çŠ¶æ€ï¼Œåˆ™æ‰§è¡Œåˆ é™¤æ“ä½œ</li>
<li>å¦‚æœæ˜¯éåˆ é™¤çŠ¶æ€ï¼Œåˆ™æ‰§è¡Œæœç´¢æ“ä½œ</li>
</ul>
</li>
</ul>
<p>ä¸€ã€å¤„ç†åˆ é™¤ç›¸å…³å…ƒç´ çš„å±•ç¤ºçŠ¶æ€</p>
<p>1ã€åœ¨ data ä¸­æ·»åŠ ä¸€ä¸ªæ•°æ®ç”¨æ¥æ§åˆ¶åˆ é™¤ç›¸å…³å…ƒç´ çš„æ˜¾ç¤ºçŠ¶æ€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">isDeleteShow</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€ç»‘å®šä½¿ç”¨</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å†å²è®°å½• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">van-cell-group</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;å†å²è®°å½•&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;isDeleteShow&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;searchHistories = []&quot;</span>&gt;</span>å…¨éƒ¨åˆ é™¤<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;isDeleteShow = false&quot;</span>&gt;</span>å®Œæˆ<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">v-else</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isDeleteShow = true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:title</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in searchHistories&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">click</span>=<span class="string">&quot;onSearch(item)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-show</span>=<span class="string">&quot;isDeleteShow&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;close&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;searchHistories.splice(index, 1)&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">van-icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">van-cell-group</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /å†å²è®°å½• --&gt;</span></span><br></pre></td></tr></table></figure>

<p>äºŒã€å¤„ç†åˆ é™¤æ“ä½œ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å†å²è®°å½• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">van-cell-group</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">&quot;å†å²è®°å½•&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;isDeleteShow&quot;</span>&gt;</span></span><br><span class="line">      + <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;searchHistories = []&quot;</span>&gt;</span>å…¨éƒ¨åˆ é™¤<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;isDeleteShow = false&quot;</span>&gt;</span>å®Œæˆ<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">v-else</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isDeleteShow = true&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:title</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in searchHistories&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">    +</span></span><br><span class="line"><span class="tag">    @<span class="attr">click</span>=<span class="string">&quot;onHistoryClick(item, index)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">v-show</span>=<span class="string">&quot;isDeleteShow&quot;</span> <span class="attr">name</span>=<span class="string">&quot;close&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">van-icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">van-cell-group</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- /å†å²è®°å½• --&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onHistoryClick</span> (item, index) &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯åˆ é™¤çŠ¶æ€ï¼Œåˆ™æ‰§è¡Œåˆ é™¤æ“ä½œ</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isDeleteShow</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">searchHistories</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¦åˆ™æ‰§è¡Œæœç´¢æ“ä½œ</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">onSearch</span>(item)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•°æ®æŒä¹…åŒ–"><a href="#æ•°æ®æŒä¹…åŒ–" class="headerlink" title="æ•°æ®æŒä¹…åŒ–"></a>æ•°æ®æŒä¹…åŒ–</h3><p>1ã€åˆ©ç”¨ watch ç›‘è§†ç»Ÿä¸€å­˜å‚¨æ•°æ®</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  <span class="title function_">searchHistories</span> (val) &#123;</span><br><span class="line">    <span class="comment">// åŒæ­¥åˆ°æœ¬åœ°å­˜å‚¨</span></span><br><span class="line">    <span class="title function_">setItem</span>(<span class="string">&#x27;serach-histories&#x27;</span>, val)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>2ã€åˆå§‹åŒ–çš„æ—¶å€™ä»æœ¬åœ°å­˜å‚¨è·å–æ•°æ®</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">searchHistories</span>: <span class="title function_">getItem</span>(<span class="string">&#x27;serach-histories&#x27;</span>) || [],</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-ES6è¡¥å……"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/11/ES6%E8%A1%A5%E5%85%85/"
    >ES6è¡¥å……</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/11/ES6%E8%A1%A5%E5%85%85/" class="article-date">
  <time datetime="2023-02-11T14:48:05.000Z" itemprop="datePublished">2023-02-11</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><em>æ›´å¤šè¯·å‚è€ƒ</em></p>
<p><em>é˜®ä¸€å³°è€å¸ˆ ES6 å…¥é—¨æ•™ç¨‹<a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/">https://es6.ruanyifeng.com/</a></em></p>
<p><em>MDN å®˜æ–¹æ–‡æ¡£<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/">https://developer.mozilla.org/zh-CN/</a></em></p>
<h2 id="ä¸€ã€ä½œç”¨åŸŸ"><a href="#ä¸€ã€ä½œç”¨åŸŸ" class="headerlink" title="ä¸€ã€ä½œç”¨åŸŸ"></a>ä¸€ã€ä½œç”¨åŸŸ</h2><h3 id="1ã€ä½œç”¨åŸŸé“¾"><a href="#1ã€ä½œç”¨åŸŸé“¾" class="headerlink" title="1ã€ä½œç”¨åŸŸé“¾"></a>1ã€ä½œç”¨åŸŸé“¾</h3><p>ä½œç”¨åŸŸé“¾æœ¬è´¨ä¸Šæ˜¯åº•å±‚çš„å˜é‡æŸ¥æ‰¾æœºåˆ¶ã€‚åœ¨å‡½æ•°è¢«æ‰§è¡Œæ—¶ï¼Œä¼šä¼˜å…ˆæŸ¥æ‰¾å½“å‰å‡½æ•°ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å˜é‡ï¼Œå¦‚æœå½“å‰ä½œç”¨åŸŸæŸ¥æ‰¾ä¸åˆ°åˆ™ä¼šä¾æ¬¡é€çº§æŸ¥æ‰¾çˆ¶çº§ä½œç”¨åŸŸç›´åˆ°å…¨å±€ä½œç”¨åŸŸã€‚è¿™ç§åµŒå¥—å…³ç³»çš„ä½œç”¨åŸŸä¸²è”èµ·æ¥å°±å½¢æˆäº†ä½œç”¨åŸŸé“¾</p>
<h3 id="2ã€JS-åƒåœ¾å›æ”¶æœºåˆ¶"><a href="#2ã€JS-åƒåœ¾å›æ”¶æœºåˆ¶" class="headerlink" title="2ã€JS åƒåœ¾å›æ”¶æœºåˆ¶"></a>2ã€JS åƒåœ¾å›æ”¶æœºåˆ¶</h3><p>åƒåœ¾å›æ”¶æœºåˆ¶(Garbage Collection) ç®€ç§° GC</p>
<p>JS ä¸­å†…å­˜çš„åˆ†é…å’Œå›æ”¶éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå†…å­˜åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™ä¼šè¢«åƒåœ¾å›æ”¶å™¨è‡ªåŠ¨å›æ”¶</p>
<p>è™½ç„¶åƒåœ¾å›æ”¶å™¨ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨å›æ”¶å†…å­˜ï¼Œä½†æˆ‘ä»¬ä»æœ‰å¿…è¦äº†è§£ JS çš„å†…å­˜ç®¡ç†æœºåˆ¶ã€‚å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£å†…å­˜æ³„æ¼ï¼ˆå†…å­˜æ— æ³•è¢«å›æ”¶ï¼‰</p>
<p>ä¸å†ç”¨åˆ°çš„å†…å­˜ï¼Œæ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œå°±å«åšå†…å­˜æ³„æ¼</p>
<p>å†…å­˜çš„ç”Ÿå‘½å‘¨æœŸ</p>
<p>JS ç¯å¢ƒä¸­åˆ†é…çš„å†…å­˜, ä¸€èˆ¬æœ‰å¦‚ä¸‹ç”Ÿå‘½å‘¨æœŸï¼š</p>
<ol>
<li><p>å†…å­˜åˆ†é…ï¼šå½“æˆ‘ä»¬å£°æ˜å˜é‡ã€å‡½æ•°ã€å¯¹è±¡çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºä»–ä»¬åˆ†é…å†…å­˜</p>
</li>
<li><p>å†…å­˜ä½¿ç”¨ï¼šå³è¯»å†™å†…å­˜ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å˜é‡ã€å‡½æ•°ç­‰</p>
</li>
<li><p>å†…å­˜å›æ”¶ï¼šä½¿ç”¨å®Œæ¯•ï¼Œç”±åƒåœ¾å›æ”¶è‡ªåŠ¨å›æ”¶ä¸å†ä½¿ç”¨çš„å†…å­˜</p>
</li>
</ol>
<p>è¯´æ˜ï¼š</p>
<p>å…¨å±€å˜é‡ä¸€èˆ¬ä¸ä¼šå›æ”¶(å…³é—­é¡µé¢å›æ”¶)ï¼›</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹å±€éƒ¨å˜é‡çš„å€¼, ä¸ç”¨äº†, ä¼šè¢«è‡ªåŠ¨å›æ”¶æ‰</p>
<p>ä¸¤ç§å¸¸è§çš„æµè§ˆå™¨åƒåœ¾å›æ”¶ç®—æ³•</p>
<p>å¼•ç”¨è®¡æ•°æ³•</p>
<p>IE é‡‡ç”¨çš„å¼•ç”¨è®¡æ•°ç®—æ³•, å®šä¹‰â€œå†…å­˜ä¸å†ä½¿ç”¨â€ï¼Œå°±æ˜¯çœ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰æŒ‡å‘å®ƒçš„å¼•ç”¨ï¼Œæ²¡æœ‰å¼•ç”¨äº†å°±å›æ”¶å¯¹è±¡</p>
<p>å…·ä½“æ­¥éª¤ï¼š</p>
<ol>
<li><p>è·Ÿè¸ªè®°å½•è¢«å¼•ç”¨çš„æ¬¡æ•°</p>
</li>
<li><p>å¦‚æœè¢«å¼•ç”¨äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±è®°å½•æ¬¡æ•° 1,å¤šæ¬¡å¼•ç”¨ä¼šç´¯åŠ </p>
</li>
<li><p>å¦‚æœå‡å°‘ä¸€ä¸ªå¼•ç”¨å°±å‡ 1</p>
</li>
<li><p>å½“å¼•ç”¨æ¬¡æ•°æ˜¯ 0 æ—¶ ï¼Œåˆ™é‡Šæ”¾å†…å­˜</p>
</li>
</ol>
<p>å®ƒå­˜åœ¨ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼šåµŒå¥—å¼•ç”¨ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰</p>
<p>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸äº’å¼•ç”¨ï¼Œå°½ç®¡ä»–ä»¬å·²ä¸å†ä½¿ç”¨ï¼Œåƒåœ¾å›æ”¶å™¨ä¸ä¼šè¿›è¡Œå›æ”¶ï¼Œå¯¼è‡´å†…å­˜æ³„éœ²ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> o1 = &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> o2 = &#123;&#125;;</span><br><span class="line">  o1.<span class="property">a</span> = o2;</span><br><span class="line">  o2.<span class="property">a</span> = o1;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;å¼•ç”¨è®¡æ•°æ— æ³•å›æ”¶&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();</span><br></pre></td></tr></table></figure>

<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸Šè¿°ä»£ç ä¸­çš„å˜é‡ o1ã€o2 åœ¨å‡½æ•° fn æ‰§è¡Œå®Œæ¯•ä¹‹åå°±åº”è¯¥è¢«å›æ”¶æ‰ï¼Œä½†æ˜¯æ ¹æ®å¼•ç”¨è®¡æ•°æ³•ï¼Œè™½ç„¶å‡½æ•° fn å·²ç»æ‰§è¡Œå®Œæˆï¼Œä½†æ˜¯ç”±äº o1ã€o2 ä¸­å­˜åœ¨ç€ç›¸äº’å¼•ç”¨çš„å…³ç³»ï¼Œå› æ­¤å®é™…ä¸Šå¹¶ä¸ä¼šè¢«å›æ”¶ï¼Œè¿™å°±é€ æˆäº†å†…å­˜æ³„æ¼ã€‚äºæ˜¯å°±æœ‰äº†æ ‡è®°æ¸…é™¤æ³•</p>
<p>æ ‡è®°æ¸…é™¤æ³•</p>
<p>ç°ä»£çš„æµè§ˆå™¨å·²ç»ä¸å†ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•äº†</p>
<p>ç°ä»£æµè§ˆå™¨é€šç”¨çš„å¤§å¤šæ˜¯åŸºäºæ ‡è®°æ¸…é™¤ç®—æ³•çš„æŸäº›æ”¹è¿›ç®—æ³•ï¼Œæ€»ä½“æ€æƒ³éƒ½æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>æ ¸å¿ƒï¼š</p>
<ol>
<li><p>æ ‡è®°æ¸…é™¤ç®—æ³•å°†â€œä¸å†ä½¿ç”¨çš„å¯¹è±¡â€å®šä¹‰ä¸ºâ€œæ— æ³•è¾¾åˆ°çš„å¯¹è±¡â€ã€‚</p>
</li>
<li><p>å°±æ˜¯ä»æ ¹éƒ¨ï¼ˆåœ¨ JS ä¸­å°±æ˜¯å…¨å±€å¯¹è±¡ï¼‰å‡ºå‘å®šæ—¶æ‰«æå†…å­˜ä¸­çš„å¯¹è±¡ã€‚ å‡¡æ˜¯èƒ½ä»æ ¹éƒ¨åˆ°è¾¾çš„å¯¹è±¡ï¼Œéƒ½æ˜¯è¿˜éœ€è¦ä½¿ç”¨çš„ã€‚</p>
</li>
<li><p>é‚£äº›æ— æ³•ç”±æ ¹éƒ¨å‡ºå‘è§¦åŠåˆ°çš„å¯¹è±¡è¢«æ ‡è®°ä¸ºä¸å†ä½¿ç”¨ï¼Œç¨åè¿›è¡Œå›æ”¶ã€‚</p>
</li>
</ol>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230510142831343.png" alt="image-20230510142831343"></p>
<p>åŒæ ·ä¸Šè¿°çš„ä»£ç ï¼Œå¦‚æœç”¨æ ‡è®°æ¸…é™¤æ³•ï¼Œåœ¨å‡½æ•° fn æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå‡½æ•°ä½œç”¨åŸŸé‡Œé¢çš„å˜é‡ï¼Œä»å…¨å±€å¯¹è±¡å¼€å§‹å·²ç»è®¿é—®ä¸åˆ°äº†ï¼Œå› æ­¤ä¼šè¢«å›æ”¶æ‰</p>
<h3 id="3ã€é—­åŒ…"><a href="#3ã€é—­åŒ…" class="headerlink" title="3ã€é—­åŒ…"></a>3ã€é—­åŒ…</h3><p>MDN å®˜æ–¹è§£é‡Šï¼šä¸€ä¸ªå‡½æ•°å¯¹å‘¨å›´çŠ¶æ€çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼Œå†…å±‚å‡½æ•°ä¸­è®¿é—®åˆ°å…¶å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸ</p>
<p>ä»ä»£ç ç»“æ„ä¸Šçœ‹ï¼Œé—­åŒ… &#x3D; å†…å±‚å‡½æ•° + å¤–å±‚å‡½æ•°çš„å˜é‡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">inner</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">outer</span>();</span><br></pre></td></tr></table></figure>

<p>é—­åŒ…ä½œç”¨ï¼šå°é—­æ•°æ®ï¼Œæä¾›æ“ä½œï¼Œå¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®å‡½æ•°å†…éƒ¨çš„å˜é‡</p>
<p>é—­åŒ…çš„åŸºæœ¬å½¢å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fun = <span class="title function_">outer</span>();</span><br><span class="line"><span class="title function_">fun</span>();</span><br></pre></td></tr></table></figure>

<p>é—­åŒ…åº”ç”¨ï¼šå®ç°æ•°æ®çš„ç§æœ‰</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦åšä¸ªç»Ÿè®¡å‡½æ•°è°ƒç”¨æ¬¡æ•°ï¼Œå‡½æ•°è°ƒç”¨ä¸€æ¬¡ï¼Œå°±++</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params"></span>) &#123;</span><br><span class="line">  i++;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`å‡½æ•°è¢«è°ƒç”¨äº†<span class="subst">$&#123;i&#125;</span>æ¬¡`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">count</span>(); <span class="comment">// 2</span></span><br><span class="line"><span class="title function_">count</span>(); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™æ ·å®šä¹‰çš„å…¨å±€å˜é‡ i å¾ˆå®¹æ˜“è¢«ä¿®æ”¹ï¼Œä¸€æ—¦ä¿®æ”¹ï¼Œç»Ÿè®¡çš„å‡½æ•°è°ƒç”¨æ¬¡æ•°å°±ä¸å‡†ç¡®äº†ã€‚å¯ä»¥é€šè¿‡é—­åŒ…è§£å†³è¿™ä¸ªé—®é¢˜</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    i++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`å‡½æ•°è¢«è°ƒç”¨äº†<span class="subst">$&#123;i&#125;</span>æ¬¡`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fun = <span class="title function_">count</span>();</span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 2</span></span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å®ç°äº†æ•°æ®ç§æœ‰ï¼Œæ— æ³•ç›´æ¥ä¿®æ”¹ count</p>
<h2 id="äºŒã€æ·±å…¥å¯¹è±¡"><a href="#äºŒã€æ·±å…¥å¯¹è±¡" class="headerlink" title="äºŒã€æ·±å…¥å¯¹è±¡"></a>äºŒã€æ·±å…¥å¯¹è±¡</h2><p>åˆ›å»ºå¯¹è±¡çš„ä¸‰ç§æ–¹å¼</p>
<ul>
<li><p>åˆ©ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡</p>
</li>
<li><p>åˆ©ç”¨ new Object åˆ›å»ºå¯¹è±¡</p>
</li>
<li><p>åˆ©ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡</p>
</li>
</ul>
<h3 id="1ã€æ„é€ å‡½æ•°"><a href="#1ã€æ„é€ å‡½æ•°" class="headerlink" title="1ã€æ„é€ å‡½æ•°"></a>1ã€æ„é€ å‡½æ•°</h3><p>æ„é€ å‡½æ•° ï¼šæ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œä¸»è¦ç”¨æ¥åˆå§‹åŒ–å¯¹è±¡</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šå¸¸è§„çš„ {â€¦} è¯­æ³•å…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚æ¯”å¦‚æˆ‘ä»¬åˆ›å»ºäº†ä½©å¥‡çš„å¯¹è±¡ï¼Œç»§ç»­åˆ›å»ºä¹”æ²»çš„å¯¹è±¡è¿˜éœ€è¦é‡æ–°å†™ä¸€ éã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ï¼Œå®ƒå°±åƒä¸€ä¸ªæ¨¡å­ä¸€æ ·ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºå¤šä¸ªç±»ä¼¼çš„å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xiaoming = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">gender</span>: <span class="string">&#x27;ç”·&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> xiaohong = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°çº¢&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span>,</span><br><span class="line">  <span class="attr">gender</span>: <span class="string">&#x27;å¥³&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™ç§ç±»ä¼¼çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æ¥åˆ›å»º</span></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ª&quot;äººç±»&quot;çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name,age,gender</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gender</span> = gender</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€šè¿‡å®ä¾‹åŒ–æ¥æ‰¹é‡ç”Ÿäº§â€œäººç±»â€</span></span><br><span class="line"><span class="keyword">const</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;å°æ˜&#x27;</span>ï¼Œ<span class="number">18</span>ï¼Œ<span class="string">&#x27;ç”·&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> xiaohong = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;å°çº¢&#x27;</span>ï¼Œ<span class="number">18</span>ï¼Œ<span class="string">&#x27;å¥³&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ„é€ å‡½æ•°æœ¬è´¨ä¸Šä¹Ÿå‡½æ•°ï¼Œä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼š</p>
<ul>
<li><p>å®ƒä»¬çš„å‘½åä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œä»¥è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°</p>
</li>
<li><p>å®ƒä»¬åªèƒ½ç”± â€œnewâ€ æ“ä½œç¬¦æ¥æ‰§è¡Œ</p>
</li>
</ul>
<p>new Object()ã€new Date()è¿™äº›éƒ½æ˜¯å†…ç½®çš„æ„é€ å‡½æ•°</p>
<p>æ„é€ å‡½æ•°çš„å®ä¾‹åŒ–æ‰§è¡Œè¿‡ç¨‹</p>
<ol>
<li><p>åˆ›å»ºæ–°å¯¹è±¡</p>
<p>2.æ„é€ å‡½æ•° this æŒ‡å‘æ–°å¯¹è±¡</p>
<p>3.æ‰§è¡Œæ„é€ å‡½æ•°ä»£ç ï¼Œä¿®æ”¹ thisï¼Œæ·»åŠ æ–°çš„å±æ€§</p>
<p>4.è¿”å›æ–°å¯¹è±¡</p>
</li>
</ol>
<p>å®ä¾‹æˆå‘˜&amp;é™æ€æˆå‘˜</p>
<p>å®ä¾‹æˆå‘˜ï¼šé€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡ç§°ä¸ºå®ä¾‹å¯¹è±¡ï¼Œå®ä¾‹å¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³•ç§°ä¸ºå®ä¾‹æˆå‘˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, gender</span>) &#123;</span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°ä¸­ç›´æ¥å£°æ˜çš„è¿™äº›æ–¹æ³•å’Œå±æ€§å°±æ˜¯å®ä¾‹æˆå‘˜</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç›´æ¥ä¸ºæ„é€ å‡½æ•°æ·»åŠ çš„è¿™äº›æ–¹æ³•å’Œå±æ€§å°±æ˜¯é™æ€æˆå‘˜</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property">say</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¼šè¯´è¯&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼š</p>
<ul>
<li>æ„é€ å‡½æ•°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡å½¼æ­¤ç‹¬ç«‹äº’ä¸å½±å“</li>
<li>ä¸€èˆ¬å…¬å…±ç‰¹å¾çš„å±æ€§æˆ–æ–¹æ³•é™æ€æˆå‘˜è®¾ç½®ä¸ºé™æ€æˆå‘˜</li>
<li>é™æ€æˆå‘˜æ–¹æ³•ä¸­çš„ this æŒ‡å‘æ„é€ å‡½æ•°æœ¬èº«</li>
</ul>
<h3 id="2ã€å†…ç½®æ„é€ å‡½æ•°"><a href="#2ã€å†…ç½®æ„é€ å‡½æ•°" class="headerlink" title="2ã€å†…ç½®æ„é€ å‡½æ•°"></a>2ã€å†…ç½®æ„é€ å‡½æ•°</h3><p>å¼•ç”¨ç±»å‹ï¼šObjectï¼ŒArrayï¼ŒRegExpï¼ŒDate ç­‰</p>
<p>åŒ…è£…ç±»å‹ï¼šStringï¼ŒNumberï¼ŒBoolean ç­‰</p>
<p>æ•°ç»„å¸¸è§å®ä¾‹æ–¹æ³•-æ ¸å¿ƒæ–¹æ³•</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511084102099.png" alt="image-20230511084102099"></p>
<p>reduce è¯­æ³•</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511084301258.png" alt="image-20230511084301258"></p>
<p>æ±‚å’Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> result = arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, current</span>) =&gt;</span> prev + current);</span><br></pre></td></tr></table></figure>

<p>æ•°ç»„å¸¸è§å®ä¾‹æ–¹æ³•-å…¶ä»–æ–¹æ³•</p>
<ol>
<li>å®ä¾‹æ–¹æ³• <code>join</code> æ•°ç»„å…ƒç´ æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²ï¼Œè¿”å›å­—ç¬¦ä¸²(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>find</code> æŸ¥æ‰¾å…ƒç´ ï¼Œ è¿”å›ç¬¦åˆæµ‹è¯•æ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ å€¼ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„åˆ™è¿”å› undefined(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³•<code>every</code> æ£€æµ‹æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ç¬¦åˆæŒ‡å®šæ¡ä»¶ï¼Œå¦‚æœ<strong>æ‰€æœ‰å…ƒç´ </strong>éƒ½é€šè¿‡æ£€æµ‹è¿”å› trueï¼Œå¦åˆ™è¿”å› false(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³•<code>some</code> æ£€æµ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶ <strong>å¦‚æœæ•°ç»„ä¸­æœ‰</strong>å…ƒç´ æ»¡è¶³æ¡ä»¶è¿”å› trueï¼Œå¦åˆ™è¿”å› false</li>
<li>å®ä¾‹æ–¹æ³• <code>concat</code> åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼Œè¿”å›ç”Ÿæˆæ–°æ•°ç»„</li>
<li>å®ä¾‹æ–¹æ³• <code>sort</code> å¯¹åŸæ•°ç»„å•å…ƒå€¼æ’åº</li>
<li>å®ä¾‹æ–¹æ³• <code>splice</code> åˆ é™¤æˆ–æ›¿æ¢åŸæ•°ç»„å•å…ƒ</li>
<li>å®ä¾‹æ–¹æ³•<code>slice</code>è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡æ˜¯ä¸€ä¸ªç”± begin å’Œ end å†³å®šçš„åŸæ•°ç»„çš„æµ…æ‹·è´ï¼ˆåŒ…æ‹¬ beginï¼Œä¸åŒ…æ‹¬ endï¼‰ï¼ˆæ­¤æˆªå–æ–¹æ³•å­—ç¬¦ä¸²ä¹Ÿæœ‰ï¼‰</li>
<li>å®ä¾‹æ–¹æ³• <code>reverse</code> åè½¬æ•°ç»„</li>
<li>å®ä¾‹æ–¹æ³• <code>findIndex</code> è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚è‹¥æ²¡æœ‰æ‰¾åˆ°å¯¹åº”å…ƒç´ åˆ™è¿”å› -1</li>
<li>å®ä¾‹æ–¹æ³•<code>includes</code>ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œæ ¹æ®æƒ…å†µï¼Œå¦‚æœåŒ…å«åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false</li>
<li>å®ä¾‹æ–¹æ³•<code>push</code>æ·»åŠ å…ƒç´ åˆ°æ•°ç»„æœ«å°¾</li>
<li>å®ä¾‹æ–¹æ³•<code>pop</code>ï¼ˆå¼¹å‡ºï¼‰åˆ é™¤æ•°ç»„æœ«å°¾çš„å…ƒç´ </li>
<li>å®ä¾‹æ–¹æ³•<code>shift</code>åˆ é™¤æ•°ç»„å¤´éƒ¨å…ƒç´ </li>
<li>å®ä¾‹æ–¹æ³•<code>unshift</code>æ·»åŠ å…ƒç´ åˆ°æ•°ç»„çš„å¤´éƒ¨</li>
<li>å®ä¾‹æ–¹æ³•<code>indexOf</code>è¿”å›æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°ç»™å®šå…ƒç´ çš„ä¸‹æ ‡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› -1</li>
<li>å®ä¾‹æ–¹æ³•<code>fill</code>ç”¨ä¸€ä¸ªå›ºå®šå€¼å¡«å……ä¸€ä¸ªæ•°ç»„ä¸­ä»èµ·å§‹ç´¢å¼•åˆ°ç»ˆæ­¢ç´¢å¼•å†…çš„å…¨éƒ¨å…ƒç´ ã€‚ä¸åŒ…æ‹¬ç»ˆæ­¢ç´¢å¼•</li>
</ol>
<p>æ•°ç»„å¸¸è§é™æ€æ–¹æ³•</p>
<ol>
<li>Array.from()ï¼šå¯¹ä¸€ä¸ªä¼ªæ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹</li>
<li>Array.isArray()ï¼šç”¨äºç¡®å®šä¼ é€’çš„å€¼æ˜¯å¦æ˜¯ä¸€ä¸ª Array</li>
</ol>
<p>String å¸¸è§å®ä¾‹æ–¹æ³•</p>
<p>åœ¨ JavaScript ä¸­çš„å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å…·æœ‰å¯¹è±¡çš„ä½¿ç”¨ç‰¹å¾ï¼Œå¦‚å…·æœ‰å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬æ˜¯ JavaScript åº•å±‚ä½¿ç”¨ Object æ„é€ å‡½æ•°â€œåŒ…è£…â€æ¥çš„</p>
<p>String å¸¸è§å®ä¾‹æ–¹æ³•</p>
<ol>
<li>å®ä¾‹å±æ€§ <code>length</code> ç”¨æ¥è·å–å­—ç¬¦ä¸²çš„åº¦é•¿(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>split(&#39;åˆ†éš”ç¬¦&#39;)</code> ç”¨æ¥å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆæ•°ç»„(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>substringï¼ˆéœ€è¦æˆªå–çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•[,ç»“æŸçš„ç´¢å¼•å·]ï¼‰</code> ç”¨äºå­—ç¬¦ä¸²æˆªå–(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>startsWith(æ£€æµ‹å­—ç¬¦ä¸²[, æ£€æµ‹ä½ç½®ç´¢å¼•å·])</code> æ£€æµ‹æ˜¯å¦ä»¥æŸå­—ç¬¦å¼€å¤´(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>includes(æœç´¢çš„å­—ç¬¦ä¸²[, æ£€æµ‹ä½ç½®ç´¢å¼•å·])</code> åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ ¹æ®æƒ…å†µè¿”å› true æˆ– false(é‡ç‚¹)</li>
<li>å®ä¾‹æ–¹æ³• <code>toUpperCase</code> ç”¨äºå°†å­—æ¯è½¬æ¢æˆå¤§å†™</li>
<li>å®ä¾‹æ–¹æ³• <code>toLowerCase</code> ç”¨äºå°†å°±è½¬æ¢æˆå°å†™</li>
<li>å®ä¾‹æ–¹æ³• <code>indexOf</code> æ£€æµ‹æ˜¯å¦åŒ…å«æŸå­—ç¬¦</li>
<li>å®ä¾‹æ–¹æ³• <code>endsWith</code> æ£€æµ‹æ˜¯å¦ä»¥æŸå­—ç¬¦ç»“å°¾</li>
<li>å®ä¾‹æ–¹æ³• <code>replace</code> ç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…</li>
<li>å®ä¾‹æ–¹æ³• <code>match</code> ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…</li>
<li>å®ä¾‹æ–¹æ³•<code>trim</code>ä»å­—ç¬¦ä¸²çš„ä¸¤ç«¯æ¸…é™¤ç©ºæ ¼ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸ä¿®æ”¹åŸå§‹å­—ç¬¦ä¸²</li>
<li>å®ä¾‹æ–¹æ³•<code>slice</code> æ–¹æ³•æå–æŸä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä¸”ä¸ä¼šæ”¹åŠ¨åŸå­—ç¬¦ä¸²</li>
</ol>
<p>Number å¸¸è§æ–¹æ³•</p>
<ol>
<li>å®ä¾‹æ–¹æ³•<code>toFixed</code>è®¾ç½®ä¿ç•™å°æ•°ä½çš„é•¿åº¦</li>
<li>é™æ€æ–¹æ³• <code>Number.parseInt()</code> æ–¹æ³•ä¾æ®æŒ‡å®šåŸºæ•°ï¼Œè§£æå­—ç¬¦ä¸²å¹¶è¿”å›ä¸€ä¸ªæ•´æ•°ã€‚</li>
<li>é™æ€æ–¹æ³•<code>Number.parseFloat()</code> æ–¹æ³•å¯ä»¥æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è§£ææˆæµ®ç‚¹æ•°</li>
</ol>
<p>Date å¸¸è§æ–¹æ³•</p>
<ol>
<li>å®ä¾‹æ–¹æ³•<code>toLocaleString</code>æ–¹æ³•è¿”å›è¯¥æ—¥æœŸå¯¹è±¡çš„å­—ç¬¦ä¸²</li>
<li>å®ä¾‹æ–¹æ³•<code>toLocaleDateString</code> æ–¹æ³•è¿”å›æŒ‡å®šæ—¥æœŸå¯¹è±¡æ—¥æœŸéƒ¨åˆ†çš„å­—ç¬¦ä¸²</li>
<li>å®ä¾‹æ–¹æ³•<code>getDate</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡ä¸ºä¸€ä¸ªæœˆä¸­çš„å“ªä¸€æ—¥ï¼ˆ<code>1</code>-<code>31</code>ï¼‰</li>
<li>å®ä¾‹æ–¹æ³•<code>getDay</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡æ˜¯åœ¨ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼ˆ<code>0</code>-<code>6</code>ï¼‰ï¼Œ0 è¡¨ç¤ºæ˜ŸæœŸå¤©</li>
<li>å®ä¾‹æ–¹æ³•<code>getFullYear</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡çš„å®Œæ•´å¹´ä»½ï¼ˆå››ä½æ•°å¹´ä»½ï¼‰</li>
<li>å®ä¾‹æ–¹æ³•<code>getHours</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡çš„å°æ—¶ï¼ˆ<code>0</code>â€“<code>23</code>ï¼‰</li>
<li>å®ä¾‹æ–¹æ³•<code>getMinutes</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡çš„åˆ†é’Ÿæ•°ï¼ˆ<code>0</code>â€“<code>59</code>ï¼‰</li>
<li>å®ä¾‹æ–¹æ³•<code>getMonth</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡çš„æœˆä»½ï¼ˆ<code>0</code>â€“<code>11</code>ï¼‰ï¼Œ0 è¡¨ç¤ºä¸€å¹´ä¸­çš„ç¬¬ä¸€æœˆ</li>
<li>å®ä¾‹æ–¹æ³•<code>getSeconds</code>æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡çš„ç§’æ•°ï¼ˆ<code>0</code>â€“<code>59ï¼‰</code></li>
<li>å®ä¾‹æ–¹æ³•<code>getTime</code>è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä» 1970 å¹´ 1 æœˆ 1 æ—¥ 0 æ—¶ 0 åˆ† 0 ç§’ï¼ˆUTCï¼Œå³åè°ƒä¸–ç•Œæ—¶ï¼‰è·ç¦»è¯¥ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a> å¯¹è±¡æ‰€ä»£è¡¨æ—¶é—´çš„æ¯«ç§’æ•°ï¼ˆæ—¶é—´æˆ³ï¼‰</li>
<li>é™æ€æ–¹æ³•<code>Date.now()</code>è¿”å›è‡ª 1970-1-1 00:00:00 UTCï¼ˆä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼‰è‡³ä»Šæ‰€ç»è¿‡çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)</li>
</ol>
<p>Math å¸¸è§æ–¹æ³•</p>
<ol>
<li><p>é™æ€æ–¹æ³•<code>Math.floor(x)</code>è¿”å›å°äºä¸€ä¸ªæ•°çš„æœ€å¤§æ•´æ•°ï¼Œå³ä¸€ä¸ªæ•°å‘ä¸‹å–æ•´åçš„å€¼</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.ceil(x)</code>è¿”å›å¤§äºä¸€ä¸ªæ•°çš„æœ€å¤§æ•´æ•°ï¼Œå³ä¸€ä¸ªæ•°å‘ä¸Šå–æ•´åçš„å€¼</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.max(x,y,...)</code>è¿”å›é›¶åˆ°å¤šä¸ªæ•°å€¼ä¸­æœ€å¤§å€¼</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.min(x,y,...)</code>è¿”å›é›¶åˆ°å¤šä¸ªæ•°å€¼ä¸­æœ€å°å€¼</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.pow(x,y)</code>è¿”å›ä¸€ä¸ªæ•°çš„ y æ¬¡å¹‚</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.random()</code>è¿”å›ä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„ä¼ªéšæœºæ•°</p>
</li>
<li><p>é™æ€æ–¹æ³•<code>Math.round(x)</code>è¿”å›å››èˆäº”å…¥åçš„æ•´æ•°</p>
</li>
</ol>
<h2 id="ä¸‰ã€é¢å‘å¯¹è±¡"><a href="#ä¸‰ã€é¢å‘å¯¹è±¡" class="headerlink" title="ä¸‰ã€é¢å‘å¯¹è±¡"></a>ä¸‰ã€é¢å‘å¯¹è±¡</h2><h3 id="1ã€é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³"><a href="#1ã€é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³" class="headerlink" title="1ã€é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³"></a>1ã€é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³</h3><p>é¢å‘è¿‡ç¨‹ç¼–ç¨‹</p>
<p>é¢å‘è¿‡ç¨‹å°±æ˜¯åˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä½¿ç”¨çš„æ—¶å€™å†ä¸€ä¸ªä¸€ä¸ªçš„ä¾æ¬¡è°ƒç”¨</p>
<p>ä¼˜ç‚¹ï¼šæ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Œé€‚åˆè·Ÿç¡¬ä»¶è”ç³»å¾ˆç´§å¯†çš„ä¸œè¥¿ï¼Œä¾‹å¦‚å•ç‰‡æœºå°±é‡‡ç”¨çš„é¢å‘è¿‡ç¨‹ç¼–ç¨‹</p>
<p>ç¼ºç‚¹ï¼šæ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•</p>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ (oop)</p>
<p>é¢å‘å¯¹è±¡æ˜¯æŠŠäº‹åŠ¡åˆ†è§£æˆä¸ºä¸€ä¸ªä¸ªå¯¹è±¡ï¼Œç„¶åç”±å¯¹è±¡ä¹‹é—´åˆ†å·¥ä¸åˆä½œ</p>
<p>åœ¨é¢å‘å¯¹è±¡ç¨‹åºå¼€å‘æ€æƒ³ä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯åŠŸèƒ½ä¸­å¿ƒï¼Œå…·æœ‰æ˜ç¡®åˆ†å·¥ã€‚</p>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹å…·æœ‰çµæ´»ã€ä»£ç å¯å¤ç”¨ã€å®¹æ˜“ç»´æŠ¤å’Œå¼€å‘çš„ä¼˜ç‚¹ï¼Œæ›´é€‚åˆå¤šäººåˆä½œçš„å¤§å‹è½¯ä»¶é¡¹ç›®</p>
<p>é¢å‘å¯¹è±¡çš„ç‰¹æ€§ï¼š</p>
<ul>
<li>å°è£…æ€§</li>
<li>ç»§æ‰¿æ€§</li>
<li>å¤šæ€æ€§</li>
</ul>
<p>ä¼˜ç‚¹ï¼šæ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ï¼Œç”±äºé¢å‘å¯¹è±¡æœ‰å°è£… ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€æ›´åŠ æ˜“äºç»´æŠ¤</p>
<p>ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½</p>
<h3 id="2ã€å°è£…"><a href="#2ã€å°è£…" class="headerlink" title="2ã€å°è£…"></a>2ã€å°è£…</h3><p>JavaScript ä¸­å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°å®ç°é¢å‘å¯¹è±¡çš„å°è£…</p>
<p>å°†ç›¸åŒçš„ç»“æ„å°è£…åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œé€šè¿‡ this æŒ‡å‘å®ç°æ•°æ®çš„å…±äº«ã€‚å¹¶ä¸”é€šè¿‡æ„é€ å‡½æ•°åˆ›é€ å‡ºæ¥çš„å®ä¾‹å¯¹è±¡ä¹‹é—´å½¼æ­¤ç‹¬ç«‹ã€äº’ä¸å½±å“</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, gender</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sing</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯´è¯&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> ldh = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;åˆ˜å¾·å&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> zxy = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å¼ å­¦å‹&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">sing</span> === zxy.<span class="property">sing</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œï¼Œç”±äºæ„é€ å‡½æ•°åˆ›é€ å‡ºæ¥çš„å®ä¾‹å¯¹è±¡ä¹‹é—´å½¼æ­¤ç‹¬ç«‹ã€äº’ä¸å½±å“ã€‚æˆ‘ä»¬ä¼šå‘ç°<code>ldh.sing</code>å’Œ<code>zxy.sing</code>å¹¶ä¸ç›¸ç­‰ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºå®é™…ä¸Šæ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆæ¯”å¦‚<code>ldh</code>å’Œ<code>zxy</code>ï¼‰ä¹‹é—´çš„<code>sing</code>æ–¹æ³•åº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œä»–ä»¬å®ç°çš„æ˜¯ç›¸åŒçš„åŠŸèƒ½ï¼Œå› æ­¤æ²¡å¿…è¦å•ç‹¬ç»™å®ƒä»¬å„è‡ªåˆ†é…å†…å­˜ã€‚</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511101913432.png" alt="image-20230511101913432"></p>
<p>åŸå‹</p>
<p>ä½¿ç”¨åŸå‹å¯¹è±¡å°±å¯ä»¥å®ç°æ–¹æ³•çš„å…±äº«</p>
<ul>
<li>æ„é€ å‡½æ•°é€šè¿‡åŸå‹åˆ†é…çš„å‡½æ•°æ˜¯æ‰€æœ‰å®ä¾‹å¯¹è±¡æ‰€å…±äº«çš„</li>
<li>JavaScript è§„å®šï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿç§°ä¸ºåŸå‹å¯¹è±¡</li>
<li>è¿™ä¸ªå¯¹è±¡å¯ä»¥æŒ‚è½½å‡½æ•°ï¼Œå¯¹è±¡å®ä¾‹åŒ–ä¸ä¼šå¤šæ¬¡åˆ›å»ºåŸå‹ä¸Šçš„å‡½æ•°ï¼ŒèŠ‚çº¦å†…å­˜</li>
<li>æˆ‘ä»¬å¯ä»¥æŠŠé‚£äº›ä¸å˜çš„æ–¹æ³•ï¼Œç›´æ¥å®šä¹‰åœ¨ prototype å¯¹è±¡ä¸Šï¼Œè¿™æ ·æ‰€æœ‰å¯¹è±¡çš„å®ä¾‹å°±å¯ä»¥å…±äº«è¿™äº›æ–¹æ³•</li>
<li><strong><em>æ„é€ å‡½æ•°å’ŒåŸå‹å¯¹è±¡ä¸­çš„ this éƒ½æŒ‡å‘å®ä¾‹åŒ–çš„å¯¹è±¡</em></strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, gender</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sing</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯´è¯&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> ldh = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;åˆ˜å¾·å&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> zxy = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å¼ å­¦å‹&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">sing</span> === zxy.<span class="property">sing</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>constructor å±æ€§</p>
<p>æ¯ä¸ªåŸå‹å¯¹è±¡é‡Œé¢éƒ½æœ‰ä¸ª constructor å±æ€§ï¼ˆconstructor æ„é€ å‡½æ•°ï¼‰</p>
<p>è¯¥å±æ€§æŒ‡å‘è¯¥åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°</p>
<p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<p>å¦‚æœæœ‰å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç»™åŸå‹å¯¹è±¡é‡‡å–å¯¹è±¡å½¢å¼èµ‹å€¼. ä½†æ˜¯è¿™æ ·å°±ä¼šè¦†ç›–æ„é€ å‡½æ•°åŸå‹å¯¹è±¡åŸæ¥çš„å†…å®¹ï¼Œè¿™æ ·ä¿®æ”¹åçš„åŸå‹å¯¹è±¡ constructor å°±ä¸å†æŒ‡å‘å½“å‰æ„é€ å‡½æ•°äº† ã€‚ä¹Ÿå°±æ˜¯è¯´æ­£å¸¸æƒ…å†µä¸‹ï¼ŒåŸå‹å¯¹è±¡ä¸Šæ˜¯å­˜åœ¨ç€ constructor å±æ€§çš„ï¼Œç°åœ¨æˆ‘ä»¬æƒ³å¾€åŸå‹å¯¹è±¡ä¸ŠæŒ‚è½½å¤šä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä¸æƒ³ä¸€ä¸ªä¸€ä¸ªçš„æ·»åŠ ï¼Œäºæ˜¯æˆ‘ä»¬é‡‡ç”¨ç›´æ¥èµ‹å€¼çš„æ–¹å¼ã€‚ä½†æ˜¯æˆ‘ä»¬é€šè¿‡èµ‹å€¼çš„å½¢å¼å¾€åŸå‹å¯¹è±¡ä¸ŠæŒ‚è½½æ–¹æ³•åï¼ŒæŠŠåŸæ¥çš„åŸå‹å¯¹è±¡ä¸Šçš„ constructor å±æ€§è¦†ç›–æ‰äº†ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿®æ”¹åçš„åŸå‹å¯¹è±¡ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª constructor æŒ‡å‘åŸæ¥çš„æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, gender</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  å¤šä¸ªæ–¹æ³•æŒ‚è½½åˆ°åŸå‹å¯¹è±¡ä¸Šï¼Œä¸ºäº†æ–¹ä¾¿ä¸æƒ³ä¸€ä¸ªä¸€ä¸ªçš„æŒ‚è½½</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sing</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯´è¯&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">dance</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è·³èˆ&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// äºæ˜¯ç›´æ¥ç»™prototypeå±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="attr">sing</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯´è¯&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">dance</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è·³èˆ&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//  ä½†æ˜¯è¿™æ ·ï¼ŒåŸæœ¬åŸå‹å¯¹è±¡prototypeä¸Šçš„constructor å±æ€§å°±è¢«èµ‹å€¼ç»™è¦†ç›–æ‰äº†</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="comment">// å› æ­¤åˆ©ç”¨constructorï¼Œæ‰‹åŠ¨æŒ‡å›Personæ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="attr">constructor</span>: <span class="title class_">Person</span>,</span><br><span class="line">  <span class="attr">sing</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯´è¯&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">dance</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è·³èˆ&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> ldh = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;åˆ˜å¾·å&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> zxy = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å¼ å­¦å‹&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">sing</span> === zxy.<span class="property">sing</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å½“æˆ‘ä»¬æŠŠåŸæœ¬æ”¾åœ¨æ„é€ å‡½æ•°ä¸Šçš„ä¸€äº›å…¬å…±å±æ€§æˆ–æ–¹æ³•æ”¾åˆ°åŸå‹å¯¹è±¡ä¸Šåï¼Œå®ä¾‹å¯¹è±¡å¦‚ä½•è®¿é—®åˆ°åŸå‹å¯¹è±¡ä¸Šçš„å…¬å…±å±æ€§æˆ–æ–¹æ³•å‘¢ï¼Ÿ</p>
<p><em>proto</em></p>
<p>å¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªå±æ€§ <strong>proto</strong> æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype åŸå‹å¯¹è±¡ï¼Œä¹‹æ‰€ä»¥æˆ‘ä»¬å¯¹è±¡å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•° prototype åŸå‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°±æ˜¯å› ä¸ºå¯¹è±¡æœ‰ <strong>proto</strong> åŸå‹çš„å­˜åœ¨</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511105014332.png" alt="image-20230511105014332"></p>
<h3 id="3ã€åŸå‹ç»§æ‰¿"><a href="#3ã€åŸå‹ç»§æ‰¿" class="headerlink" title="3ã€åŸå‹ç»§æ‰¿"></a>3ã€åŸå‹ç»§æ‰¿</h3><p>ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¦ä¸€ä¸ªç‰¹å¾ï¼Œé€šè¿‡ç»§æ‰¿è¿›ä¸€æ­¥æå‡ä»£ç å°è£…çš„ç¨‹åº¦ï¼ŒJavaScript ä¸­å¤§å¤šæ˜¯å€ŸåŠ©åŸå‹å¯¹è±¡å®ç°ç»§æ‰¿çš„ç‰¹æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­å›½äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Chinese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">header</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;chinese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ—¥æœ¬äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Japanese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">header</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;japanese&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°ï¼Œä¸ç®¡æ˜¯ä¸­å›½äººè¿˜æ˜¯æ—¥æœ¬äººï¼Œä»–ä»¬éƒ½å±äºäººç±»ã€‚å› æ­¤å¯ä»¥å°†äººç±»çš„ä¸€äº›å…¬å…±ç‰¹å¾æŠ½å–å‡ºæ¥ï¼Œå•ç‹¬å°è£…æˆä¸€ä¸ªäººç±»çš„æ„é€ å‡½æ•°ï¼Œè®©ä¸­å›½äººå’Œæ—¥æœ¬äººå…±äº«è¿™ä¸ªæ„é€ å‡½æ•°çš„å±æ€§å’Œæ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°è£…ä¸€ä¸ªäººç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Human</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">header</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸­å›½äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Chinese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;chinese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ—¥æœ¬äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Japanese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;japanese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€šè¿‡æ”¹å˜ä¸­å›½äººå’Œæ—¥æœ¬äººçš„åŸå‹å¯¹è±¡æŒ‡å‘åˆ°Humanï¼Œä»¥æ­¤ç»§æ‰¿Humanä¸Šçš„æ–¹æ³•å’Œå±æ€§</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Human</span>;</span><br><span class="line"><span class="comment">// ä¸è¦å¿˜äº†constructor æŒ‡å›Chinese</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Chinese</span>;</span><br><span class="line"><span class="comment">// åŒç†æ—¥æœ¬äºº</span></span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Human</span>;</span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Japanese</span>;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ­¤æ—¶ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬å‘å•ç‹¬ç»™ Chinese æ·»åŠ ä¸€ä¸ªå±æ€§æˆ–è€…æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç° Japanese ä¹Ÿè¢«è‡ªåŠ¨æ·»åŠ äº†è¿™ä¸ªå±æ€§æˆ–æ–¹æ³•ã€‚å¹¶ä¸”ç”±äº<code>Japanese.prototype.constructor</code>æ˜¯åæ¥å®šä¹‰çš„ï¼Œå®ƒå°†<code>Chinese.prototype.constructor = Chinese</code>è¦†ç›–æ‰äº†ï¼Œå› æ­¤<code>Chinese.prototype.constructor</code>ç«Ÿç„¶ä¹ŸæŒ‡å‘äº†<code>Japanese</code>ï¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°è£…ä¸€ä¸ªäººç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Human</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">header</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸­å›½äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Chinese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;chinese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ—¥æœ¬äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Japanese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;japanese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€šè¿‡æ”¹å˜ä¸­å›½äººå’Œæ—¥æœ¬äººçš„åŸå‹å¯¹è±¡æŒ‡å‘åˆ°Humanï¼Œä»¥æ­¤ç»§æ‰¿Humanä¸Šçš„æ–¹æ³•å’Œå±æ€§</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Human</span>;</span><br><span class="line"><span class="comment">// ä¸è¦å¿˜äº†constructor æŒ‡å›Chinese</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Chinese</span>;</span><br><span class="line"><span class="comment">// åŒç†æ—¥æœ¬äºº</span></span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Human</span>;</span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Japanese</span>;</span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">smoking</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æŠ½çƒŸ&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Chinese</span>();</span><br><span class="line"><span class="keyword">const</span> guitian = <span class="keyword">new</span> <span class="title class_">Japanese</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xiaoming, guitian);</span><br></pre></td></tr></table></figure>

<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511111944145.png" alt="image-20230511111944145"></p>
<p>è¿™æ˜¯å› ä¸º<code>Chinese.prototype</code>å’Œ<code>Japanese.prototype</code>éƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘äº†æ„é€ å‡½æ•°<code>Human</code>çš„åœ°å€ï¼Œé€šè¿‡<code>Chinese.prototype.smoking</code>ä¿®æ”¹äº†<code>Human</code>çš„å€¼ï¼Œ<code>Japanese.prototype</code>ä¹Ÿä¼šå—åˆ°å½±å“ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†<code>Chinese.prototype</code>å’Œ<code>Japanese.prototype</code>å„è‡ªæŒ‡å‘ä¸€ä¸ª Human çš„å®ä¾‹å¯¹è±¡ï¼Œè¿™æ ·å®ƒä»¬å°±äº’ä¸å½±å“äº†ï¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°è£…ä¸€ä¸ªäººç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Human</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">header</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸­å›½äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Chinese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;chinese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ—¥æœ¬äººçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Japanese</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">language</span> = <span class="string">&quot;japanese&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€šè¿‡æ”¹å˜ä¸­å›½äººå’Œæ—¥æœ¬äººçš„åŸå‹å¯¹è±¡æŒ‡å‘åˆ°Humanï¼Œä»¥æ­¤ç»§æ‰¿Humanä¸Šçš„æ–¹æ³•å’Œå±æ€§</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Human</span>();</span><br><span class="line"><span class="comment">// ä¸è¦å¿˜äº†constructor æŒ‡å›Chinese</span></span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Chinese</span>;</span><br><span class="line"><span class="comment">// åŒç†æ—¥æœ¬äºº</span></span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Human</span>();</span><br><span class="line"><span class="title class_">Japanese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Japanese</span>;</span><br><span class="line"><span class="title class_">Chinese</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">smoking</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æŠ½çƒŸ&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Chinese</span>();</span><br><span class="line"><span class="keyword">const</span> guitian = <span class="keyword">new</span> <span class="title class_">Japanese</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xiaoming, guitian);</span><br></pre></td></tr></table></figure>

<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511115553081.png" alt="image-20230511115553081"></p>
<p>åŸå‹é“¾</p>
<p>åŸºäºåŸå‹å¯¹è±¡çš„ç»§æ‰¿ä½¿å¾—ä¸åŒæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡å…³è”åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”è¿™ç§å…³è”çš„å…³ç³»æ˜¯ä¸€ç§é“¾çŠ¶çš„ç»“æ„ï¼Œæˆ‘ä»¬å°†åŸå‹å¯¹ è±¡çš„é“¾çŠ¶ç»“æ„å…³ç³»ç§°ä¸ºåŸå‹é“¾</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511115754927.png" alt="image-20230511115754927"></p>
<p>åŸå‹é“¾-æŸ¥æ‰¾è§„åˆ™</p>
<p>å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼ˆåŒ…æ‹¬æ–¹æ³•ï¼‰æ—¶ï¼Œé¦–å…ˆæŸ¥æ‰¾è¿™ä¸ªå¯¹è±¡è‡ªèº«æœ‰æ²¡æœ‰è¯¥å±æ€§ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å°±æŸ¥æ‰¾å®ƒçš„åŸå‹ï¼ˆä¹Ÿå°±æ˜¯ <strong>proto</strong>æŒ‡å‘çš„ prototype åŸå‹å¯¹è±¡ï¼‰</p>
<p>å¦‚æœè¿˜æ²¡æœ‰å°±æŸ¥æ‰¾åŸå‹å¯¹è±¡çš„åŸå‹ï¼ˆObject çš„åŸå‹å¯¹è±¡ï¼‰</p>
<p>ä¾æ­¤ç±»æ¨ä¸€ç›´æ‰¾åˆ° Object ä¸ºæ­¢ï¼ˆnullï¼‰</p>
<p><strong>proto</strong>å¯¹è±¡åŸå‹çš„æ„ä¹‰å°±åœ¨äºä¸ºå¯¹è±¡æˆå‘˜æŸ¥æ‰¾æœºåˆ¶æä¾›ä¸€ä¸ªæ–¹å‘ï¼Œæˆ–è€…è¯´ä¸€æ¡è·¯çº¿</p>
<p>å¯ä»¥ä½¿ç”¨ instanceof è¿ç®—ç¬¦æ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Š</p>
<h3 id="4ã€æ·±æµ…æ‹·è´"><a href="#4ã€æ·±æµ…æ‹·è´" class="headerlink" title="4ã€æ·±æµ…æ‹·è´"></a>4ã€æ·±æµ…æ‹·è´</h3><p>å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦å¤åˆ¶ä¸€ä¸ªå¼•ç”¨ç±»å‹ã€‚å¦‚æœç›´æ¥èµ‹å€¼ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªå€¼æ—¶ï¼Œå¦ä¸€ä¸ªå€¼ä¹Ÿå˜äº†</p>
<p>æµ…æ‹·è´å’Œæ·±æ‹·è´åªé’ˆå¯¹å¼•ç”¨ç±»å‹</p>
<p>æµ…æ‹·è´å¸¸è§æ–¹æ³•ï¼š</p>
<ul>
<li>æ‹·è´å¯¹è±¡ï¼šObject.assgin() &#x2F; å±•å¼€è¿ç®—ç¬¦</li>
<li>æ‹·è´æ•°ç»„ï¼šArray.prototype.concat() æˆ–è€…å±•å¼€è¿ç®—ç¬¦</li>
</ul>
<p>ä½†æ˜¯å¦‚æœå¼•ç”¨æ•°æ®ç±»å‹é‡Œé¢å‡ºç°äº†åµŒå¥—å¼•ç”¨æ•°æ®ç±»å‹çš„æƒ…å†µï¼Œæ·±æ‹·è´å°±åˆä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œè¿™æ—¶éœ€è¦æ·±æ‹·è´</p>
<p>æ·±æ‹·è´å¸¸è§æ–¹æ³•ï¼š</p>
<ul>
<li>é€šè¿‡é€’å½’å®ç°æ·±æ‹·è´</li>
<li>lodash åº“ cloneDeep å‡½æ•°</li>
<li>é€šè¿‡ JSON.stringify()å®ç°</li>
</ul>
<p>é€’å½’</p>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨å†…éƒ¨è°ƒç”¨å…¶æœ¬èº«ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±æ˜¯é€’å½’å‡½æ•°</p>
<p>ç”±äºé€’å½’å¾ˆå®¹æ˜“å‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ï¼ˆstack overflowï¼‰ï¼Œæ‰€ä»¥å¿…é¡»è¦åŠ é€€å‡ºæ¡ä»¶ return</p>
<p>åˆ©ç”¨é€’å½’å‡½æ•°å®ç° setTimeout æ¨¡æ‹Ÿ setInterval æ•ˆæœ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toLocaleString</span>());</span><br><span class="line">  <span class="built_in">setTimeout</span>(getTime, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getTime</span>();</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨é€’å½’å‡½æ•°å®ç°åŸºæœ¬çš„æ·±æ‹·è´</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepCopy</span>(<span class="params">newData, oldData</span>) &#123;</span><br><span class="line">  <span class="comment">// éå†åŸå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> oldData) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (oldData[k] <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span><br><span class="line">      newData[k] = [];</span><br><span class="line">      <span class="title function_">deepCopy</span>(newData[k], oldData[k]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldData[k] <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯å¯¹è±¡</span></span><br><span class="line">      newData[k] = &#123;&#125;;</span><br><span class="line">      <span class="title function_">deepCopy</span>(newData[k], oldData[k]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// åŸºæœ¬æ•°æ®ç±»å‹ç›´æ¥èµ‹å€¼</span></span><br><span class="line">      newData[k] = oldData[k];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ JSON.stringify()å®ç°æ·±æ‹·è´</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;ä½©å¥‡&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">hobby</span>: [<span class="string">&quot;æŠ½çƒŸ&quot;</span>, <span class="string">&quot;å–é…’&quot;</span>, <span class="string">&quot;çƒ«å¤´&quot;</span>],</span><br><span class="line">  <span class="attr">family</span>: &#123;</span><br><span class="line">    <span class="attr">sister</span>: <span class="string">&quot;ä¹”æ²»&quot;</span>,</span><br><span class="line">    <span class="attr">father</span>: <span class="string">&quot;çŒªçˆ¸çˆ¸&quot;</span>,</span><br><span class="line">    <span class="attr">mother</span>: <span class="string">&quot;çŒªå¦ˆå¦ˆ&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj));</span><br></pre></td></tr></table></figure>

<p><em>JSON.stringify()å¯ä»¥å°† JS å¯¹è±¡è½¬åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼ŒJSON å­—ç¬¦ä¸²å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°±ä¸å­˜åœ¨æ‰€è°“çš„åœ°å€å¼•ç”¨äº†</em></p>
<h3 id="5ã€å¼‚å¸¸å¤„ç†"><a href="#5ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="5ã€å¼‚å¸¸å¤„ç†"></a>5ã€å¼‚å¸¸å¤„ç†</h3><p>throw æŠ›å¼‚å¸¸</p>
<p>å¼‚å¸¸å¤„ç†æ˜¯æŒ‡é¢„ä¼°ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼Œç„¶åæœ€å¤§ç¨‹åº¦çš„é¿å…é”™è¯¯çš„å‘ç”Ÿå¯¼è‡´æ•´ä¸ªç¨‹åºæ— æ³•ç»§ç»­è¿è¡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!x || !y) &#123;</span><br><span class="line">    <span class="comment">// throw &#x27;å‚æ•°ä¸èƒ½ä¸ºç©ºï¼&#x27;</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;å‚æ•°ä¸èƒ½ä¸ºç©ºï¼&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">222</span>);</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">counter</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">333</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511144023536.png" alt="image-20230511144023536"></p>
<ul>
<li>throw æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œæ•´ä¸ªç¨‹åºä¹Ÿä¼šç»ˆæ­¢æ‰§è¡Œ</li>
<li>throw åé¢è·Ÿçš„æ˜¯é”™è¯¯æç¤ºä¿¡æ¯,å¯ä»¥ç›´æ¥è·Ÿå­—ç¬¦ä¸²</li>
<li>Error å¯¹è±¡é…åˆ throw ä½¿ç”¨ï¼Œèƒ½å¤Ÿè®¾ç½®æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</li>
</ul>
<p>try &#x2F;catch æ•è·å¼‚å¸¸</p>
<p>å¯ä»¥é€šè¿‡ try &#x2F; catch æ•è·é”™è¯¯ä¿¡æ¯ï¼ˆæµè§ˆå™¨æä¾›çš„é”™è¯¯ä¿¡æ¯ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.p&quot;</span>);</span><br><span class="line">    p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>);</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;finallyæ‰§è¡Œäº†ï¼&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯å‡½æ•°fnä¸­çš„æœ€åæ‰“å°&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯å‡½æ•°fnå¤–çš„æ‰“å°&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>å°†é¢„ä¼°å¯èƒ½å‘ç”Ÿé”™è¯¯çš„ä»£ç å†™åœ¨ try ä»£ç æ®µä¸­</li>
<li>å¦‚æœ try ä»£ç æ®µä¸­å‡ºç°é”™è¯¯åï¼Œä¼šæ‰§è¡Œ catch ä»£ç æ®µï¼Œå¹¶æˆªè·åˆ°é”™è¯¯ä¿¡æ¯</li>
<li>finally ä¸ç®¡æ˜¯å¦æœ‰é”™è¯¯ï¼Œéƒ½ä¼šæ‰§è¡Œ</li>
<li>ä½¿ç”¨ try &#x2F; catch æ•è·é”™è¯¯ä¿¡æ¯ï¼Œå‘ç”Ÿå¼‚å¸¸åç¨‹åºä¸ä¼šç»ˆæ­¢æ‰§è¡Œ</li>
</ul>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511145301739.png" alt="image-20230511145301739"></p>
<p>debugger</p>
<p>å¯ä»¥åœ¨ä»£ç ä¸­ç”¨ debugger æ‰“æ–­ç‚¹è°ƒè¯•ç¨‹åºï¼Œå®ƒå’Œæˆ‘ä»¬åœ¨æ§åˆ¶å°æ‰“æ–­ç‚¹çš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
<h3 id="6ã€this"><a href="#6ã€this" class="headerlink" title="6ã€this"></a>6ã€this</h3><p>this æŒ‡å‘</p>
<ul>
<li>æ™®é€šå‡½æ•°ä¸­çš„ thisï¼šæŒ‡å‘ window</li>
<li>æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡ä¸­çš„ thisï¼šæŒ‡å‘å®ä¾‹åŒ–å¯¹è±¡</li>
<li>å¯¹è±¡ä¸­çš„æ–¹æ³•ä¸­çš„ thisï¼šæŒ‡å‘è¯¥å¯¹è±¡</li>
<li>å®šæ—¶å™¨ã€å»¶æ—¶å™¨ä¸­çš„ thisï¼šæŒ‡å‘ window</li>
<li>äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ thisï¼šæŒ‡å‘äº‹ä»¶æº</li>
<li>ç®­å¤´å‡½æ•°ä¸­çš„ thisï¼šå®é™…ä¸Šç®­å¤´å‡½æ•°ä¸­å¹¶ä¸å­˜åœ¨ thisï¼Œç®­å¤´å‡½æ•°ä¸­çš„ this æŒ‡å‘ä¸Šå±‚ä½œç”¨åŸŸçš„ thisï¼Œå¦‚æœä¸Šå±‚ä½œç”¨åŸŸä¹Ÿæ²¡æœ‰ thisï¼Œåˆ™ä¸€çº§ä¸€çº§å‘ä¸ŠæŸ¥æ‰¾</li>
</ul>
<p><em>ç®€å•æ¥è¯´ï¼Œthis æ€»æ˜¯æŒ‡å‘è°ƒç”¨è€…ã€‚æˆ‘ä»¬æ‰€è¯´çš„ this æŒ‡å‘æ˜¯æŒ‰ä½œç”¨åŸŸåˆ’åˆ†çš„</em></p>
<p>æ”¹å˜ this æŒ‡å‘</p>
<p>JavaScript ä¸­è¿˜å…è®¸æŒ‡å®šå‡½æ•°ä¸­ this çš„æŒ‡å‘ï¼Œæœ‰ 3 ä¸ªæ–¹æ³•å¯ä»¥åŠ¨æ€æŒ‡å®šæ™®é€šå‡½æ•°ä¸­ this çš„æŒ‡å‘</p>
<p>call()</p>
<p>è¯­æ³•ï¼š</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511152012252.png" alt="image-20230511152012252"></p>
<ul>
<li>thisArgï¼šåœ¨ fun å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šçš„ this å€¼</li>
<li>arg1ï¼Œarg2ï¼šå‡½æ•° fun æ­£å¸¸çš„å‚æ•°</li>
<li>è¿”å›å€¼å°±æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œå› ä¸ºå®ƒå°±æ˜¯è°ƒç”¨å‡½æ•°ï¼ˆå½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨äº† call æ–¹æ³•æ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿè¢«è°ƒç”¨æ‰§è¡Œäº†ï¼‰</li>
</ul>
<p>apply()</p>
<p>è¯­æ³•ï¼š</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511152310061.png" alt="image-20230511152310061"></p>
<ul>
<li>thisArgï¼šåœ¨ fun å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šçš„ this å€¼</li>
<li>argsArrayï¼šå‡½æ•° fun æ­£å¸¸çš„å‚æ•°ï¼Œä½†æ˜¯åœ¨ apply ä¸­å¿…é¡»åŒ…å«åœ¨æ•°ç»„é‡Œé¢</li>
<li>å› ä¸º apply çš„å‚æ•°ä¸»è¦è·Ÿæ•°ç»„æœ‰å…³ç³»ï¼Œå› æ­¤åœ¨æ¶‰åŠåˆ°æ•°ç»„å¤„ç†æ—¶ï¼Œåº”è¯¥æƒ³åˆ° apply æ¯”å¦‚ä½¿ç”¨ Math.max() æ±‚æ•°ç»„çš„æœ€å¤§å€¼</li>
<li>è¿”å›å€¼å°±æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œå› ä¸ºå®ƒå°±æ˜¯è°ƒç”¨å‡½æ•°å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨äº† apply æ–¹æ³•æ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿè¢«è°ƒç”¨æ‰§è¡Œäº†ï¼‰</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ±‚æ•°ç»„æœ€å¤§å€¼</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</span><br><span class="line"><span class="comment">// console.log(Math.max(...arr))</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, arr));</span><br></pre></td></tr></table></figure>

<p>bind()</p>
<p>è¯­æ³•ï¼š</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20230511153919522.png" alt="image-20230511153919522"></p>
<ul>
<li>thisArgï¼šåœ¨ fun å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šçš„ this å€¼</li>
<li>arg1ï¼Œarg2ï¼šå‡½æ•° fun å…·ä½“çš„å‚æ•°</li>
<li>è¿”å›ç”±æŒ‡å®šçš„ this å€¼å’Œåˆå§‹åŒ–å‚æ•°æ”¹é€ çš„åŸå‡½æ•°æ‹·è´ ï¼ˆæ–°å‡½æ•°ï¼‰ï¼Œå¹¶ä¸è°ƒç”¨åŸå‡½æ•°</li>
<li>å› æ­¤å½“æˆ‘ä»¬åªæ˜¯æƒ³æ”¹å˜ this æŒ‡å‘ï¼Œå¹¶ä¸”ä¸æƒ³è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ bindï¼Œæ¯”å¦‚æ”¹å˜å®šæ—¶å™¨å†…éƒ¨çš„ this æŒ‡å‘</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-è·¯ç”±å¤ç”¨æ—¶é¡µé¢ä¸åˆ·æ–°æ˜¾ç¤ºçš„è§£å†³åŠæ³•"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/01/13/%E8%B7%AF%E7%94%B1%E5%A4%8D%E7%94%A8%E6%97%B6%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%88%B7%E6%96%B0%E6%98%BE%E7%A4%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"
    >è·¯ç”±å¤ç”¨æ—¶é¡µé¢ä¸åˆ·æ–°æ˜¾ç¤ºçš„è§£å†³åŠæ³•</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/01/13/%E8%B7%AF%E7%94%B1%E5%A4%8D%E7%94%A8%E6%97%B6%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%88%B7%E6%96%B0%E6%98%BE%E7%A4%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/" class="article-date">
  <time datetime="2023-01-13T08:27:08.000Z" itemprop="datePublished">2023-01-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>ä»Šå¤©åœ¨é¡¹ç›®ä¸­æ–°å¢äº†å¾ˆå¤šä¿®æ”¹åŠŸèƒ½ã€‚éœ€è¦å¤ç”¨ä¹‹å‰çš„è·¯ç”±</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20240313150329705.png" alt="image-20240313150329705"></p>
<p>è¿™æ˜¯è·¯ç”±æ–‡ä»¶ï¼Œå…¶ä¸­çš„æ¯ä¸ªè·¯ç”±åœ°å€å¯¹åº”ç€ä¸€ä¸ªèœå•æ </p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20240313150624228.png" alt="image-20240313150624228"></p>
<p>ç°åœ¨ä¿®æ”¹åŠŸèƒ½éœ€è¦å¤ç”¨æ–°å‘èµ·çš„è·¯ç”±ï¼Œåœ¨è·¯ç”±çš„ query å‚æ•°æºå¸¦ç›¸åº”çš„å‚æ•°ï¼Œæ–¹ä¾¿åœ¨ä¿®æ”¹é¡µé¢ä¸­å¤æ˜¾æ•°æ®</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20240313151115776.png" alt="image-20240313151115776"></p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ç›´æ¥åœ¨å£°æ˜å‘¨æœŸå‡½æ•°é‡Œè·å–ä¿®æ”¹çš„æ•°æ®ä¼šä¸ç”Ÿæ•ˆã€‚åŸå› æ˜¯å½“ä¿®æ”¹å’Œæ–°å‘èµ·å¤ç”¨åŒä¸€ä¸ªè·¯ç”±æ—¶ï¼Œvue è€ƒè™‘åˆ°æ•ˆç‡é—®é¢˜ï¼Œå¹¶æ²¡æœ‰é‡æ–°é”€æ¯å†é‡å»ºç»„ä»¶ï¼Œå®ƒä»¬ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªç»„ä»¶ã€‚è¿™ä¹Ÿå¯¼è‡´äº†å½“æˆ‘åœ¨åˆ«çš„é¡µé¢ç‚¹å‡»ä¿®æ”¹æƒ³è·³è½¬åˆ°ä¿®æ”¹é¡µé¢æ—¶ï¼Œæˆ‘åœ¨å£°æ˜å‘¨æœŸå‡½æ•°é‡Œå†™çš„è·å–ä¿®æ”¹æ•°æ®çš„ä»£ç å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œé¡µé¢ä»æ˜¯ä¸€ç‰‡ç©ºç™½ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿåœ¨å°å…”é²œé¡¹ç›®ä¸­é‡åˆ°è¿‡ã€‚å› æ­¤æ‰‹åŠ¨ watch ä¸€ä¸‹</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20240313151854119.png" alt="image-20240313151854119"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-æ–‡ä»¶å¯¼å…¥å¯¼å‡ºåŠŸèƒ½"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/12/20/%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8A%9F%E8%83%BD/"
    >æ–‡ä»¶å¯¼å…¥å¯¼å‡ºåŠŸèƒ½</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/12/20/%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8A%9F%E8%83%BD/" class="article-date">
  <time datetime="2022-12-20T08:26:04.000Z" itemprop="datePublished">2022-12-20</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="ä¸€ã€å®‰è£…"><a href="#ä¸€ã€å®‰è£…" class="headerlink" title="ä¸€ã€å®‰è£…"></a>ä¸€ã€å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install file-saver --save</span><br><span class="line">npm install xlsx --save</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€åˆ›å»ºå·¥å…·å‡½æ•°"><a href="#äºŒã€åˆ›å»ºå·¥å…·å‡½æ•°" class="headerlink" title="äºŒã€åˆ›å»ºå·¥å…·å‡½æ•°"></a>äºŒã€åˆ›å»ºå·¥å…·å‡½æ•°</h2><p>ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨ src&#x2F;utils ä¸‹å°è£…ä¸€ä¸ªå·¥å…·æ–‡ä»¶ Export2Excel.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="keyword">import</span> &#123; saveAs &#125; <span class="keyword">from</span> <span class="string">&quot;file-saver&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="variable constant_">XLSX</span> <span class="keyword">from</span> <span class="string">&quot;xlsx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateArray</span>(<span class="params">table</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> out = [];</span><br><span class="line">  <span class="keyword">var</span> rows = table.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;tr&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> ranges = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R &lt; rows.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">var</span> outRow = [];</span><br><span class="line">    <span class="keyword">var</span> row = rows[R];</span><br><span class="line">    <span class="keyword">var</span> columns = row.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;td&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C &lt; columns.<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">var</span> cell = columns[C];</span><br><span class="line">      <span class="keyword">var</span> colspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&quot;colspan&quot;</span>);</span><br><span class="line">      <span class="keyword">var</span> rowspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&quot;rowspan&quot;</span>);</span><br><span class="line">      <span class="keyword">var</span> cellValue = cell.<span class="property">innerText</span>;</span><br><span class="line">      <span class="keyword">if</span> (cellValue !== <span class="string">&quot;&quot;</span> &amp;&amp; cellValue == +cellValue) cellValue = +cellValue;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Skip ranges</span></span><br><span class="line">      ranges.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">range</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          R &gt;= range.<span class="property">s</span>.<span class="property">r</span> &amp;&amp;</span><br><span class="line">          R &lt;= range.<span class="property">e</span>.<span class="property">r</span> &amp;&amp;</span><br><span class="line">          outRow.<span class="property">length</span> &gt;= range.<span class="property">s</span>.<span class="property">c</span> &amp;&amp;</span><br><span class="line">          outRow.<span class="property">length</span> &lt;= range.<span class="property">e</span>.<span class="property">c</span></span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= range.<span class="property">e</span>.<span class="property">c</span> - range.<span class="property">s</span>.<span class="property">c</span>; ++i) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Row Span</span></span><br><span class="line">      <span class="keyword">if</span> (rowspan || colspan) &#123;</span><br><span class="line">        rowspan = rowspan || <span class="number">1</span>;</span><br><span class="line">        colspan = colspan || <span class="number">1</span>;</span><br><span class="line">        ranges.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">s</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">e</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R + rowspan - <span class="number">1</span>,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span> + colspan - <span class="number">1</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Value</span></span><br><span class="line">      outRow.<span class="title function_">push</span>(cellValue !== <span class="string">&quot;&quot;</span> ? cellValue : <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Colspan</span></span><br><span class="line">      <span class="keyword">if</span> (colspan) <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; colspan - <span class="number">1</span>; ++k) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    out.<span class="title function_">push</span>(outRow);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [out, ranges];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">datenum</span>(<span class="params">v, date1904</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (date1904) v += <span class="number">1462</span>;</span><br><span class="line">  <span class="keyword">var</span> epoch = <span class="title class_">Date</span>.<span class="title function_">parse</span>(v);</span><br><span class="line">  <span class="keyword">return</span> (epoch - <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">UTC</span>(<span class="number">1899</span>, <span class="number">11</span>, <span class="number">30</span>))) / (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sheet_from_array_of_arrays</span>(<span class="params">data, opts</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ws = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> range = &#123;</span><br><span class="line">    <span class="attr">s</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">10000000</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">10000000</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">e</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R != data.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C != data[R].<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">r</span> &gt; R) range.<span class="property">s</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &gt; C) range.<span class="property">s</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">r</span> &lt; R) range.<span class="property">e</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">c</span> &lt; C) range.<span class="property">e</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">var</span> cell = &#123;</span><br><span class="line">        <span class="attr">v</span>: data[R][C],</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">if</span> (cell.<span class="property">v</span> == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">var</span> cell_ref = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_cell</span>(&#123;</span><br><span class="line">        <span class="attr">c</span>: C,</span><br><span class="line">        <span class="attr">r</span>: R,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&quot;number&quot;</span>) cell.<span class="property">t</span> = <span class="string">&quot;n&quot;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&quot;boolean&quot;</span>) cell.<span class="property">t</span> = <span class="string">&quot;b&quot;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (cell.<span class="property">v</span> <span class="keyword">instanceof</span> <span class="title class_">Date</span>) &#123;</span><br><span class="line">        cell.<span class="property">t</span> = <span class="string">&quot;n&quot;</span>;</span><br><span class="line">        cell.<span class="property">z</span> = <span class="variable constant_">XLSX</span>.<span class="property">SSF</span>.<span class="property">_table</span>[<span class="number">14</span>];</span><br><span class="line">        cell.<span class="property">v</span> = <span class="title function_">datenum</span>(cell.<span class="property">v</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> cell.<span class="property">t</span> = <span class="string">&quot;s&quot;</span>;</span><br><span class="line"></span><br><span class="line">      ws[cell_ref] = cell;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &lt; <span class="number">10000000</span>) ws[<span class="string">&quot;!ref&quot;</span>] = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_range</span>(range);</span><br><span class="line">  <span class="keyword">return</span> ws;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Workbook</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">Workbook</span>)) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Workbook</span>();</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">SheetNames</span> = [];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">Sheets</span> = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">s2ab</span>(<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(s.<span class="property">length</span>);</span><br><span class="line">  <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buf);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i != s.<span class="property">length</span>; ++i) view[i] = s.<span class="title function_">charCodeAt</span>(i) &amp; <span class="number">0xff</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_table_to_excel</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> theTable = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line">  <span class="keyword">var</span> oo = <span class="title function_">generateArray</span>(theTable);</span><br><span class="line">  <span class="keyword">var</span> ranges = oo[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  <span class="keyword">var</span> data = oo[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add ranges to worksheet */</span></span><br><span class="line">  <span class="comment">// ws[&#x27;!cols&#x27;] = [&#x27;apple&#x27;, &#x27;banan&#x27;];</span></span><br><span class="line">  ws[<span class="string">&quot;!merges&quot;</span>] = ranges;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&quot;xlsx&quot;</span>,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;binary&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">saveAs</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="string">&quot;test.xlsx&quot;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_json_to_excel</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">  multiHeader = [],</span></span><br><span class="line"><span class="params">  header,</span></span><br><span class="line"><span class="params">  data,</span></span><br><span class="line"><span class="params">  filename,</span></span><br><span class="line"><span class="params">  merges = [],</span></span><br><span class="line"><span class="params">  autoWidth = <span class="literal">true</span>,</span></span><br><span class="line"><span class="params">  bookType = <span class="string">&quot;xlsx&quot;</span>,</span></span><br><span class="line"><span class="params">&#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  filename = filename || <span class="string">&quot;excel-list&quot;</span>;</span><br><span class="line">  data = [...data];</span><br><span class="line">  data.<span class="title function_">unshift</span>(header);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = multiHeader.<span class="property">length</span> - <span class="number">1</span>; i &gt; -<span class="number">1</span>; i--) &#123;</span><br><span class="line">    data.<span class="title function_">unshift</span>(multiHeader[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (merges.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ws[<span class="string">&quot;!merges&quot;</span>]) ws[<span class="string">&quot;!merges&quot;</span>] = [];</span><br><span class="line">    merges.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      ws[<span class="string">&quot;!merges&quot;</span>].<span class="title function_">push</span>(<span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">decode_range</span>(item));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (autoWidth) &#123;</span><br><span class="line">    <span class="comment">/*è®¾ç½®worksheetæ¯åˆ—çš„æœ€å¤§å®½åº¦*/</span></span><br><span class="line">    <span class="keyword">const</span> colWidth = data.<span class="title function_">map</span>(<span class="function">(<span class="params">row</span>) =&gt;</span></span><br><span class="line">      row.<span class="title function_">map</span>(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">/*å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºnull/undefined*/</span></span><br><span class="line">        <span class="keyword">if</span> (val == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">wch</span>: <span class="number">10</span>,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val.<span class="title function_">toString</span>().<span class="title function_">charCodeAt</span>(<span class="number">0</span>) &gt; <span class="number">255</span>) &#123;</span><br><span class="line">          <span class="comment">/*å†åˆ¤æ–­æ˜¯å¦ä¸ºä¸­æ–‡*/</span></span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">wch</span>: val.<span class="title function_">toString</span>().<span class="property">length</span> * <span class="number">2</span>,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">wch</span>: val.<span class="title function_">toString</span>().<span class="property">length</span>,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">/*ä»¥ç¬¬ä¸€è¡Œä¸ºåˆå§‹å€¼*/</span></span><br><span class="line">    <span class="keyword">let</span> result = colWidth[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; colWidth.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; colWidth[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (result[j][<span class="string">&quot;wch&quot;</span>] &lt; colWidth[i][j][<span class="string">&quot;wch&quot;</span>]) &#123;</span><br><span class="line">          result[j][<span class="string">&quot;wch&quot;</span>] = colWidth[i][j][<span class="string">&quot;wch&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ws[<span class="string">&quot;!cols&quot;</span>] = result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: bookType,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;binary&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">saveAs</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;filename&#125;</span>.<span class="subst">$&#123;bookType&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€å¯¼å‡ºåŠŸèƒ½"><a href="#ä¸‰ã€å¯¼å‡ºåŠŸèƒ½" class="headerlink" title="ä¸‰ã€å¯¼å‡ºåŠŸèƒ½"></a>ä¸‰ã€å¯¼å‡ºåŠŸèƒ½</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button type=&quot;primary&quot; @click=&quot;exportTable&quot;&gt;å¯¼å‡º&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// å¯¼å‡ºåŠŸèƒ½</span><br><span class="line">// ç”¨æˆ·èœå•è¡¨å¤´ä¸æ•°æ®å­—æ®µå¯¹åº”å…³ç³»</span><br><span class="line">const userMenuHeader = &#123;</span><br><span class="line">  æµç¨‹æ¨¡æ¿: &quot;wf_type_name&quot;,</span><br><span class="line">  å®¡æ‰¹ç¼–å·: &quot;apply_id&quot;,</span><br><span class="line">  å‘èµ·äºº: &quot;staff_name&quot;,</span><br><span class="line">  å®¡æ‰¹æµç¨‹æ ‡é¢˜: &quot;apply_title&quot;,</span><br><span class="line">  å®¡æ‰¹é‡‘é¢: &quot;apply_fee&quot;,</span><br><span class="line">  å‘èµ·æ—¶é—´: &quot;create_date&quot;,</span><br><span class="line">  æµç¨‹çŠ¶æ€: &quot;proc_state_name&quot;,</span><br><span class="line">  å½“å‰ç¯èŠ‚: &quot;node_name&quot;,</span><br><span class="line">  å¤„ç†äºº: &quot;username&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">const exportTable = () =&gt; &#123;</span><br><span class="line">  //  åšæ“ä½œ</span><br><span class="line">  const excelData = [];</span><br><span class="line">  // è¿™é‡Œåç«¯è¿”å›çš„æ•°æ®ä¸èƒ½ç›´æ¥ç”¨ä½œexcelçš„dataï¼Œä¸ç„¶æµè§ˆå™¨ä¼šå¡æ­»ï¼Œå¿…é¡»å…ˆå°†æ•°æ®è½¬åŒ–ä¸ºè¡¨æ ¼éœ€è¦çš„[[]]çš„å½¢å¼</span><br><span class="line">  tableData.value.forEach((item) =&gt; &#123;</span><br><span class="line">    const arr = [];</span><br><span class="line">    for (const key in userMenuHeader) &#123;</span><br><span class="line">      arr.push(item[userMenuHeader[key]]);</span><br><span class="line">    &#125;</span><br><span class="line">    excelData.push(arr);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // æ‡’åŠ è½½</span><br><span class="line">  try &#123;</span><br><span class="line">    import(&quot;@/utils/Export2Excel&quot;).then(async (excel) =&gt; &#123;</span><br><span class="line">      excel.export_json_to_excel(&#123;</span><br><span class="line">        header: Object.keys(userMenuHeader),</span><br><span class="line">        data: excelData,</span><br><span class="line">        filename: &quot;è´¹ç”¨å†²è°ƒå®¡æ‰¹æµç¨‹æŸ¥è¯¢æ¸…å•&quot;,</span><br><span class="line">        autoWidth: true,</span><br><span class="line">        bookType: &quot;xlsx&quot;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; catch &#123;</span><br><span class="line">    ElMessage.error(&quot;å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•ï¼&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€å¯¼å…¥åŠŸèƒ½"><a href="#å››ã€å¯¼å…¥åŠŸèƒ½" class="headerlink" title="å››ã€å¯¼å…¥åŠŸèƒ½"></a>å››ã€å¯¼å…¥åŠŸèƒ½</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload</span><br><span class="line">    ref=&quot;uploadRef&quot;</span><br><span class="line">    class=&quot;upload-demo&quot;</span><br><span class="line">    v-model:file-list=&quot;accList&quot;</span><br><span class="line">    :on-remove=&quot;handleRemove&quot;</span><br><span class="line">    :on-change=&quot;handleChangeBusiness&quot;</span><br><span class="line">    :http-request=&quot;upload&quot;</span><br><span class="line">    action=&quot;#&quot;</span><br><span class="line">    :auto-upload=&quot;false&quot;</span><br><span class="line">    style=&quot;display: flex; margin-bottom: 10px&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;template #trigger&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; :icon=&quot;Document&quot; style=&quot;margin-right: 150px&quot;</span><br><span class="line">        &gt;é€‰æ‹©æ–‡ä»¶&lt;/el-button</span><br><span class="line">      &gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template #tip v-if=&quot;!accList.length&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;el-upload__tip&quot; style=&quot;margin: 10px 0 0 -445px&quot;&gt;</span><br><span class="line">        æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;el-button</span><br><span class="line">      class=&quot;ml-3&quot;</span><br><span class="line">      :icon=&quot;Upload&quot;</span><br><span class="line">      type=&quot;success&quot;</span><br><span class="line">      @click=&quot;getServByAccNbrImport&quot;</span><br><span class="line">      style=&quot;margin-top: 2px&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      æ‰¹é‡å¯¼å…¥è´¹ç”¨äº‰è®®æ•°æ®</span><br><span class="line">    &lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; :icon=&quot;Download&quot;</span><br><span class="line">      &gt;&lt;el-link href=&quot;/approve/static/è´¹ç”¨äº‰è®®å¯¼å…¥æ¨¡æ¿.xls&quot;</span><br><span class="line">        &gt;ä¸‹è½½é™„ä»¶æ¨¡æ¿&lt;/el-link</span><br><span class="line">      &gt;&lt;/el-button</span><br><span class="line">    &gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// æ‰¹é‡ä¸Šä¼ </span><br><span class="line">// ä¸Šä¼ çš„æ–‡ä»¶</span><br><span class="line">const accList = ref([]);</span><br><span class="line">const businessFileList = ref([]);</span><br><span class="line">const accountDetailList = ref([]); // è¿™æ˜¯è´¦æœŸæ˜ç»†</span><br><span class="line">// è¿›å‡ºç‰©å“å¯¹åº”å…³ç³»</span><br><span class="line">const businessRelation = &#123;</span><br><span class="line">  0: &quot;bz&quot;,</span><br><span class="line">  1: &quot;phone_number&quot;,</span><br><span class="line">  2: &quot;spje&quot;,</span><br><span class="line">  3: &quot;serv_id&quot;,</span><br><span class="line">  4: &quot;acct_id&quot;,</span><br><span class="line">  5: &quot;cust_name&quot;,</span><br><span class="line">  6: &quot;acct_name&quot;,</span><br><span class="line">  7: &quot;sqr&quot;,</span><br><span class="line">  8: &quot;sqrdh&quot;,</span><br><span class="line">  9: &quot;sqyy&quot;,</span><br><span class="line">  10: &quot;sqyy_name&quot;,</span><br><span class="line">  11: &quot;oper_type&quot;,</span><br><span class="line">  12: &quot;oper_type_name&quot;,</span><br><span class="line">  13: &quot;ctlx_id&quot;,</span><br><span class="line">  14: &quot;ctlx&quot;,</span><br><span class="line">  15: &quot;phone_local&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">const accountDetailRelation = &#123;</span><br><span class="line">  0: &quot;phone_number&quot;,</span><br><span class="line">  1: &quot;fee_month&quot;,</span><br><span class="line">  2: &quot;charge&quot;,</span><br><span class="line">  3: &quot;fee_acct_type&quot;,</span><br><span class="line">  4: &quot;fee_acct_type_name&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">const handleChangeBusiness = (file) =&gt; &#123;</span><br><span class="line">  const reader = new FileReader();</span><br><span class="line">  reader.onload = async (e) =&gt; &#123;</span><br><span class="line">    const data = e.target.result;</span><br><span class="line">    const workbook = XLSX.read(data, &#123; type: &quot;array&quot; &#125;);</span><br><span class="line">    const sheetName = workbook.SheetNames[0];</span><br><span class="line">    const worksheet = workbook.Sheets[sheetName];</span><br><span class="line">    const json = XLSX.utils.sheet_to_json(worksheet, &#123; header: 1 &#125;);</span><br><span class="line">    json.forEach((item) =&gt; &#123;</span><br><span class="line">      const obj = &#123;&#125;;</span><br><span class="line">      for (const key in businessRelation) &#123;</span><br><span class="line">        obj[businessRelation[key]] = item[key];</span><br><span class="line">      &#125;</span><br><span class="line">      businessFileList.value.push(obj);</span><br><span class="line">    &#125;);</span><br><span class="line">    // å¯¹businessFileListå»é‡</span><br><span class="line">    businessFileList.value = [...new Set(businessFileList.value)];</span><br><span class="line">    // æŠŠè¿™ä¸ªæ•°æ®ä¼ ç»™åç«¯ï¼Œè·å–åˆ°åç«¯è¿”å›çš„æ•°æ®ï¼Œæ¸²æŸ“åˆ—è¡¨</span><br><span class="line">    // å› ä¸ºè¡¨æ ¼ä¸­å¯èƒ½ä¼šæœ‰ç©ºç™½çš„æ•°æ®ï¼Œä¸Šä¼ ä¸Šæ¥çš„æ•°æ®å°±ä¼šæœ‰undefinedï¼Œæ‰€ä»¥è¦è¿‡æ»¤æ‰</span><br><span class="line">    businessFileList.value = businessFileList.value.filter((item) =&gt; item);</span><br><span class="line">    // å› ä¸ºæ‰¹é‡ä¸Šä¼ çš„æ²¡æœ‰acc_nbrï¼Œæ‰€ä»¥è¦æŠŠphone_numberèµ‹å€¼ç»™acc_nbr</span><br><span class="line">    businessFileList.value.forEach((item) =&gt; &#123;</span><br><span class="line">      item.acc_nbr = item.phone_number;</span><br><span class="line">    &#125;);</span><br><span class="line">    const sheetName1 = workbook.SheetNames[1];</span><br><span class="line">    const worksheet1 = workbook.Sheets[sheetName1];</span><br><span class="line">    const json1 = XLSX.utils.sheet_to_json(worksheet1, &#123; header: 1 &#125;);</span><br><span class="line">    json1.forEach((item) =&gt; &#123;</span><br><span class="line">      const obj = &#123;&#125;;</span><br><span class="line">      for (const key in accountDetailRelation) &#123;</span><br><span class="line">        obj[accountDetailRelation[key]] = item[key];</span><br><span class="line">      &#125;</span><br><span class="line">      accountDetailList.value.push(obj);</span><br><span class="line">    &#125;);</span><br><span class="line">    // å¯¹accountDetailListå»é‡</span><br><span class="line">    accountDetailList.value = [...new Set(accountDetailList.value)];</span><br><span class="line">    accountDetailList.value = accountDetailList.value.filter((item) =&gt; item);</span><br><span class="line">    // å°†accountDetailListä¸businessFileListå…³è”</span><br><span class="line">    businessFileList.value.forEach((item) =&gt; &#123;</span><br><span class="line">      item.fee_list_month = accountDetailList.value.filter((item2) =&gt; &#123;</span><br><span class="line">        return item.phone_number === item2.phone_number;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  reader.readAsArrayBuffer(file.raw);</span><br><span class="line">&#125;;</span><br><span class="line">const getServByAccNbrImport = async () =&gt; &#123;</span><br><span class="line">  if (businessFileList.value.length === 0) &#123;</span><br><span class="line">    ElMessage.error(&quot;è¯·å…ˆé€‰æ‹©æ–‡ä»¶&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  if (businessFileList.value.length &gt; 2000) &#123;</span><br><span class="line">    ElMessage.error(</span><br><span class="line">      &quot;ä¸Šä¼ çš„æ•°æ®è¶…è¿‡2000æ¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´æŸ¥è¯¢æ—¶é—´è¿‡é•¿ï¼Œè¯·åˆ†æ‰¹æ¬¡ä¸Šä¼ ï¼&quot;</span><br><span class="line">    );</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  applyForm.feeListData = businessFileList.value;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆçš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼šå¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€è¡Œæ•°æ®ä¸‹é¢å…³è”äº†ä¸€ä¸ªå­è¡¨</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20240313093547041.png" alt="image-20240313093547041"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-åŸºäºRBACçš„èœå•æƒé™æ§åˆ¶"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/12/13/%E5%9F%BA%E4%BA%8ERBAC%E7%9A%84%E8%8F%9C%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/"
    >åŸºäºRBACçš„èœå•æƒé™æ§åˆ¶</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/12/13/%E5%9F%BA%E4%BA%8ERBAC%E7%9A%84%E8%8F%9C%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/" class="article-date">
  <time datetime="2022-12-13T08:27:23.000Z" itemprop="datePublished">2022-12-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>RBAC (Role-Based Access Control) æ˜¯ä¸€ç§åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶æ–¹å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œæƒé™ä¸æ˜¯ç›´æ¥åˆ†é…ç»™ç”¨æˆ·ï¼Œè€Œæ˜¯åˆ†é…ç»™è§’è‰²ï¼Œç„¶åç”¨æˆ·è¢«åˆ†é…åˆ°ä¸åŒçš„è§’è‰²ã€‚ç”¨æˆ·é€šè¿‡è§’è‰²è·å¾—æƒé™ã€‚è¿™ç§æ–¹å¼ä½¿å¾—æƒé™ç®¡ç†å˜å¾—æ›´åŠ çµæ´»å’Œæ–¹ä¾¿ã€‚</p>
<p>åœ¨ RBAC æ¨¡å‹ä¸­ï¼Œå¯ä»¥åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦å…ƒç´ ï¼š</p>
<ul>
<li>ç”¨æˆ·ï¼ˆUserï¼‰ï¼šç³»ç»Ÿçš„æ“ä½œè€…ï¼Œå¯ä»¥æ˜¯äººï¼Œä¹Ÿå¯ä»¥æ˜¯å†…éƒ¨çš„ç¨‹åºæˆ–è¿›ç¨‹ã€‚</li>
<li>è§’è‰²ï¼ˆRoleï¼‰ï¼šç”¨æˆ·çš„èº«ä»½ï¼Œå®ƒæ˜¯æƒé™çš„é›†åˆã€‚ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‹¥æœ‰å¤šä¸ªè§’è‰²ã€‚</li>
<li>æƒé™ï¼ˆPermissionï¼‰ï¼šå¯¹ä¸€ç§æ“ä½œæˆ–è€…èµ„æºçš„è®¿é—®æ§åˆ¶ã€‚æƒé™é€šå¸¸æ˜¯ç³»ç»Ÿå®šä¹‰å¥½çš„ï¼Œä¾‹å¦‚è¯»æƒé™ã€å†™æƒé™ç­‰ã€‚</li>
</ul>
<p>RBAC æ¨¡å‹çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å¯ä»¥ç®€åŒ–æƒé™ç®¡ç†ã€‚åœ¨å¤§å‹ç»„ç»‡ä¸­ï¼Œç”¨æˆ·ç»å¸¸ä¼šæ›´æ¢éƒ¨é—¨ï¼Œæˆ–è€…è§’è‰²ä¼šéšç€æ—¶é—´è€Œå˜åŒ–ã€‚ä½¿ç”¨ RBAC æ¨¡å‹ï¼Œåªéœ€è¦æ›´æ”¹ç”¨æˆ·çš„è§’è‰²ï¼Œè€Œä¸éœ€è¦å•ç‹¬æ›´æ”¹æ¯ä¸ªç”¨æˆ·çš„æƒé™ã€‚</p>
<p>åœ¨ä¼ä¸šæœåŠ¡ä¸­ï¼Œæƒé™ä¸€èˆ¬åˆ†å‰²ä¸º <strong>é¡µé¢è®¿é—®æƒé™</strong>ï¼Œ<strong>æŒ‰é’®æ“ä½œæƒé™</strong>ï¼Œ<strong>API è®¿é—®æƒé™</strong></p>
<h2 id="ä¸€ã€æƒé™å—æ§çš„ä¸»ä½“æ€è·¯"><a href="#ä¸€ã€æƒé™å—æ§çš„ä¸»ä½“æ€è·¯" class="headerlink" title="ä¸€ã€æƒé™å—æ§çš„ä¸»ä½“æ€è·¯"></a>ä¸€ã€æƒé™å—æ§çš„ä¸»ä½“æ€è·¯</h2><ul>
<li>æˆ‘ä»¬å°†è·¯ç”±æ¨¡å—åˆ†ä¸ºé™æ€è·¯ç”±å’ŒåŠ¨æ€è·¯ç”±ï¼Œé™æ€è·¯ç”±æ˜¯æ‰€æœ‰äººéƒ½èƒ½è®¿é—®çš„ï¼Œè€ŒåŠ¨æ€è·¯ç”±åˆ™æ˜¯éœ€è¦æƒé™æ‰èƒ½è®¿é—®çš„</li>
<li>åœ¨ç”¨æˆ·ç™»å½•è·å–çš„ç”¨æˆ·ä¿¡æ¯ä¸­ï¼Œæºå¸¦æœ‰ç”¨æˆ·æ‹¥æœ‰çš„æƒé™æ ‡è¯†ã€‚æˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·æºå¸¦çš„æƒé™æ ‡è¯†å’ŒåŠ¨æ€è·¯ç”±å¯¹åº”èµ·æ¥ï¼ˆæ¯”å¦‚å¯¹åº”åˆ°è·¯ç”±æ¨¡å—çš„ nameï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä»åŠ¨æ€è·¯ç”±ä¸­ç­›é€‰å‡ºç”¨æˆ·æ‰€æ‹¥æœ‰çš„è·¯ç”±äº†</li>
<li>é™æ€è·¯ç”±å’Œç­›é€‰å‡ºçš„è·¯ç”±åˆå¹¶å¾—åˆ°ç”¨æˆ·å®Œæ•´è·¯ç”±ã€‚ä¾§è¾¹æ æ ¹æ®å®Œæ•´è·¯ç”±æ¸²æŸ“å‡ºèœå•æ ã€è·¯ç”±å®ˆå«æ ¹æ®å®Œæ•´è·¯ç”±æ‹¦æˆªæˆ–æ”¾è¡Œ</li>
</ul>
<h2 id="äºŒã€æ‹†åˆ†è·¯ç”±æ¨¡å—"><a href="#äºŒã€æ‹†åˆ†è·¯ç”±æ¨¡å—" class="headerlink" title="äºŒã€æ‹†åˆ†è·¯ç”±æ¨¡å—"></a>äºŒã€æ‹†åˆ†è·¯ç”±æ¨¡å—</h2><p>æ‹†åˆ†åçš„&#x2F;src&#x2F;router.index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>);</span><br><span class="line"><span class="comment">// å¼•å…¥å¤šä¸ªæ¨¡å—çš„è§„åˆ™</span></span><br><span class="line"><span class="keyword">import</span> approvalsRouter <span class="keyword">from</span> <span class="string">&quot;./modules/approvals&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> departmentsRouter <span class="keyword">from</span> <span class="string">&quot;./modules/departments&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> employeesRouter <span class="keyword">from</span> <span class="string">&quot;./modules/employees&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> permissionRouter <span class="keyword">from</span> <span class="string">&quot;./modules/permission&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> attendancesRouter <span class="keyword">from</span> <span class="string">&quot;./modules/attendances&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> salarysRouter <span class="keyword">from</span> <span class="string">&quot;./modules/salarys&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> settingRouter <span class="keyword">from</span> <span class="string">&quot;./modules/setting&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> socialRouter <span class="keyword">from</span> <span class="string">&quot;./modules/social&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> userRouter <span class="keyword">from</span> <span class="string">&quot;./modules/user&quot;</span>;</span><br><span class="line"><span class="comment">/* Layout */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/layout&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> constantRoutes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/login/index&quot;</span>),</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/404&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/404&quot;</span>),</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&quot;/dashboard&quot;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;dashboard&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;dashboard&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/dashboard/index&quot;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;é¦–é¡µ&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;dashboard&quot;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/import&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// è¯¥ç»„ä»¶ä¸åœ¨èœå•ä¸­æ˜¾ç¤º</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/import&quot;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;å¯¼å…¥&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  userRouter,</span><br><span class="line">  <span class="comment">// 404 page must be placed at the end !!!</span></span><br><span class="line">  <span class="comment">// &#123; path: &#x27;*&#x27;, redirect: &#x27;/404&#x27;, hidden: true &#125;</span></span><br><span class="line">];</span><br><span class="line"><span class="comment">// åŠ¨æ€è·¯ç”±çš„å˜é‡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> asyncRoutes = [</span><br><span class="line">  approvalsRouter,</span><br><span class="line">  departmentsRouter,</span><br><span class="line">  employeesRouter,</span><br><span class="line">  permissionRouter,</span><br><span class="line">  attendancesRouter,</span><br><span class="line">  salarysRouter,</span><br><span class="line">  settingRouter,</span><br><span class="line">  socialRouter,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createRouter</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;history&quot;</span>, <span class="comment">// require service support</span></span><br><span class="line">    <span class="attr">base</span>: <span class="string">&quot;/hrsaas/&quot;</span>,</span><br><span class="line">    <span class="attr">scrollBehavior</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">y</span>: <span class="number">0</span> &#125;),</span><br><span class="line">    <span class="attr">routes</span>: [...constantRoutes],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetRouter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = <span class="title function_">createRouter</span>();</span><br><span class="line">  router.<span class="property">matcher</span> = newRouter.<span class="property">matcher</span>; <span class="comment">// reset router</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€åœ¨-vuex-ä¸­æ–°å»º-permission-æ¨¡å—"><a href="#ä¸‰ã€åœ¨-vuex-ä¸­æ–°å»º-permission-æ¨¡å—" class="headerlink" title="ä¸‰ã€åœ¨ vuex ä¸­æ–°å»º permission æ¨¡å—"></a>ä¸‰ã€åœ¨ vuex ä¸­æ–°å»º permission æ¨¡å—</h2><p><strong><code>src/store/modules/permission.js</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vuexçš„æƒé™æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> &#123; constantRoutes &#125; <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="comment">// vuexä¸­çš„permissionæ¨¡å—ç”¨æ¥å­˜æ”¾å½“å‰çš„ é™æ€è·¯ç”± + å½“å‰ç”¨æˆ·çš„ æƒé™è·¯ç”±</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">routes</span>: constantRoutes, <span class="comment">// æ‰€æœ‰äººé»˜è®¤æ‹¥æœ‰é™æ€è·¯ç”±</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="comment">// newRouteså¯ä»¥è®¤ä¸ºæ˜¯ ç”¨æˆ·ç™»å½• é€šè¿‡æƒé™æ‰€å¾—åˆ°çš„åŠ¨æ€è·¯ç”±çš„éƒ¨åˆ†</span></span><br><span class="line">  <span class="title function_">setRoutes</span>(<span class="params">state, newRoutes</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸‹é¢è¿™ä¹ˆå†™ä¸å¯¹ ä¸æ˜¯è¯­æ³•ä¸å¯¹ æ˜¯ä¸šåŠ¡ä¸å¯¹</span></span><br><span class="line">    <span class="comment">// state.routes = [...state.routes, ...newRoutes]</span></span><br><span class="line">    <span class="comment">// æœ‰ä¸€ç§æƒ…å†µ  å¼ ä¸‰ ç™»å½• è·å–äº†åŠ¨æ€è·¯ç”± è¿½åŠ åˆ°è·¯ç”±ä¸Š  æå››ç™»å½• 4ä¸ªåŠ¨æ€è·¯ç”±</span></span><br><span class="line">    <span class="comment">// åº”è¯¥æ˜¯æ¯æ¬¡æ›´æ–° éƒ½åº”è¯¥åœ¨é™æ€è·¯ç”±çš„åŸºç¡€ä¸Šè¿›è¡Œè¿½åŠ </span></span><br><span class="line">    state.<span class="property">routes</span> = [...constantRoutes, ...newRoutes];</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ Vuex ç®¡ç†æ¨¡å—ä¸­å¼•å…¥ permisson æ¨¡å—</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> permission <span class="keyword">from</span> <span class="string">&quot;./modules/permission&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="comment">// å­æ¨¡å—   $store.state.app.</span></span><br><span class="line">    <span class="comment">// mapGetters([])</span></span><br><span class="line">    app,</span><br><span class="line">    settings,</span><br><span class="line">    user,</span><br><span class="line">    permission,</span><br><span class="line">  &#125;,</span><br><span class="line">  getters,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€vuex-ç­›é€‰è·¯ç”±æƒé™"><a href="#å››ã€vuex-ç­›é€‰è·¯ç”±æƒé™" class="headerlink" title="å››ã€vuex ç­›é€‰è·¯ç”±æƒé™"></a>å››ã€vuex ç­›é€‰è·¯ç”±æƒé™</h2><p>æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿™å¼ å›¾ï¼Œåšè¿›ä¸€æ­¥çš„æ“ä½œ</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200815184407204.png" alt="image-20200815184407204"></p>
<p>åç«¯è¿”å›çš„ç”¨æˆ·ä¿¡æ¯</p>
<p><img src="https://myblog-1314160455.cos.ap-nanjing.myqcloud.com/image-20200815185230597.png" alt="image-20200815185230597"></p>
<p>æ¥ä¸‹æ¥ï¼Œ åœ¨ vuex çš„ permission ä¸­å†™ä¸€ä¸ª actionï¼Œé€šè¿‡è·¯ç”±æ¨¡å—çš„ name ä¸ç”¨æˆ·ä¿¡æ¯ä¸­çš„æƒé™æ ‡è¯†è¿›è¡Œå…³è”ï¼Œæœ€ç»ˆç­›é€‰å‡ºç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™è·¯ç”±</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; asyncRoutes, constantRoutes &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// ç­›é€‰æƒé™è·¯ç”±</span></span><br><span class="line">  <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ä¸ºå½“å‰ç”¨æˆ·çš„æ‰€æ‹¥æœ‰çš„èœå•æƒé™</span></span><br><span class="line">  <span class="comment">// menus: [&quot;settings&quot;,&quot;permissions&quot;]</span></span><br><span class="line">  <span class="comment">// asyncRoutesæ˜¯æ‰€æœ‰çš„åŠ¨æ€è·¯ç”±</span></span><br><span class="line">  <span class="comment">// asyncRoutes  [&#123;path: &#x27;setting&#x27;,name: &#x27;setting&#x27;&#125;,&#123;&#125;]</span></span><br><span class="line">  <span class="title function_">filterRoutes</span>(<span class="params">context, menus</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> routes = []</span><br><span class="line">    <span class="comment">//   ç­›é€‰å‡º åŠ¨æ€è·¯ç”±ä¸­å’Œmenusä¸­èƒ½å¤Ÿå¯¹ä¸Šçš„è·¯ç”±</span></span><br><span class="line">    menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// keyå°±æ˜¯æ ‡è¯†</span></span><br><span class="line">      <span class="comment">// asyncRoutes æ‰¾ æœ‰æ²¡æœ‰å¯¹è±¡ä¸­çš„nameå±æ€§ç­‰äº keyçš„ å¦‚æœæ‰¾ä¸åˆ°å°±æ²¡æƒé™ å¦‚æœæ‰¾åˆ°äº† è¦ç­›é€‰å‡ºæ¥</span></span><br><span class="line">      routes.<span class="title function_">push</span>(...asyncRoutes.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">name</span> === key)) <span class="comment">// å¾—åˆ°ä¸€ä¸ªæ•°ç»„ æœ‰å¯èƒ½ æœ‰å…ƒç´  ä¹Ÿæœ‰å¯èƒ½æ˜¯ç©ºæ•°ç»„</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// å¾—åˆ°çš„routesæ˜¯æ‰€æœ‰æ¨¡å—ä¸­æ»¡è¶³æƒé™è¦æ±‚çš„è·¯ç”±æ•°ç»„</span></span><br><span class="line">    <span class="comment">// routeså°±æ˜¯å½“å‰ç”¨æˆ·æ‰€æ‹¥æœ‰çš„ åŠ¨æ€è·¯ç”±çš„æƒé™</span></span><br><span class="line">    context.<span class="title function_">commit</span>(<span class="string">&#x27;setRoutes&#x27;</span>, routes) <span class="comment">// å°†åŠ¨æ€è·¯ç”±æäº¤ç»™mutations</span></span><br><span class="line">    <span class="keyword">return</span> routes <span class="comment">// è¿™é‡Œä¸ºä»€ä¹ˆè¿˜è¦return  stateæ•°æ® æ˜¯ç”¨æ¥ æ˜¾ç¤ºå·¦ä¾§èœå•ç”¨çš„  return  æ˜¯ç»™è·¯ç”±addRoutesç”¨çš„</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€æƒé™æ‹¦æˆªå¤„è°ƒç”¨ç­›é€‰æƒé™-Action"><a href="#äº”ã€æƒé™æ‹¦æˆªå¤„è°ƒç”¨ç­›é€‰æƒé™-Action" class="headerlink" title="äº”ã€æƒé™æ‹¦æˆªå¤„è°ƒç”¨ç­›é€‰æƒé™ Action"></a>äº”ã€æƒé™æ‹¦æˆªå¤„è°ƒç”¨ç­›é€‰æƒé™ Action</h2><p>åœ¨æ‹¦æˆªçš„ä½ç½®ï¼Œè°ƒç”¨å…³è” actionï¼Œ è·å–æ–°å¢ routesï¼Œå¹¶ä¸”<strong>addRoutes</strong></p>
<p>æ³¨æ„ï¼Œç”±äºå†…å®¹è¾ƒå¤šï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‹¦æˆªè¿™å—ä»&#x2F;src&#x2F;router&#x2F;index.js ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ï¼Œ&#x2F;src&#x2F;permission.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æƒé™æ‹¦æˆªåœ¨è·¯ç”±è·³è½¬  å¯¼èˆªå®ˆå«</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>; <span class="comment">// å¼•å…¥storeå®ä¾‹ å’Œç»„ä»¶ä¸­çš„this.$storeæ˜¯ä¸€å›äº‹</span></span><br><span class="line"><span class="keyword">import</span> nprogress <span class="keyword">from</span> <span class="string">&quot;nprogress&quot;</span>; <span class="comment">// å¼•å…¥è¿›åº¦æ¡</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span>; <span class="comment">// å¼•å…¥è¿›åº¦æ¡æ ·å¼</span></span><br><span class="line"><span class="comment">// ä¸éœ€è¦å¯¼å‡º  å› ä¸ºåªéœ€è¦è®©ä»£ç æ‰§è¡Œå³å¯</span></span><br><span class="line"><span class="comment">// å‰ç½®å®ˆå«</span></span><br><span class="line"><span class="comment">// nextæ˜¯å‰ç½®å®ˆå«å¿…é¡»å¿…é¡»å¿…é¡»æ‰§è¡Œçš„é’©å­  nextå¿…é¡»æ‰§è¡Œ å¦‚æœä¸æ‰§è¡Œ é¡µé¢å°±æ­»äº†</span></span><br><span class="line"><span class="comment">// next()  æ”¾è¿‡</span></span><br><span class="line"><span class="comment">// next(false) è·³è½¬ç»ˆæ­¢</span></span><br><span class="line"><span class="comment">// next(åœ°å€) è·³è½¬åˆ°æŸä¸ªåœ°å€</span></span><br><span class="line"><span class="keyword">const</span> whiteList = [<span class="string">&quot;/login&quot;</span>, <span class="string">&quot;/404&quot;</span>]; <span class="comment">// å®šä¹‰ç™½åå•</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span> (to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  nprogress.<span class="title function_">start</span>(); <span class="comment">// å¼€å¯è¿›åº¦æ¡çš„æ„æ€</span></span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">    <span class="comment">// åªæœ‰æœ‰tokençš„æƒ…å†µä¸‹ æ‰èƒ½è·å–èµ„æ–™</span></span><br><span class="line">    <span class="comment">//   å¦‚æœæœ‰token</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&quot;/login&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœè¦è®¿é—®çš„æ˜¯ ç™»å½•é¡µ</span></span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&quot;/&quot;</span>); <span class="comment">// è·³åˆ°ä¸»é¡µ  // æœ‰token ç”¨å¤„ç†å—ï¼Ÿä¸ç”¨</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// åªæœ‰æ”¾è¿‡çš„æ—¶å€™æ‰å»è·å–ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">      <span class="comment">// æ˜¯æ¯æ¬¡éƒ½è·å–å—</span></span><br><span class="line">      <span class="comment">// å¦‚æœå½“å‰vuexä¸­æœ‰ç”¨æˆ·çš„èµ„æ–™çš„id è¡¨ç¤º å·²ç»æœ‰èµ„æ–™äº† ä¸éœ€è¦è·å–äº† å¦‚æœæ²¡æœ‰idæ‰éœ€è¦è·å–</span></span><br><span class="line">      <span class="keyword">if</span> (!store.<span class="property">getters</span>.<span class="property">userId</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰idæ‰è¡¨ç¤ºå½“å‰ç”¨æˆ·èµ„æ–™æ²¡æœ‰è·å–è¿‡</span></span><br><span class="line">        <span class="comment">// async å‡½æ•°æ‰€returnçš„å†…å®¹ ç”¨ awaitå°±å¯ä»¥æ¥æ”¶åˆ°</span></span><br><span class="line">        <span class="keyword">const</span> &#123; roles &#125; = <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/getUserInfo&quot;</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœè¯´åç»­ éœ€è¦æ ¹æ®ç”¨æˆ·èµ„æ–™è·å–æ•°æ®çš„è¯ è¿™é‡Œå¿…é¡»æ”¹æˆ åŒæ­¥</span></span><br><span class="line">        <span class="comment">// ç­›é€‰ç”¨æˆ·çš„å¯ç”¨è·¯ç”±</span></span><br><span class="line">        <span class="comment">// actionsä¸­å‡½æ•° é»˜è®¤æ˜¯Promiseå¯¹è±¡ è°ƒç”¨è¿™ä¸ªå¯¹è±¡ æƒ³è¦è·å–è¿”å›çš„å€¼è¯ å¿…é¡» åŠ  awaitæˆ–è€…æ˜¯then</span></span><br><span class="line">        <span class="comment">// actionsæ˜¯åšå¼‚æ­¥æ“ä½œçš„</span></span><br><span class="line">        <span class="keyword">const</span> routes = <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(</span><br><span class="line">          <span class="string">&quot;permission/filterRoutes&quot;</span>,</span><br><span class="line">          roles.<span class="property">menus</span></span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// routeså°±æ˜¯ç­›é€‰å¾—åˆ°çš„åŠ¨æ€è·¯ç”±</span></span><br><span class="line">        <span class="comment">// åŠ¨æ€è·¯ç”± æ·»åŠ åˆ° è·¯ç”±è¡¨ä¸­ é»˜è®¤çš„è·¯ç”±è¡¨ åªæœ‰é™æ€è·¯ç”± æ²¡æœ‰åŠ¨æ€è·¯ç”±</span></span><br><span class="line">        <span class="comment">// addRoutes  å¿…é¡» ç”¨ next(åœ°å€) ä¸èƒ½ç”¨next()</span></span><br><span class="line">        router.<span class="title function_">addRoutes</span>(routes); <span class="comment">// æ·»åŠ åŠ¨æ€è·¯ç”±åˆ°è·¯ç”±è¡¨  é“ºè·¯</span></span><br><span class="line">        <span class="comment">// æ·»åŠ å®ŒåŠ¨æ€è·¯ç”±ä¹‹å</span></span><br><span class="line">        <span class="title function_">next</span>(to.<span class="property">path</span>); <span class="comment">// ç›¸å½“äºè·³åˆ°å¯¹åº”çš„åœ°å€  ç›¸å½“äºå¤šåšä¸€æ¬¡è·³è½¬ ä¸ºä»€ä¹ˆè¦å¤šåšä¸€æ¬¡è·³è½¬</span></span><br><span class="line">        <span class="comment">// è¿›é—¨äº†ï¼Œä½†æ˜¯è¿›é—¨ä¹‹åæˆ‘è¦å»çš„åœ°æ–¹çš„è·¯è¿˜æ²¡æœ‰é“ºå¥½ï¼Œç›´æ¥èµ°ï¼Œæ‰å‘é‡Œï¼Œå¤šåšä¸€æ¬¡è·³è½¬ï¼Œå†ä»é—¨å¤–å¾€é‡Œè¿›ä¸€æ¬¡ï¼Œè·³è½¬ä¹‹å‰ æŠŠè·¯é“ºå¥½ï¼Œå†æ¬¡è¿›æ¥çš„æ—¶å€™ï¼Œè·¯å°±é“ºå¥½äº†</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//   æ²¡æœ‰tokençš„æƒ…å†µä¸‹</span></span><br><span class="line">    <span class="keyword">if</span> (whiteList.<span class="title function_">indexOf</span>(to.<span class="property">path</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">//  è¡¨ç¤ºè¦å»çš„åœ°å€åœ¨ç™½åå•</span></span><br><span class="line">      <span class="title function_">next</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  nprogress.<span class="title function_">done</span>(); <span class="comment">// è§£å†³æ‰‹åŠ¨åˆ‡æ¢åœ°å€æ—¶ è¿›åº¦æ¡ä¸å…³é—­çš„é—®é¢˜</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// åç½®å®ˆå«</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  nprogress.<span class="title function_">done</span>(); <span class="comment">// å…³é—­è¿›åº¦æ¡</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>åœ¨**<code>src/store/getters.js</code>**é…ç½®å¯¼å‡º routes</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="attr">sidebar</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">app</span>.<span class="property">sidebar</span>,</span><br><span class="line">  <span class="attr">device</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">app</span>.<span class="property">device</span>,</span><br><span class="line">  <span class="attr">token</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">token</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">username</span>, <span class="comment">// å»ºç«‹ç”¨æˆ·åç§°çš„æ˜ å°„</span></span><br><span class="line">  <span class="attr">userId</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">userId</span>, <span class="comment">// å»ºç«‹ç”¨æˆ·idçš„æ˜ å°„</span></span><br><span class="line">  <span class="attr">companyId</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">companyId</span>, <span class="comment">// å»ºç«‹ç”¨æˆ·çš„å…¬å¸Idæ˜ å°„</span></span><br><span class="line">  <span class="attr">routes</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">permission</span>.<span class="property">routes</span>, <span class="comment">// å¯¼å‡ºå½“å‰çš„è·¯ç”±</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€åœ¨å·¦ä¾§èœå•ç»„ä»¶ä¸­ï¼Œ-å¼•å…¥-routes"><a href="#å…­ã€åœ¨å·¦ä¾§èœå•ç»„ä»¶ä¸­ï¼Œ-å¼•å…¥-routes" class="headerlink" title="å…­ã€åœ¨å·¦ä¾§èœå•ç»„ä»¶ä¸­ï¼Œ å¼•å…¥ routes"></a>å…­ã€åœ¨å·¦ä¾§èœå•ç»„ä»¶ä¸­ï¼Œ å¼•å…¥ routes</h2><p>&#x2F;src&#x2F;layout&#x2F;components&#x2F;Siderbar&#x2F;index.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div :class=&quot;&#123; &#x27;has-logo&#x27;: showLogo &#125;&quot;&gt;</span><br><span class="line">    &lt;logo v-if=&quot;showLogo&quot; :collapse=&quot;isCollapse&quot; /&gt;</span><br><span class="line">    &lt;el-scrollbar wrap-class=&quot;scrollbar-wrapper&quot;&gt;</span><br><span class="line">      &lt;el-menu</span><br><span class="line">        :default-active=&quot;activeMenu&quot;</span><br><span class="line">        :collapse=&quot;isCollapse&quot;</span><br><span class="line">        :background-color=&quot;variables.menuBg&quot;</span><br><span class="line">        :text-color=&quot;variables.menuText&quot;</span><br><span class="line">        :unique-opened=&quot;false&quot;</span><br><span class="line">        :active-text-color=&quot;variables.menuActiveText&quot;</span><br><span class="line">        :collapse-transition=&quot;false&quot;</span><br><span class="line">        mode=&quot;vertical&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;sidebar-item</span><br><span class="line">          v-for=&quot;route in routes&quot;</span><br><span class="line">          :key=&quot;route.path&quot;</span><br><span class="line">          :item=&quot;route&quot;</span><br><span class="line">          :base-path=&quot;route.path&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-menu&gt;</span><br><span class="line">    &lt;/el-scrollbar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapGetters &#125; from &quot;vuex&quot;;</span><br><span class="line">import Logo from &quot;./Logo&quot;;</span><br><span class="line">import SidebarItem from &quot;./SidebarItem&quot;;</span><br><span class="line">import variables from &quot;@/styles/variables.scss&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123; SidebarItem, Logo &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapGetters([&quot;sidebar&quot;, &quot;routes&quot;]),</span><br><span class="line">    // è·¯ç”± addRoutesä¹‹å ä¸ä¼šå“åº”å¼çš„æ›´æ–°çš„ç»„ä»¶</span><br><span class="line">    // é»˜è®¤é™æ€è·¯ç”± 5æ¡  +  addRoutes(6æ¡) = 11æ¡</span><br><span class="line">    // routes() &#123;</span><br><span class="line">    //   return this.$router.options.routes</span><br><span class="line">    // &#125;,</span><br><span class="line">    activeMenu() &#123;</span><br><span class="line">      const route = this.$route;</span><br><span class="line">      const &#123; meta, path &#125; = route;</span><br><span class="line">      // if set path, the sidebar will highlight the path you set</span><br><span class="line">      if (meta.activeMenu) &#123;</span><br><span class="line">        return meta.activeMenu;</span><br><span class="line">      &#125;</span><br><span class="line">      return path;</span><br><span class="line">    &#125;,</span><br><span class="line">    showLogo() &#123;</span><br><span class="line">      return this.$store.state.settings.sidebarLogo;</span><br><span class="line">    &#125;,</span><br><span class="line">    variables() &#123;</span><br><span class="line">      return variables;</span><br><span class="line">    &#125;,</span><br><span class="line">    isCollapse() &#123;</span><br><span class="line">      return !this.sidebar.opened;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€ç™»å‡ºæ—¶é‡ç½®è·¯ç”±æƒé™å’Œ-404-é—®é¢˜"><a href="#ä¸ƒã€ç™»å‡ºæ—¶é‡ç½®è·¯ç”±æƒé™å’Œ-404-é—®é¢˜" class="headerlink" title="ä¸ƒã€ç™»å‡ºæ—¶é‡ç½®è·¯ç”±æƒé™å’Œ 404 é—®é¢˜"></a>ä¸ƒã€ç™»å‡ºæ—¶é‡ç½®è·¯ç”±æƒé™å’Œ 404 é—®é¢˜</h2><blockquote>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹ä¼¼å®Œæˆäº†è®¿é—®æƒé™çš„åŠŸèƒ½ï¼Œå®åˆ™ä¸ç„¶ï¼Œå› ä¸ºå½“æˆ‘ä»¬ç™»å‡ºæ“ä½œä¹‹åï¼Œè™½ç„¶çœ‹ä¸åˆ°èœå•ï¼Œä½†æ˜¯ç”¨æˆ·å®é™…ä¸Šå¯ä»¥è®¿é—®é¡µé¢ï¼Œç›´æ¥åœ¨åœ°å€æ è¾“å…¥åœ°å€å°±èƒ½è®¿é—®</p>
</blockquote>
<p>è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ</p>
<blockquote>
<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å‰é¢åœ¨<strong>addRoutes</strong>çš„æ—¶å€™ï¼Œä¸€ç›´éƒ½æ˜¯åœ¨<strong>åŠ </strong>ï¼Œç™»å‡ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åˆ ï¼Œä¹Ÿæ²¡æœ‰é‡ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¹‹å‰åŠ çš„è·¯ç”±åœ¨ç™»å‡ºä¹‹åä¸€ç›´åœ¨ï¼Œè¿™æ€ä¹ˆå¤„ç†ï¼Ÿ</p>
</blockquote>
<p>åœ¨<strong>router&#x2F;index.js</strong>æ–‡ä»¶ä¸­æä¾›ä¸€ä¸ªé‡ç½®è·¯ç”±æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡ç½®è·¯ç”±</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetRouter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = <span class="title function_">createRouter</span>();</span><br><span class="line">  router.<span class="property">matcher</span> = newRouter.<span class="property">matcher</span>; <span class="comment">// é‡æ–°è®¾ç½®è·¯ç”±çš„å¯åŒ¹é…è·¯å¾„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–¹æ³•å¯ä»¥å°†è·¯ç”±é‡æ–°å®ä¾‹åŒ–ï¼Œç›¸å½“äºæ¢äº†ä¸€ä¸ªæ–°çš„è·¯ç”±ï¼Œä¹‹å‰**<code>åŠ çš„è·¯ç”±</code>**è‡ªç„¶ä¸å­˜åœ¨äº†ï¼Œåªéœ€è¦åœ¨ç™»å‡ºçš„æ—¶å€™ï¼Œ è°ƒç”¨æ­¤æ–¹æ³•å³å¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç™»å‡ºçš„action</span></span><br><span class="line"><span class="title function_">lgout</span>(<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ é™¤token</span></span><br><span class="line">  context.<span class="title function_">commit</span>(<span class="string">&#x27;removeToken&#x27;</span>) <span class="comment">// ä¸ä»…ä»…åˆ é™¤äº†vuexä¸­çš„ è¿˜åˆ é™¤äº†ç¼“å­˜ä¸­çš„</span></span><br><span class="line">  <span class="comment">// åˆ é™¤ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">  context.<span class="title function_">commit</span>(<span class="string">&#x27;removeUserInfo&#x27;</span>) <span class="comment">// åˆ é™¤ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">  <span class="comment">// é‡ç½®è·¯ç”±</span></span><br><span class="line">  <span class="title function_">resetRouter</span>()</span><br><span class="line">  <span class="comment">// è¿˜æœ‰ä¸€æ­¥  vuexä¸­çš„æ•°æ®æ˜¯ä¸æ˜¯è¿˜åœ¨</span></span><br><span class="line">  <span class="comment">// è¦æ¸…ç©ºpermissionæ¨¡å—ä¸‹çš„stateæ•°æ®</span></span><br><span class="line">  <span class="comment">// vuexä¸­ userå­æ¨¡å—  permissionå­æ¨¡å—</span></span><br><span class="line">  <span class="comment">// å­æ¨¡å—è°ƒç”¨å­æ¨¡å—çš„action  é»˜è®¤æƒ…å†µä¸‹ å­æ¨¡å—çš„contextæ˜¯å­æ¨¡å—çš„</span></span><br><span class="line">  <span class="comment">// çˆ¶æ¨¡å— è°ƒç”¨ å­æ¨¡å—çš„action</span></span><br><span class="line">  context.<span class="title function_">commit</span>(<span class="string">&#x27;permission/setRoutes&#x27;</span>, [], &#123; <span class="attr">root</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  <span class="comment">// å­æ¨¡å—è°ƒç”¨å­æ¨¡å—çš„action å¯ä»¥ å°† commitçš„ç¬¬ä¸‰ä¸ªå‚æ•° è®¾ç½®æˆ  &#123; root: true &#125; å°±è¡¨ç¤ºå½“å‰çš„contextä¸æ˜¯å­æ¨¡å—äº† è€Œæ˜¯çˆ¶æ¨¡å—</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å‘ç°åœ¨é¡µé¢åˆ·æ–°çš„æ—¶å€™ï¼Œæœ¬æ¥åº”è¯¥æ‹¥æœ‰æƒé™çš„é¡µé¢å‡ºç°äº† 404ï¼Œè¿™æ˜¯å› ä¸º 404 çš„åŒ¹é…æƒé™æ”¾åœ¨äº†é™æ€è·¯ç”±ï¼Œè€ŒåŠ¨æ€è·¯ç”±åœ¨æ²¡æœ‰ addRoutes ä¹‹å‰ï¼Œæ‰¾ä¸åˆ°å¯¹åº”çš„åœ°å€ï¼Œå°±ä¼šæ˜¾ç¤º 404ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°† 404 æ”¾ç½®åˆ°åŠ¨æ€è·¯ç”±çš„æœ€å</p>
<p><strong><code>src/permission.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">addRoutes</span>([...routes, &#123; <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/404&quot;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;]); <span class="comment">// æ·»åŠ åˆ°è·¯ç”±è¡¨</span></span><br></pre></td></tr></table></figure>

<h2 id="å…«ã€å®Œæ•´ä»£ç "><a href="#å…«ã€å®Œæ•´ä»£ç " class="headerlink" title="å…«ã€å®Œæ•´ä»£ç "></a>å…«ã€å®Œæ•´ä»£ç </h2><h3 id="1ã€è·¯ç”±æ¨¡å—"><a href="#1ã€è·¯ç”±æ¨¡å—" class="headerlink" title="1ã€è·¯ç”±æ¨¡å—"></a>1ã€è·¯ç”±æ¨¡å—</h3><p>&#x2F;src&#x2F;router&#x2F;index.js</p>
<p>è·¯ç”±æ¨¡å—æä¾›äº†é™æ€è·¯ç”±å’ŒåŠ¨æ€è·¯ç”±ï¼ˆä»&#x2F;src&#x2F;router ä¸­çš„å…¶ä»–è·¯ç”±å­æ¨¡å—å¯¼å…¥ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>);</span><br><span class="line"><span class="comment">// å¼•å…¥å¤šä¸ªæ¨¡å—çš„è§„åˆ™</span></span><br><span class="line"><span class="keyword">import</span> approvalsRouter <span class="keyword">from</span> <span class="string">&quot;./modules/approvals&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> departmentsRouter <span class="keyword">from</span> <span class="string">&quot;./modules/departments&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> employeesRouter <span class="keyword">from</span> <span class="string">&quot;./modules/employees&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> permissionRouter <span class="keyword">from</span> <span class="string">&quot;./modules/permission&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> attendancesRouter <span class="keyword">from</span> <span class="string">&quot;./modules/attendances&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> salarysRouter <span class="keyword">from</span> <span class="string">&quot;./modules/salarys&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> settingRouter <span class="keyword">from</span> <span class="string">&quot;./modules/setting&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> socialRouter <span class="keyword">from</span> <span class="string">&quot;./modules/social&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> userRouter <span class="keyword">from</span> <span class="string">&quot;./modules/user&quot;</span>;</span><br><span class="line"><span class="comment">/* Layout */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/layout&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> constantRoutes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/login/index&quot;</span>),</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/404&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/404&quot;</span>),</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&quot;/dashboard&quot;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;dashboard&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;dashboard&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/dashboard/index&quot;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;é¦–é¡µ&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;dashboard&quot;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/import&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// è¯¥ç»„ä»¶ä¸åœ¨èœå•ä¸­æ˜¾ç¤º</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/import&quot;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;å¯¼å…¥&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  userRouter,</span><br><span class="line">];</span><br><span class="line"><span class="comment">// åŠ¨æ€è·¯ç”±çš„å˜é‡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> asyncRoutes = [</span><br><span class="line">  approvalsRouter,</span><br><span class="line">  departmentsRouter,</span><br><span class="line">  employeesRouter,</span><br><span class="line">  permissionRouter,</span><br><span class="line">  attendancesRouter,</span><br><span class="line">  salarysRouter,</span><br><span class="line">  settingRouter,</span><br><span class="line">  socialRouter,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createRouter</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;history&quot;</span>, <span class="comment">// require service support</span></span><br><span class="line">    <span class="attr">base</span>: <span class="string">&quot;/hrsaas/&quot;</span>,</span><br><span class="line">    <span class="attr">scrollBehavior</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">y</span>: <span class="number">0</span> &#125;),</span><br><span class="line">    <span class="attr">routes</span>: [...constantRoutes], <span class="comment">// åŠ¨æ€è·¯ç”±å’Œé™æ€è·¯ç”±çš„ä¸´æ—¶åˆå¹¶</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetRouter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = <span class="title function_">createRouter</span>();</span><br><span class="line">  router.<span class="property">matcher</span> = newRouter.<span class="property">matcher</span>; <span class="comment">// reset router</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="2ã€store-æ¨¡å—"><a href="#2ã€store-æ¨¡å—" class="headerlink" title="2ã€store æ¨¡å—"></a>2ã€store æ¨¡å—</h3><p>&#x2F;src&#x2F;store&#x2F;index.js</p>
<p>å®ƒå°†å…¶ä»– store å­æ¨¡å—æ±‡æ€»åˆ°ä¸€èµ·å¯¼å‡ºä¾›ä½¿ç”¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> getters <span class="keyword">from</span> <span class="string">&quot;./getters&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">&quot;./modules/app&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> settings <span class="keyword">from</span> <span class="string">&quot;./modules/settings&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">&quot;./modules/user&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> permission <span class="keyword">from</span> <span class="string">&quot;./modules/permission&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> tagsView <span class="keyword">from</span> <span class="string">&quot;./modules/tagsView&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    app,</span><br><span class="line">    settings,</span><br><span class="line">    user,</span><br><span class="line">    permission,</span><br><span class="line">    tagsView,</span><br><span class="line">  &#125;,</span><br><span class="line">  getters,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p>&#x2F;src&#x2F;store&#x2F;getter.js</p>
<p>getter æ¨¡å—æä¾›äº†å…¶ä»– store æ¨¡å—çš„å¿«æ·è®¿é—®æ–¹å¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="attr">sidebar</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">app</span>.<span class="property">sidebar</span>,</span><br><span class="line">  <span class="attr">device</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">app</span>.<span class="property">device</span>,</span><br><span class="line">  <span class="attr">token</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">token</span>, <span class="comment">// å°†useræ¨¡å—ä¸‹çš„tokenä½œä¸ºå¿«æ·æ–¹å¼æ”¾å‡ºæ¥</span></span><br><span class="line">  <span class="attr">name</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">username</span>, <span class="comment">// å°†å­æ¨¡å—ä¸­çš„å¯¹è±¡ä¸­çš„åç§°å¼€æ”¾å‡ºæ¥</span></span><br><span class="line">  <span class="attr">userId</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">userId</span>,</span><br><span class="line">  <span class="attr">staffPhoto</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">staffPhoto</span>, <span class="comment">// å¤´åƒ</span></span><br><span class="line">  <span class="attr">companyId</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">companyId</span>,</span><br><span class="line">  <span class="attr">routes</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">permission</span>.<span class="property">routes</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters;</span><br></pre></td></tr></table></figure>

<p>&#x2F;src&#x2F;store&#x2F;modules&#x2F;user.js</p>
<p>user æ¨¡å—ä¸»è¦ç”¨æ¥å­˜å‚¨ token å’Œç”¨æˆ·ä¿¡æ¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getToken, setToken, removeToken, setTimeStamp &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/auth&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; login, getUserInfo, getUserDetailById &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/user&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; resetRouter &#125; <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">token</span>: <span class="title function_">getToken</span>(), <span class="comment">// è®¾ç½®tokenä¸ºå…±äº«</span></span><br><span class="line">  <span class="attr">userInfo</span>: &#123;&#125;, <span class="comment">// è¿™é‡Œä¸ºä»€ä¹ˆä¸å†™null ?</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="comment">// è®¾ç½®tokençš„mutations</span></span><br><span class="line">  <span class="title function_">setToken</span>(<span class="params">state, token</span>) &#123;</span><br><span class="line">    state.<span class="property">token</span> = token; <span class="comment">// åªæ˜¯è®¾ç½®äº†vuexä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="comment">// éœ€è¦å°†vuexä¸­çš„æ•°æ®åŒæ­¥åˆ°ç¼“å­˜</span></span><br><span class="line">    <span class="title function_">setToken</span>(token);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">removeToken</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">token</span> = <span class="literal">null</span>; <span class="comment">// è®¾ç½®vuexä¸­çš„tokenä¸ºnull</span></span><br><span class="line">    <span class="title function_">removeToken</span>(); <span class="comment">// åŒæ­¥åˆ é™¤ç¼“å­˜ä¸­çš„token</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setUserInfo</span>(<span class="params">state, userInfo</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = userInfo;</span><br><span class="line">    <span class="comment">// state.userInfo = &#123; ...userInfo &#125; // æµ…æ‹·è´ å¦‚æœè¦å»æ”¹å±æ€§é‡Œé¢çš„æŸä¸€ä¸ªå€¼ å¯ä»¥ç”¨æµ…æ‹·è´çš„æ–¹å¼</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">removeUserInfo</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = &#123;&#125;; <span class="comment">// é‡ç½®ä¸ºç©ºå¯¹è±¡</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// å°è£…ä¸€ä¸ªç™»å½•çš„action</span></span><br><span class="line">  <span class="comment">// dataè®¤ä¸ºæ˜¯ &#123; mobile,password &#125;</span></span><br><span class="line">  <span class="comment">// åªè¦ç”¨asyncæ ‡è®°äº†å‡½æ•° é‚£ä¹ˆè¿™ä¸ªå‡½æ•°æœ¬èº«å°±æ˜¯promiseå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">context, data</span>) &#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ç™»å½•æ¥å£</span></span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">login</span>(data);</span><br><span class="line">    <span class="comment">// resultå°±æ˜¯token</span></span><br><span class="line">    context.<span class="title function_">commit</span>(<span class="string">&quot;setToken&quot;</span>, result);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setTimeStamp</span>(); <span class="comment">// è®¾ç½®æ—¶é—´æˆ³</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// è·å–ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserInfo</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>();</span><br><span class="line">    <span class="comment">// æ­¤æ—¶resulté‡Œé¢å·²ç»æœ‰userId</span></span><br><span class="line">    <span class="keyword">const</span> baseInfo = <span class="keyword">await</span> <span class="title function_">getUserDetailById</span>(result.<span class="property">userId</span>); <span class="comment">// ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">    context.<span class="title function_">commit</span>(<span class="string">&quot;setUserInfo&quot;</span>, &#123; ...result, ...baseInfo &#125;); <span class="comment">// ä¿®æ”¹stateä¸­çš„ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ç™»å‡ºaction</span></span><br><span class="line">  <span class="title function_">lgout</span>(<span class="params">&#123; commit &#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// åˆ é™¤token</span></span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;removeToken&quot;</span>);</span><br><span class="line">    <span class="comment">// åˆ é™¤ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;removeUserInfo&quot;</span>);</span><br><span class="line">    <span class="comment">// é‡ç½®è·¯ç”±</span></span><br><span class="line">    <span class="title function_">resetRouter</span>();</span><br><span class="line">    <span class="comment">// æ¸…ç©ºè·¯ç”±æ¨¡å—ä¸‹çš„è·¯ç”±ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// Vuexå­æ¨¡å— è°ƒç”¨å­æ¨¡å—çš„mutation</span></span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;permission/setRoutes&quot;</span>, [], &#123; <span class="attr">root</span>: <span class="literal">true</span> &#125;); <span class="comment">// commité»˜è®¤æ˜¯æäº¤çš„å½“å‰å­æ¨¡å—çš„mutations</span></span><br><span class="line">    <span class="comment">// å¦‚æœåŠ ä¸Š root: true å°±è¡¨ç¤ºcommitæ­¤æ—¶æ˜¯æ ¹çº§çš„commit</span></span><br><span class="line">    <span class="comment">// this.$store.commit(&#x27;permission/setRoutes&#x27;)</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>&#x2F;src&#x2F;store&#x2F;modules&#x2F;permission.js</p>
<p>permission æ¨¡å—ä¸»è¦ç”¨æ¥ç­›é€‰å‡ºç”¨æˆ·æ‰€æ‹¥æœ‰çš„è·¯ç”±</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥äº†é™æ€è·¯ç”±</span></span><br><span class="line"><span class="comment">// æƒé™æ¨¡å—çš„ç›®çš„ æ˜¯æä¾›å½“å‰ç”¨æˆ·æ‰€æ‹¥æœ‰çš„è·¯ç”±æƒé™çš„æ•°æ®  é™æ€è·¯ç”± + å½“å‰ç”¨æˆ·çš„è‡ªèº«çš„åŠ¨æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">import</span> &#123; constantRoutes, asyncRoutes &#125; <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="comment">// routesè¡¨ç¤ºå½“å‰äººçš„è·¯ç”±æƒé™</span></span><br><span class="line">  <span class="attr">routes</span>: constantRoutes, <span class="comment">// å½“å‰æ‰€æœ‰äººéƒ½é»˜è®¤æ‹¥æœ‰é™æ€è·¯ç”±</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="comment">// newRoutesè®¤ä¸ºæ˜¯ç”¨æˆ·ç™»å½•ä¹‹åè·å–çš„æ–°è·¯ç”±</span></span><br><span class="line">  <span class="title function_">setRoutes</span>(<span class="params">state, newRoutes</span>) &#123;</span><br><span class="line">    state.<span class="property">routes</span> = [...constantRoutes, ...newRoutes]; <span class="comment">// é™æ€è·¯ç”±  + åŠ¨æ€è·¯ç”±</span></span><br><span class="line">    <span class="comment">// éœ€è¦å¾—åˆ°newRoutes æ‰èƒ½è°ƒç”¨mutations</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// ç­›é€‰è·¯ç”±æ¨¡å— menusè®¤ä¸ºæ˜¯å½“å‰ç”¨æˆ·èµ„æ–™çš„menusæ ‡è¯†  ä»£è¡¨ç”¨æˆ·æ‰€æ‹¥æœ‰çš„çš„æƒé™</span></span><br><span class="line">  <span class="title function_">filterRoutes</span>(<span class="params">context, menus</span>) &#123;</span><br><span class="line">    <span class="comment">// menus  [&#x27;setting&#x27;,&#x27;approvals]</span></span><br><span class="line">    <span class="comment">// asyncRoutes  [&#123; name: &#x27;&#x27;  &#125;]</span></span><br><span class="line">    <span class="keyword">var</span> routes = [];</span><br><span class="line">    menus.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// itemæ˜¯å­—ç¬¦ä¸² å»asyncRoutesé‡Œé¢æ‰¾æœ‰æ²¡æœ‰è·¯ç”±çš„nameå«è¿™ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">      routes.<span class="title function_">push</span>(...asyncRoutes.<span class="title function_">filter</span>(<span class="function">(<span class="params">route</span>) =&gt;</span> route.<span class="property">name</span> === item));</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// routeså°±æ˜¯å½“å‰ç”¨æˆ·çš„ç­›é€‰ä¹‹åçš„åŠ¨æ€è·¯ç”±</span></span><br><span class="line">    context.<span class="title function_">commit</span>(<span class="string">&quot;setRoutes&quot;</span>, routes);</span><br><span class="line">    <span class="comment">// æœ€ååŠ ä¸€è¡Œä»£ç </span></span><br><span class="line">    <span class="keyword">return</span> routes; <span class="comment">// è¿™é‡Œè¿”å›æ˜¯å› ä¸ºåé¢è°ƒç”¨actionçš„æ—¶å€™ è¦ä½¿ç”¨</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="3ã€æƒé™æ‹¦æˆªæ¨¡å—"><a href="#3ã€æƒé™æ‹¦æˆªæ¨¡å—" class="headerlink" title="3ã€æƒé™æ‹¦æˆªæ¨¡å—"></a>3ã€æƒé™æ‹¦æˆªæ¨¡å—</h3><p>src&#x2F;permission.js</p>
<p>è¿™ä¸ªæ¨¡å—ä¸»è¦æ˜¯é€šè¿‡è·¯ç”±å®ˆå«è¿›è¡Œé¡µé¢æƒé™æ§åˆ¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±çš„æ‹¦æˆªæƒé™é—®é¢˜</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NProgress</span> <span class="keyword">from</span> <span class="string">&quot;nprogress&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span>; <span class="comment">// å¼•å…¥è¿›åº¦æ¡æ ·å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰ç½®å®ˆå«</span></span><br><span class="line"><span class="keyword">const</span> whileList = [<span class="string">&quot;/login&quot;</span>, <span class="string">&quot;/404&quot;</span>];</span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span> (to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">start</span>(); <span class="comment">// å¼€å¯è¿›åº¦æ¡</span></span><br><span class="line">  <span class="comment">// nextæ˜¯ä¸€ä¸ªå¿…é¡»æ‰§è¡Œçš„é’©å­ ä¸æ‰§è¡Œå°±å¡ä¸»äº†</span></span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&quot;/login&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// next() æ”¾è¡Œ</span></span><br><span class="line">      <span class="comment">// next(false) ç»ˆæ­¢</span></span><br><span class="line">      <span class="comment">// next(åœ°å€) è·³åˆ°æŸä¸ª åœ°å€</span></span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&quot;/&quot;</span>); <span class="comment">// è·³åˆ°ä¸»é¡µ</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// è¦åˆ¤æ–­æ˜¯ä¸æ˜¯å·²ç»è·å–è¿‡èµ„æ–™äº†</span></span><br><span class="line">      <span class="keyword">if</span> (!store.<span class="property">getters</span>.<span class="property">userId</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœidä¸å­˜åœ¨ æ„å‘³ç€å½“å‰æ²¡æœ‰ç”¨æˆ·èµ„æ–™ å°±è¦å»è·å–ç”¨æˆ·èµ„æ–™</span></span><br><span class="line">        <span class="comment">// vuexçš„actionæ˜¯ä¸€ä¸ªpromise</span></span><br><span class="line">        <span class="keyword">const</span> &#123; roles &#125; = <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/getUserInfo&quot;</span>);</span><br><span class="line">        <span class="comment">// æ­¤æ—¶å·²ç»è·å–å®Œèµ„æ–™</span></span><br><span class="line">        <span class="keyword">const</span> routes = <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(</span><br><span class="line">          <span class="string">&quot;permission/filterRoutes&quot;</span>,</span><br><span class="line">          roles.<span class="property">menus</span></span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// æ­¤æ—¶å¾—åˆ°çš„routesæ˜¯å½“å‰ç”¨æˆ·çš„æ‰€æ‹¥æœ‰çš„çš„åŠ¨æ€è·¯ç”±çš„æƒé™</span></span><br><span class="line">        router.<span class="title function_">addRoutes</span>([</span><br><span class="line">          ...routes,</span><br><span class="line">          &#123; <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/404&quot;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">        ]); <span class="comment">// å°†å½“å‰åŠ¨æ€è·¯ç”±åŠ åˆ°å½“å‰è·¯ç”±è§„åˆ™ä¸Š</span></span><br><span class="line">        <span class="comment">// åŠ awaitçš„æ„æ€æ˜¯ å¼ºåˆ¶ç­‰å¾…è·å–å®Œç”¨æˆ·èµ„æ–™ä¹‹å æ‰å»æ”¾è¡Œ  å°±èƒ½ä¿è¯ ç”¨æˆ·è¿›åˆ°é¡µé¢æ—¶å€™ æœ‰èµ„æ–™</span></span><br><span class="line">        <span class="comment">// æ·»åŠ å®Œè·¯ç”±ä¹‹å ä¸èƒ½ç”¨next()  è¦ç”¨next(to.path) å¦åˆ™åœ°å€ä¸èƒ½ç”Ÿæ•ˆ è¿™ç®—æ˜¯ä¸€ä¸ªå·²çŸ¥ çš„å°ç¼ºé™·</span></span><br><span class="line">        <span class="comment">// æ‰§è¡Œå®ŒaddRoutes å¿…é¡»æ‰§è¡Œnext(to.path) ä¸èƒ½æ‰§è¡Œ next() è¿™æ˜¯ä¸€ä¸ªå·²çŸ¥çš„é—®é¢˜ç¼ºé™·</span></span><br><span class="line">        <span class="title function_">next</span>(to.<span class="property">path</span>); <span class="comment">// è§£å†³ç›´æ¥æ‰§è¡Œnext()æ—¶çš„å¼‚å¸¸</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>(); <span class="comment">// æ”¾è¡Œ</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (whileList.<span class="title function_">indexOf</span>(to.<span class="property">path</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// è¡¨ç¤ºåœ¨ç™½åå•é‡Œé¢</span></span><br><span class="line">      <span class="title function_">next</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>(); <span class="comment">// æ˜¯ä¸ºäº†è§£å†³æ‰‹åŠ¨è¾“å…¥åœ°å€æ—¶ è¿›åº¦æ¡ä¸å…³é—­çš„é—®é¢˜</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åç½®å®ˆå«</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="4ã€ä¾§è¾¹æ "><a href="#4ã€ä¾§è¾¹æ " class="headerlink" title="4ã€ä¾§è¾¹æ "></a>4ã€ä¾§è¾¹æ </h3><p>&#x2F;src&#x2F;layout&#x2F;components&#x2F;Siderbar&#x2F;index.vue</p>
<p>æœ€ç»ˆä¾§è¾¹æ ç»„ä»¶æ ¹æ® store ä¸­çš„ç”¨æˆ·è·¯ç”±æ¨¡å—ï¼Œæ¸²æŸ“å‡ºç”¨æˆ·å¯ä»¥è®¿é—®çš„èœå•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div :class=&quot;&#123; &#x27;has-logo&#x27;: showLogo &#125;&quot;&gt;</span><br><span class="line">    &lt;logo v-if=&quot;showLogo&quot; :collapse=&quot;isCollapse&quot; /&gt;</span><br><span class="line">    &lt;el-scrollbar wrap-class=&quot;scrollbar-wrapper&quot;&gt;</span><br><span class="line">      &lt;el-menu</span><br><span class="line">        :default-active=&quot;activeMenu&quot;</span><br><span class="line">        :collapse=&quot;isCollapse&quot;</span><br><span class="line">        :background-color=&quot;variables.menuBg&quot;</span><br><span class="line">        :text-color=&quot;variables.menuText&quot;</span><br><span class="line">        :unique-opened=&quot;false&quot;</span><br><span class="line">        :active-text-color=&quot;variables.menuActiveText&quot;</span><br><span class="line">        :collapse-transition=&quot;false&quot;</span><br><span class="line">        mode=&quot;vertical&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;sidebar-item</span><br><span class="line">          v-for=&quot;route in routes&quot;</span><br><span class="line">          :key=&quot;route.path&quot;</span><br><span class="line">          :item=&quot;route&quot;</span><br><span class="line">          :base-path=&quot;route.path&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-menu&gt;</span><br><span class="line">    &lt;/el-scrollbar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapGetters &#125; from &quot;vuex&quot;;</span><br><span class="line">import Logo from &quot;./Logo&quot;;</span><br><span class="line">import SidebarItem from &quot;./SidebarItem&quot;;</span><br><span class="line">import variables from &quot;@/styles/variables.scss&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123; SidebarItem, Logo &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapGetters([&quot;sidebar&quot;, &quot;routes&quot;]),</span><br><span class="line">    // è·¯ç”± addRoutesä¹‹å ä¸ä¼šå“åº”å¼çš„æ›´æ–°çš„ç»„ä»¶</span><br><span class="line">    // é»˜è®¤é™æ€è·¯ç”± 5æ¡  +  addRoutes(6æ¡) = 11æ¡</span><br><span class="line">    // routes() &#123;</span><br><span class="line">    //   return this.$router.options.routes</span><br><span class="line">    // &#125;,</span><br><span class="line">    activeMenu() &#123;</span><br><span class="line">      const route = this.$route;</span><br><span class="line">      const &#123; meta, path &#125; = route;</span><br><span class="line">      // if set path, the sidebar will highlight the path you set</span><br><span class="line">      if (meta.activeMenu) &#123;</span><br><span class="line">        return meta.activeMenu;</span><br><span class="line">      &#125;</span><br><span class="line">      return path;</span><br><span class="line">    &#125;,</span><br><span class="line">    showLogo() &#123;</span><br><span class="line">      return this.$store.state.settings.sidebarLogo;</span><br><span class="line">    &#125;,</span><br><span class="line">    variables() &#123;</span><br><span class="line">      return variables;</span><br><span class="line">    &#125;,</span><br><span class="line">    isCollapse() &#123;</span><br><span class="line">      return !this.sidebar.opened;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-axiosäºŒæ¬¡å°è£…"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/12/13/axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/"
    >axiosäºŒæ¬¡å°è£…</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/12/13/axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/" class="article-date">
  <time datetime="2022-12-13T06:11:23.000Z" itemprop="datePublished">2022-12-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>axios ä½œä¸ºç½‘ç»œè¯·æ±‚çš„ç¬¬ä¸‰æ–¹å·¥å…·, å¯ä»¥è¿›è¡Œè¯·æ±‚å’Œå“åº”çš„æ‹¦æˆª</p>
<p>ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­å¤„ç† token çš„ç»Ÿä¸€æ³¨å…¥é—®é¢˜ã€token è¶…æ—¶æ‹¦æˆªé—®é¢˜ã€‚å“åº”æ‹¦æˆªå™¨åˆ™ä¸»è¦å¤„ç†æ•°æ®ç»“æ„å’Œæ•°æ®å¼‚å¸¸</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Message</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-ui&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTimeStamp &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/auth&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TimeOut</span> = <span class="number">5400</span>; <span class="comment">// å®šä¹‰è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">//    è®¾ç½®åŸºç¡€åœ°å€</span></span><br><span class="line">  <span class="comment">// ç¯å¢ƒå˜é‡ npm run dev  /api   /ç”Ÿäº§ç¯å¢ƒ npm run build  /prod-api</span></span><br><span class="line">  <span class="attr">baseURL</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>, <span class="comment">// è®¤ä¸ºåªè¦è¶…è¿‡5ç§’é’Ÿä¸å“åº” å°±è¶…æ—¶</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">async</span> (config) =&gt; &#123;</span><br><span class="line">    <span class="comment">// è¯·æ±‚æ¥å£  configæ˜¯è¯·æ±‚é…ç½®</span></span><br><span class="line">    <span class="comment">// å–token</span></span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">      <span class="comment">// åªè¦æœ‰token å°±è¦æ£€æŸ¥tokenæ—¶æ•ˆæ€§</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">CheckIsTimeOut</span>()) &#123;</span><br><span class="line">        <span class="comment">//  ç»§ç»­ï¼Ÿ</span></span><br><span class="line">        <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/lgout&quot;</span>);</span><br><span class="line">        router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>); <span class="comment">// è·³åˆ°ç™»å½•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;æ‚¨çš„tokenå·²ç»å¤±æ•ˆ&quot;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å¦‚æœå­˜åœ¨token</span></span><br><span class="line">      config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;store.getters.token&#125;</span>`</span>;</span><br><span class="line">      <span class="comment">// return config</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿™é‡Œä¸€å®šè¦æ³¨æ„</span></span><br><span class="line">    <span class="comment">// ä¸€å®šè¦return config</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æˆåŠŸæ‰§è¡Œ</span></span><br><span class="line">    <span class="comment">// axiosé»˜è®¤åŠ äº†ä¸€å±‚dataçš„åŒ…è£¹</span></span><br><span class="line">    <span class="keyword">const</span> &#123; success, message, data &#125; = response.<span class="property">data</span>;</span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">      <span class="comment">// æ­¤æ—¶è®¤ä¸ºä¸šåŠ¡æ‰§è¡ŒæˆåŠŸäº†</span></span><br><span class="line">      <span class="keyword">return</span> data; <span class="comment">// è¿”å›ç”¨æˆ·æ‰€éœ€è¦çš„æ•°æ®</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å½“ä¸šåŠ¡å¤±è´¥çš„æ—¶å€™</span></span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(message); <span class="comment">// æç¤ºæ¶ˆæ¯</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(message));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">async</span> (error) =&gt; &#123;</span><br><span class="line">    <span class="comment">// error æœ‰responseå¯¹è±¡ config</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      error.<span class="property">response</span> &amp;&amp;</span><br><span class="line">      error.<span class="property">response</span>.<span class="property">data</span> &amp;&amp;</span><br><span class="line">      error.<span class="property">response</span>.<span class="property">data</span>.<span class="property">code</span> === <span class="number">10002</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="comment">// åç«¯å‘Šè¯‰å‰ç«¯tokenè¶…æ—¶äº†</span></span><br><span class="line">      <span class="keyword">await</span> store.<span class="title function_">dispatch</span>(<span class="string">&quot;user/lgout&quot;</span>); <span class="comment">// è°ƒç”¨ç™»å‡ºaction</span></span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>); <span class="comment">// è·³åˆ°ç™»å½•é¡µ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¤±è´¥</span></span><br><span class="line">    <span class="comment">// Messageç­‰åŒäº this.$message</span></span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>); <span class="comment">// æç¤ºé”™è¯¯</span></span><br><span class="line">    <span class="comment">// reject</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error); <span class="comment">// ä¼ å…¥ä¸€ä¸ªé”™è¯¯çš„å¯¹è±¡  å°±è®¤ä¸ºpromiseæ‰§è¡Œé“¾ è¿›å…¥äº†catch</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CheckIsTimeOut</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å½“å‰æ—¶é—´  - å­˜å‚¨çš„æ—¶é—´æˆ³ &gt; æ—¶æ•ˆæ€§  false   tr</span></span><br><span class="line">  <span class="keyword">return</span> (<span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="title function_">getTimeStamp</span>()) / <span class="number">1000</span> &gt; <span class="title class_">TimeOut</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">ä¸Šä¸€é¡µ</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">ä¸‹ä¸€é¡µ</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023-2024
        <i class="ri-heart-fill heart_icon"></i> congtianfeng
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>æµè§ˆæ¬¡æ•°:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="hasCat"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%8A%80%E6%9C%AF">æŠ€æœ¯</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">æ—…è¡Œ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äº</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=541326593&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>